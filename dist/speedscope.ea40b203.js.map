{"version":3,"sources":["../src/constants.js","../src/options.js","../src/create-element.js","../src/component.js","../src/render.js","../src/create-context.js","../src/util.js","../src/diff/children.js","../src/diff/props.js","../src/diff/index.js","../src/clone-element.js","../src/diff/catch-error.js","../src/lib/utils.ts","../src/lib/lru-cache.ts","../src/lib/math.ts","../node_modules/process/browser.js","../src/gl/graphics.ts","../src/gl/utils.ts","../src/gl/rectangle-batch-renderer.ts","../src/lib/color.ts","../src/gl/row-atlas.ts","../src/gl/texture-renderer.ts","../src/gl/overlay-rectangle-renderer.ts","../src/gl/flamechart-color-pass-renderer.ts","../src/gl/canvas-context.ts","../src/app-state/getters.ts","../src/index.js","../src/PureComponent.js","../src/memo.js","../src/forwardRef.js","../src/Children.js","../src/suspense.js","../src/suspense-list.js","../src/portals.js","../src/events.js","../src/lib/atom.ts","../src/lib/view-mode.ts","../src/lib/hash-params.ts","../src/app-state/profile-group.ts","../src/app-state/index.ts","../src/app-state/active-profile-state.ts","../src/app-state/color-scheme.ts","../src/views/themes/dark-theme.ts","../src/views/themes/light-theme.ts","../src/views/themes/theme.tsx","../node_modules/css-in-js-utils/lib/isPrefixedValue.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/calc.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/crossFade.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/cursor.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/filter.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flex.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxIE.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxOld.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/gradient.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/imageSet.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/position.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/sizing.js","../node_modules/hyphenate-style-name/index.js","../node_modules/css-in-js-utils/lib/hyphenateProperty.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/capitalizeString.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/transition.js","../node_modules/string-hash/index.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixProperty.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixValue.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/addNewValuesOnly.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/isObject.js","../node_modules/aphrodite/node_modules/inline-style-prefixer/static/createPrefixer.js","../node_modules/asap/browser-raw.js","../node_modules/asap/browser-asap.js","../node_modules/aphrodite/es/index.js","../src/views/style.ts","../src/lib/profile-search.ts","../src/views/search-view.tsx","../src/lib/emscripten.ts","../src/views/color-chit.tsx","../src/views/scrollable-list-view.tsx","../src/views/profile-table-view.tsx","../src/lib/flamechart.ts","../src/gl/flamechart-renderer.ts","../src/views/flamechart-style.ts","../src/lib/text-utils.ts","../src/views/flamechart-minimap-view.tsx","../src/views/flamechart-detail-view.tsx","../src/lib/canvas-2d-batch-renderers.ts","../src/views/flamechart-pan-zoom-view.tsx","../src/views/hovertip.tsx","../src/views/flamechart-search-view.tsx","../src/lib/preact-helpers.tsx","../src/views/flamechart-view.tsx","../src/views/flamechart-view-container.tsx","../src/views/flamechart-wrapper.tsx","../src/views/inverted-caller-flamegraph-view.tsx","../src/views/callee-flamegraph-view.tsx","../src/views/sandwich-search-view.tsx","../src/views/sandwich-view.tsx","../src/lib/value-formatters.ts","../node_modules/parcel-bundler/src/builtins/bundle-url.js","../node_modules/parcel-bundler/src/builtins/bundle-loader.js","../src/lib/profile.ts","../src/lib/file-format-spec.ts","../package.json","../src/lib/file-format.ts","../src/lib/fuzzy-find.ts","../src/views/profile-select.tsx","../src/views/toolbar.tsx","../src/lib/js-source-map.ts","../src/lib/frameDiffs.ts","../src/views/compare-table-view.tsx","../src/views/compare-view.tsx","../src/views/application.tsx","../src/views/application-container.tsx","../src/speedscope.tsx","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js","../node_modules/parcel-bundler/src/builtins/loaders/browser/js-loader.js"],"names":["options","isValidElement","rerenderQueue","rerenderCount","defer","prevDebounce","IS_HYDRATE","i","EMPTY_OBJ","EMPTY_ARR","IS_NON_DIMENSIONAL","assign","obj","props","removeNode","node","parentNode","removeChild","createElement","type","children","normalizedProps","arguments","length","push","defaultProps","undefined","createVNode","key","ref","original","vnode","_children","_parent","_depth","_dom","_nextDom","_component","constructor","_original","createRef","Fragment","Component","context","getDomSibling","childIndex","indexOf","sibling","updateParentDomPointers","child","base","enqueueRender","c","_dirty","debounceRendering","process","queue","sort","a","b","_vnode","some","component","commitQueue","oldVNode","newDom","oldDom","parentDom","_parentDom","diff","_globalContext","ownerSVGElement","commitRoot","diffChildren","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","sibDom","firstChildDom","refs","oldChildren","oldChildrenLength","toChildArray","childVNode","nextDom","outer","appendChild","nextSibling","insertBefore","value","unmount","applyRef","callback","flattened","Array","isArray","diffProps","dom","newProps","oldProps","hydrate","setProperty","setStyle","style","test","name","oldValue","s","useCapture","nameLower","cssText","replace","toLowerCase","slice","addEventListener","eventProxy","_listeners","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","e","event","newVNode","tmp","isNew","oldState","snapshot","clearProcessingException","provider","componentContext","newType","_diff","contextType","_id","_defaultValue","_processingException","_pendingError","prototype","render","doRender","sub","state","_renderCallbacks","_nextState","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","_force","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","_render","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","_catchError","root","_commit","cb","call","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","data","childNodes","dangerouslySetInnerHTML","attributes","__html","innerHTML","checked","current","parentVNode","skipRemove","r","componentWillUnmount","this","replaceNode","_root","cloneElement","createContext","defaultValue","ctx","Consumer","Provider","subs","_this","_props","old","splice","_contextRef","error","hasCaught","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","Promise","then","bind","resolve","setTimeout","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","nextTick","args","Item","array","apply","title","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","currentIndex","currentComponent","prevRaf","currentHook","afterPaintEffects","oldBeforeRender","oldAfterDiff","oldCommit","oldBeforeUnmount","getHookState","index","_hook","hooks","__hooks","_list","_pendingEffects","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_value","action","nextValue","useEffect","_skipEffects","argsChanged","_args","useLayoutEffect","useRef","initialValue","useMemo","useImperativeHandle","createHandle","factory","_factory","useCallback","useContext","_context","useDebugValue","formatter","useErrorBoundary","errState","err","flushAfterPaintEffects","forEach","invokeCleanup","invokeEffect","hook","_cleanup","result","oldArgs","newArgs","arg","f","requestAnimationFrame","raf","done","cancelAnimationFrame","window","filter","shallowDiffers","PureComponent","isPureReactComponent","memo","comparer","shouldUpdate","nextProps","updateRef","Memoed","isReactComponent","displayName","_forwarded","oldDiffHook","forwardRef","fn","Forwarded","clone","mapFn","reduce","acc","Children","map","count","only","toArray","oldCatchError","detachedClone","Suspense","_pendingSuspensionCount","_suspenders","_detachOnNextRender","suspended","_suspended","lazy","loader","prom","Lazy","default","SuspenseList","_next","_map","_childDidSuspend","promise","suspendingComponent","resolved","onResolved","onSuspensionComplete","_suspendedComponentWillUnmount","pop","fallback","list","delete","revealOrder","size","delegated","get","unsuspend","wrappedUnsuspend","Map","reverse","set","ContextProvider","Portal","container","wrap","_container","_temp","_unmount","_wrap","_hasMounted","createPortal","CAMEL_PROPS","REACT_ELEMENT_TYPE","Symbol","for","parent","firstChild","preactRender","preactHydrate","oldEventHook","setSafeDescriptor","proto","Object","defineProperty","configurable","v","persist","stoppedPropagating","defaultPrevented","origStopPropagation","stopPropagation","origPreventDefault","preventDefault","isPropagationStopped","isDefaultPrevented","nativeEvent","classNameDescriptor","class","oldVNodeHook","$$typeof","className","enumerable","shouldSanitize","attrs","multiple","selected","ondoubleclick","ondblclick","onbeforeinput","onchange","normalized","oninput","applyEventNormalization","_patchedLifecycles","createFactory","element","preactCloneElement","unmountComponentAtNode","findDOMNode","unstable_batchedUpdates","w","m","ms","wm","wms","wmms","staticPrefixData","plugins","calc","crossFade","cursor","flex","flexboxIE","flexboxOld","gradient","imageSet","position","sizing","transition","prefixMap","_typeof","iterator","_createClass","defineProperties","target","descriptor","writable","Constructor","protoProps","staticProps","_classCallCheck","instance","TypeError","MAP_EXISTS","OrderedElements","elements","keyOrder","shouldReorder","hasOwnProperty","nested","_nested","keys","has","addStyleType","styleType","UPPERCASE_RE","UPPERCASE_RE_TO_KEBAB","match","String","kebabifyStyleName","string","isUnitlessNumber","animationIterationCount","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridRow","gridColumn","fontWeight","lineClamp","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","prefixKey","prefix","charAt","toUpperCase","substring","prefixes","prop","stringifyValue","stringifyAndImportantifyValue","importantify","hashString","toString","hashObject","object","JSON","stringify","_toConsumableArray","arr","arr2","from","prefixAll","defaultSelectorHandlers","pseudoSelectors","selector","baseSelector","generateSubtreeStyles","mediaQueries","generated","join","generateCSS","styleTypes","selectorHandlers","stringHandlers","useImportant","merged","plainDeclarations","generatedStyles","val","foundHandler","handler","newSelector","console","warn","generatedRuleset","generateCSSRuleset","unshift","runStringHandlers","declarations","stringHandlerKeys","transformRule","transformValue","arrayToObjectKeysReducer","originalElements","create","prefixedElements","elementNames","originalStyle","originalIndex","rules","_i","_typeof$1","_toConsumableArray$1","styleTag","injectStyleTag","cssRules","querySelector","head","getElementsByTagName","sheet","styleSheet","insertRule","numRules","rule","innerText","fontFamily","injectStyleOnce","src","animationName","finalVal","valVal","valKey","injectGeneratedCSSOnce","alreadyInjected","injectionBuffer","isBuffering","generatedCSS","_injectionBuffer","flushToStyleTag","definitions","reset","getBufferedStyles","startBuffering","flushToArray","ret","flushToString","getRenderedClassNames","addRenderedClassNames","classNames","processStyleDefinitions","styleDefinitions","classNameBits","definitionBits","_name","_definition","_len","injectAndGetClassName","unminifiedHashFn","str","initialHashFn","hashFn","StyleSheet","sheetDefinition","mappedSheetDefinition","stringVal","rehydrate","renderedClassNames","StyleSheetServer","renderStatic","renderFunc","html","cssContent","css","content","StyleSheetTestUtils","suppressStyleInjection","clearBufferAndResumeStyleInjection","getBufferedStyles$$1","makeExports","extend","extensions","extensionSelectorHandlers","extension","selectorHandler","minify","shouldMinify","_key","Aphrodite","StyleSheet$1","StyleSheetServer$1","StyleSheetTestUtils$1","bundleURL","getBundleURLCached","getBundleURL","matches","stack","getBaseURL","url","require","loadBundlesLazy","bundles","id","code","LazyPromise","reject","loadBundles","all","loadBundle","bundleLoaders","registerBundleLoader","load","register","bundle","lastIndexOf","bundleLoader","catch","executor","onSuccess","onError","OVERLAY_ID","OldModule","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","parse","handled","assets","asset","didAccept","hmrAcceptCheck","global","parcelRequire","every","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","message","overlay","createErrorOverlay","body","getElementById","remove","stackTrace","getParents","modules","parents","k","d","dep","Function","deps","cached","cache","loadJSBundle","script","async","charset","onerror","onload"],"mappings":"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AC,gBAAN,CAAuB,QAAvB,EAAiC,kBAAjC;AACA,WAAO,MAAK;AACV,MAAA,KAAK,CAAC,mBAAN,CAA0B,QAA1B,EAAoC,kBAApC;AACD,KAFD;AAGD,GAND,EAMG,CAAC,kBAAD,CANH;AAQA,QAAM,WAAW,GAAG,mBAAQ,4BAAR,CAApB;AACA,QAAM,KAAK,GAAG,QAAQ,CAAC,WAAD,EAAc,qBAAd,CAAtB;AAEA,SAAO,eAAC,YAAY,CAAC,QAAd,EAAsB;AAAC,IAAA,KAAK,EAAE,KAAR;AAAe,IAAA,QAAQ,EAAE,KAAK,CAAC;AAA/B,GAAtB,CAAP;AACD;;ACtGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AClEA;;A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","file":"speedscope.ea40b203.js","sourceRoot":"../assets","sourcesContent":["export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\ti;\n\tfor (i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(\n\t\ttype,\n\t\tnormalizedProps,\n\t\tprops && props.key,\n\t\tprops && props.ref,\n\t\tnull\n\t);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\tconstructor: undefined,\n\t\t_original: original\n\t};\n\n\tif (original == null) vnode._original = vnode;\n\tif (options.vnode) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn {};\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\tupdate = update(s, this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = oldVNode;\n\n\t\tlet newDom = diff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tnull,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (newDom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\nlet rerenderCount = 0;\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\nconst IS_HYDRATE = EMPTY_OBJ;\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {Element | Text} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we\n\t// are in hydration mode or not by passing `IS_HYDRATE` instead of a\n\t// DOM element.\n\tlet isHydrating = replaceNode === IS_HYDRATE;\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\tvnode = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\t((isHydrating ? parentDom : replaceNode || parentDom)._children = vnode),\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\treplaceNode && !isHydrating\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: EMPTY_ARR.slice.call(parentDom.childNodes),\n\t\tcommitQueue,\n\t\treplaceNode || EMPTY_OBJ,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, IS_HYDRATE);\n}\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue) {\n\tconst ctx = {};\n\n\tconst context = {\n\t\t_id: '__cC' + i++,\n\t\t_defaultValue: defaultValue,\n\t\tConsumer(props, context) {\n\t\t\treturn props.children(context);\n\t\t},\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tconst subs = [];\n\t\t\t\tthis.getChildContext = () => {\n\t\t\t\t\tctx[context._id] = this;\n\t\t\t\t\treturn ctx;\n\t\t\t\t};\n\n\t\t\t\tthis.shouldComponentUpdate = _props => {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\tsubs.some(c => {\n\t\t\t\t\t\t\tc.context = _props.value;\n\t\t\t\t\t\t\tenqueueRender(c);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\told && old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\tcontext.Consumer.contextType = context;\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\tcontext.Provider._contextRef = context;\n\n\treturn context;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { removeNode } from '../util';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Node | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, newDom, sibDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\t// Only in very specific places should this logic be invoked (top level `render` and `diffElementNodes`).\n\t// I'm using `EMPTY_OBJ` to signal when `diffChildren` is invoked in these situations. I can't use `null`\n\t// for this purpose, because `null` is a valid value for `oldDom` which can mean to skip to this logic\n\t// (e.g. if mounting a new tree in which the old DOM should be ignored (usually for Fragments).\n\tif (oldDom == EMPTY_OBJ) {\n\t\tif (excessDomChildren != null) {\n\t\t\toldDom = excessDomChildren[0];\n\t\t} else if (oldChildrenLength) {\n\t\t\toldDom = getDomSibling(oldParentVNode, 0);\n\t\t} else {\n\t\t\toldDom = null;\n\t\t}\n\t}\n\n\ti = 0;\n\tnewParentVNode._children = toChildArray(\n\t\tnewParentVNode._children,\n\t\tchildVNode => {\n\t\t\tif (childVNode != null) {\n\t\t\t\tchildVNode._parent = newParentVNode;\n\t\t\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t\t\t// Check if we find a corresponding element in oldChildren.\n\t\t\t\t// If found, delete the array item by setting to `undefined`.\n\t\t\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t\t\t// (holes).\n\t\t\t\toldVNode = oldChildren[i];\n\n\t\t\t\tif (\n\t\t\t\t\toldVNode === null ||\n\t\t\t\t\t(oldVNode &&\n\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t\t\t) {\n\t\t\t\t\toldChildren[i] = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t\t\t// We always match by type (in either case).\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\toldVNode &&\n\t\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldVNode = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\t\t\tnewDom = diff(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\tglobalContext,\n\t\t\t\t\tisSvg,\n\t\t\t\t\texcessDomChildren,\n\t\t\t\t\tcommitQueue,\n\t\t\t\t\toldDom,\n\t\t\t\t\tisHydrating\n\t\t\t\t);\n\n\t\t\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\t\t\tif (!refs) refs = [];\n\t\t\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t\t\t}\n\n\t\t\t\t// Only proceed if the vnode has not been unmounted by `diff()` above.\n\t\t\t\tif (newDom != null) {\n\t\t\t\t\tif (firstChildDom == null) {\n\t\t\t\t\t\tfirstChildDom = newDom;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet nextDom;\n\t\t\t\t\tif (childVNode._nextDom !== undefined) {\n\t\t\t\t\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t\t\t\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t\t\t\t\t// of last DOM child of this child VNode\n\t\t\t\t\t\tnextDom = childVNode._nextDom;\n\n\t\t\t\t\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t\t\t\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t\t\t\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t\t\t\t\t// can clean up the property\n\t\t\t\t\t\tchildVNode._nextDom = undefined;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\texcessDomChildren == oldVNode ||\n\t\t\t\t\t\tnewDom != oldDom ||\n\t\t\t\t\t\tnewDom.parentNode == null\n\t\t\t\t\t) {\n\t\t\t\t\t\t// NOTE: excessDomChildren==oldVNode above:\n\t\t\t\t\t\t// This is a compression of excessDomChildren==null && oldVNode==null!\n\t\t\t\t\t\t// The values only have the same type when `null`.\n\n\t\t\t\t\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\t\t\t\t\tparentDom.appendChild(newDom);\n\t\t\t\t\t\t\tnextDom = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\t\tsibDom = oldDom, j = 0;\n\t\t\t\t\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildrenLength;\n\t\t\t\t\t\t\t\tj += 2\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\t\t\t\t\tnextDom = oldDom;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t\t\t\t// there are probably some internal data structures that aren't\n\t\t\t\t\t\t// updated properly.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t\t\t\t// value check in `diff()` won't be skipped.\n\t\t\t\t\t\tif (newParentVNode.type == 'option') {\n\t\t\t\t\t\t\tparentDom.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t\t\t\t\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t\t\t\t\t// See more detail in create-element.js:createVNode\n\t\t\t\t\tif (nextDom !== undefined) {\n\t\t\t\t\t\toldDom = nextDom;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldDom = newDom.nextSibling;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t\t\t// node's nextSibling.\n\n\t\t\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\toldDom &&\n\t\t\t\t\toldVNode._dom == oldDom &&\n\t\t\t\t\toldDom.parentNode != parentDom\n\t\t\t\t) {\n\t\t\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\t\t\toldDom = getDomSibling(oldVNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti++;\n\t\t\treturn childVNode;\n\t\t}\n\t);\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove children that are not part of any vnode.\n\tif (excessDomChildren != null && typeof newParentVNode.type != 'function') {\n\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t}\n\t}\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) unmount(oldChildren[i], oldChildren[i]);\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @param {(vnode: import('../internal').VNode) => import('../internal').VNode} [callback]\n * A function to invoke for each child before it is added to the flattened list.\n * @param {Array<import('../internal').VNode | string | number>} [flattened] An flat array of children to modify\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, callback, flattened) {\n\tif (flattened == null) flattened = [];\n\n\tif (children == null || typeof children == 'boolean') {\n\t\tif (callback) flattened.push(callback(null));\n\t} else if (Array.isArray(children)) {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\ttoChildArray(children[i], callback, flattened);\n\t\t}\n\t} else if (!callback) {\n\t\tflattened.push(children);\n\t} else if (typeof children == 'string' || typeof children == 'number') {\n\t\tflattened.push(callback(createVNode(null, children, null, null, children)));\n\t} else if (children._dom != null || children._component != null) {\n\t\tflattened.push(\n\t\t\tcallback(\n\t\t\t\tcreateVNode(\n\t\t\t\t\tchildren.type,\n\t\t\t\t\tchildren.props,\n\t\t\t\t\tchildren.key,\n\t\t\t\t\tnull,\n\t\t\t\t\tchildren._original\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tflattened.push(callback(children));\n\t}\n\n\treturn flattened;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (\n\t\ttypeof value == 'number' &&\n\t\tIS_NON_DIMENSIONAL.test(key) === false\n\t) {\n\t\tstyle[key] = value + 'px';\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else {\n\t\tstyle[key] = value;\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet s, useCapture, nameLower;\n\n\tif (isSvg) {\n\t\tif (name === 'className') {\n\t\t\tname = 'class';\n\t\t}\n\t} else if (name === 'class') {\n\t\tname = 'className';\n\t}\n\n\tif (name === 'style') {\n\t\ts = dom.style;\n\n\t\tif (typeof value == 'string') {\n\t\t\ts.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\ts.cssText = '';\n\t\t\t\toldValue = null;\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (let i in oldValue) {\n\t\t\t\t\tif (!(value && i in value)) {\n\t\t\t\t\t\tsetStyle(s, i, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (let i in value) {\n\t\t\t\t\tif (!oldValue || value[i] !== oldValue[i]) {\n\t\t\t\t\t\tsetStyle(s, i, value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tnameLower = name.toLowerCase();\n\t\tname = (nameLower in dom ? nameLower : name).slice(2);\n\n\t\tif (value) {\n\t\t\tif (!oldValue) dom.addEventListener(name, eventProxy, useCapture);\n\t\t\t(dom._listeners || (dom._listeners = {}))[name] = value;\n\t\t} else {\n\t\t\tdom.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t} else if (\n\t\tname !== 'list' &&\n\t\tname !== 'tagName' &&\n\t\t// HTMLButtonElement.form and HTMLInputElement.form are read-only but can be set using\n\t\t// setAttribute\n\t\tname !== 'form' &&\n\t\tname !== 'type' &&\n\t\tname !== 'size' &&\n\t\t!isSvg &&\n\t\tname in dom\n\t) {\n\t\tdom[name] = value == null ? '' : value;\n\t} else if (typeof value != 'function' && name !== 'dangerouslySetInnerHTML') {\n\t\tif (name !== (name = name.replace(/^xlink:?/, ''))) {\n\t\t\tif (value == null || value === false) {\n\t\t\t\tdom.removeAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdom.setAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase(),\n\t\t\t\t\tvalue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tvalue == null ||\n\t\t\t(value === false &&\n\t\t\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t\t\t// The value `false` is different from the attribute not\n\t\t\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t\t\t// that other VDOM frameworks also always stringify `false`.\n\t\t\t\t!/^ar/.test(name))\n\t\t) {\n\t\t\tdom.removeAttribute(name);\n\t\t} else {\n\t\t\tdom.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Element | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\t(newVNode._original === oldVNode._original && !c._processingException)\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (tmp = 0; tmp < newVNode._children.length; tmp++) {\n\t\t\t\t\t\tif (newVNode._children[tmp]) {\n\t\t\t\t\t\t\tnewVNode._children[tmp]._parent = newVNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type == Fragment && tmp.key == null;\n\t\t\tnewVNode._children = isTopLevelFragment\n\t\t\t\t? tmp.props.children\n\t\t\t\t: Array.isArray(tmp)\n\t\t\t\t? tmp\n\t\t\t\t: [tmp];\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n\n\treturn newVNode._dom;\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet i;\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvg = newVNode.type === 'svg' || isSvg;\n\n\tif (excessDomChildren != null) {\n\t\tfor (i = 0; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild != null &&\n\t\t\t\t((newVNode.type === null\n\t\t\t\t\t? child.nodeType === 3\n\t\t\t\t\t: child.localName === newVNode.type) ||\n\t\t\t\t\tdom == child)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (newVNode.type === null) {\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tdom = isSvg\n\t\t\t? document.createElementNS('http://www.w3.org/2000/svg', newVNode.type)\n\t\t\t: document.createElement(\n\t\t\t\t\tnewVNode.type,\n\t\t\t\t\tnewProps.is && { is: newProps.is }\n\t\t\t  );\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (newVNode.type === null) {\n\t\tif (oldProps !== newProps && dom.data != newProps) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\tif (excessDomChildren != null) {\n\t\t\texcessDomChildren = EMPTY_ARR.slice.call(dom.childNodes);\n\t\t}\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\tif (oldProps === EMPTY_OBJ) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (!newHtml || !oldHtml || newHtml.__html != oldHtml.__html) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\tnewVNode._children = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tnewVNode.type === 'foreignObject' ? false : isSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tEMPTY_OBJ,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\ti !== dom.value\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { assign } from './util';\nimport { EMPTY_ARR } from './constants';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./index').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props) {\n\tprops = assign(assign({}, vnode.props), props);\n\tif (arguments.length > 2) props.children = EMPTY_ARR.slice.call(arguments, 2);\n\tlet normalizedProps = {};\n\tfor (const i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tprops.key || vnode.key,\n\t\tprops.ref || vnode.ref,\n\t\tnull\n\t);\n}\n","import { enqueueRender } from '../component';\n\n/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, hasCaught;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tif (\n\t\t\t\t\tcomponent.constructor &&\n\t\t\t\t\tcomponent.constructor.getDerivedStateFromError != null\n\t\t\t\t) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.setState(\n\t\t\t\t\t\tcomponent.constructor.getDerivedStateFromError(error)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t}\n\n\t\t\t\tif (hasCaught)\n\t\t\t\t\treturn enqueueRender((component._pendingError = component));\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","export function lastOf<T>(ts: T[]): T | null {\n  return ts[ts.length - 1] || null\n}\n\nexport function sortBy<T>(ts: T[], key: (t: T) => number | string): void {\n  function comparator(a: T, b: T) {\n    const keyA = key(a)\n    const keyB = key(b)\n    return keyA < keyB ? -1 : keyA > keyB ? 1 : 0\n  }\n  ts.sort(comparator)\n}\n\nexport function getOrInsert<K, V>(map: Map<K, V>, k: K, fallback: (k: K) => V): V {\n  if (!map.has(k)) map.set(k, fallback(k))\n  return map.get(k)!\n}\n\nexport function getOrElse<K, V>(map: Map<K, V>, k: K, fallback: (k: K) => V): V {\n  if (!map.has(k)) return fallback(k)\n  return map.get(k)!\n}\n\nexport function getOrThrow<K, V>(map: Map<K, V>, k: K): V {\n  if (!map.has(k)) {\n    throw new Error(`Expected key ${k}`)\n  }\n  return map.get(k)!\n}\n\n// Intended to be used to de-duplicate objects based on a key property. This\n// allows value comparisons to be done efficiently and for the returned objects\n// to be used intuitively in Map objects.\n//\n// Example usage:\n//\n// export class Frame {\n//   private constructor(readonly file: string, readonly name: string) {}\n//   get key() { return `${this.file}:${this.name}` }\n//   static getOrInsert(set: KeyedSet<Frame>, file: string, name: string) {\n//     return set.getOrInsert(set, new Frame(file, name))\n//   }\n// }\n//\nexport interface HasKey {\n  readonly key: string | number\n}\nexport class KeyedSet<T extends HasKey> implements Iterable<T> {\n  private map = new Map<string | number, T>()\n\n  getOrInsert(t: T): T {\n    const key = t.key\n    const existing = this.map.get(key)\n    if (existing) return existing\n    this.map.set(key, t)\n    return t\n  }\n  forEach(fn: (t: T) => void) {\n    this.map.forEach(fn)\n  }\n  [Symbol.iterator]() {\n    return this.map.values()\n  }\n}\n\nexport function* itMap<T, U>(it: Iterable<T>, f: (t: T) => U): Iterable<U> {\n  for (let t of it) {\n    yield f(t)\n  }\n}\n\nexport function itForEach<T>(it: Iterable<T>, f: (t: T) => void): void {\n  for (let t of it) {\n    f(t)\n  }\n}\n\nexport function itReduce<T, U>(it: Iterable<T>, f: (a: U, b: T) => U, init: U): U {\n  let accum: U = init\n  for (let t of it) {\n    accum = f(accum, t)\n  }\n  return accum\n}\n\nexport function zeroPad(s: string, width: number) {\n  return new Array(Math.max(width - s.length, 0) + 1).join('0') + s\n}\n\nexport function formatPercent(percent: number) {\n  let formattedPercent = `${percent.toFixed(0)}%`\n  if (percent === 100) formattedPercent = '100%'\n  else if (percent > 99) formattedPercent = '>99%'\n  else if (percent < 0.01) formattedPercent = '<0.01%'\n  else if (percent < 1) formattedPercent = `${percent.toFixed(2)}%`\n  else if (percent < 10) formattedPercent = `${percent.toFixed(1)}%`\n  return formattedPercent\n}\n\nexport function formatFullPercent(percent: number) {\n  return `${percent.toFixed(0)}%`\n}\n\n/**\n * Calculates the fractional part of a given number. For example fract(3.7) returns 0.7\n */\nexport function fract(x: number) {\n  return x - Math.floor(x)\n}\n\n/**\n * Generates a triangle wave that oscillates linearly between -1 and 0 over the\n * input range with a period of 1\n */\nexport function triangle(x: number) {\n  return 2.0 * Math.abs(fract(x) - 0.5) - 1.0\n}\n\nexport function findValueBisect(\n  lo: number,\n  hi: number,\n  f: (val: number) => number,\n  target: number,\n  targetRangeSize = 1,\n): [number, number] {\n  console.assert(!isNaN(targetRangeSize) && !isNaN(target))\n  while (true) {\n    if (hi - lo <= targetRangeSize) return [lo, hi]\n    const mid = (hi + lo) / 2\n    const val = f(mid)\n    if (val < target) lo = mid\n    else hi = mid\n  }\n}\n\n// Similar to Array.prototype.findIndex, except uses a binary search.\n//\n// This assumes that the condition transitions exactly once from false to true\n// in the list, e.g. the following is a valid input:\n//\n//  ls        = [a, b, c, d]\n//  ls.map(f) = [false, false, true, true]\n//\n// The following is an invalid input:\n//\n//  ls        = [a, b, c, d]\n//  ls.map(f) = [false, true, false, true]\nexport function findIndexBisect<T>(ls: T[], f: (val: T) => boolean): number {\n  if (ls.length === 0) return -1\n\n  let lo = 0\n  let hi = ls.length - 1\n\n  while (hi !== lo) {\n    const mid = Math.floor((lo + hi) / 2)\n\n    if (f(ls[mid])) {\n      // The desired index is <= mid\n      hi = mid\n    } else {\n      // The desired index is > mid\n      lo = mid + 1\n    }\n  }\n\n  return f(ls[hi]) ? hi : -1\n}\n\nexport function noop(...args: any[]) {}\n\nexport function objectsHaveShallowEquality<T extends object>(a: T, b: T): boolean {\n  for (let key in a) {\n    if (a[key] !== b[key]) return false\n  }\n  for (let key in b) {\n    if (a[key] !== b[key]) return false\n  }\n  return true\n}\n\n/**\n * Creates a memoized version of a function that caches the result based on\n * shallow equality of its object argument.\n */\nexport function memoizeByShallowEquality<T extends object, U>(cb: (t: T) => U): (t: T) => U {\n  let last: {args: T; result: U} | null = null\n  return (args: T) => {\n    let result: U\n    if (last == null) {\n      result = cb(args)\n      last = {args, result}\n      return result\n    } else if (objectsHaveShallowEquality(last.args, args)) {\n      return last.result\n    } else {\n      last.args = args\n      last.result = cb(args)\n      return last.result\n    }\n  }\n}\n\n/**\n * Creates a memoized version of a function that caches the result based on\n * the reference equality of its argument.\n */\nexport function memoizeByReference<T, U>(cb: (t: T) => U): (t: T) => U {\n  let last: {args: T; result: U} | null = null\n  return (args: T) => {\n    let result: U\n    if (last == null) {\n      result = cb(args)\n      last = {args, result}\n      return result\n    } else if (last.args === args) {\n      return last.result\n    } else {\n      last.args = args\n      last.result = cb(args)\n      return last.result\n    }\n  }\n}\n\nexport function lazyStatic<T>(cb: () => T): () => T {\n  let last: {result: T} | null = null\n  return () => {\n    if (last == null) {\n      last = {result: cb()}\n    }\n    return last.result\n  }\n}\n\nconst base64lookupTable = lazyStatic((): Map<string, number> => {\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n  const ret = new Map<string, number>()\n  for (let i = 0; i < alphabet.length; i++) {\n    ret.set(alphabet.charAt(i), i)\n  }\n  ret.set('=', -1)\n  return ret\n})\n\n// NOTE: There are probably simpler solutions to this problem, but I have this written already, so\n// until we run into problems with this, let's just use this.\n//\n// See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#The_Unicode_Problem#The_Unicode_Problem\nexport function decodeBase64(encoded: string): Uint8Array {\n  // Reference: https://www.rfc-editor.org/rfc/rfc4648.txt\n\n  const lookupTable = base64lookupTable()\n\n  // 3 byte groups are represented as sequneces of 4 characters.\n  //\n  // \"The encoding process represents 24-bit groups of input bits as output\n  //  strings of 4 encoded characters.\"\n  //\n  // \"Special processing is performed if fewer than 24 bits are available\n  //  at the end of the data being encoded.  A full encoding quantum is\n  //  always completed at the end of a quantity.  When fewer than 24 input\n  //  bits are available in an input group bits with value zero are added\n  //  (on the right) to form an integral number of 6-bit groups.\"\n\n  if (encoded.length % 4 !== 0) {\n    throw new Error(\n      `Invalid length for base64 encoded string. Expected length % 4 = 0, got length = ${encoded.length}`,\n    )\n  }\n\n  const quartetCount = encoded.length / 4\n  let byteCount: number\n\n  // Special processing is performed if fewer than 24 bits are available\n  // at the end of the data being encoded.  A full encoding quantum is\n  // always completed at the end of a quantity.  When fewer than 24 input\n  // bits are available in an input group, bits with value zero are added\n  // (on the right) to form an integral number of 6-bit groups.  Padding\n  // at the end of the data is performed using the '=' character.  Since\n  // all base 64 input is an integral number of octets, only the following\n  // cases can arise:\n  //\n  // (1) The final quantum of encoding input is an integral multiple of 24\n  //     bits; here, the final unit of encoded output will be an integral\n  //     multiple of 4 characters with no \"=\" padding.\n  //\n  // (2) The final quantum of encoding input is exactly 8 bits; here, the\n  //     final unit of encoded output will be two characters followed by\n  //     two \"=\" padding characters.\n  //\n  // (3) The final quantum of encoding input is exactly 16 bits; here, the\n  //     final unit of encoded output will be three characters followed by\n  //     one \"=\" padding character.\n  if (encoded.length >= 4) {\n    if (encoded.charAt(encoded.length - 1) === '=') {\n      if (encoded.charAt(encoded.length - 2) === '=') {\n        // Case (2)\n        byteCount = quartetCount * 3 - 2\n      } else {\n        // Case (3)\n        byteCount = quartetCount * 3 - 1\n      }\n    } else {\n      // Case (1)\n      byteCount = quartetCount * 3\n    }\n  } else {\n    // Case (1)\n    byteCount = quartetCount * 3\n  }\n\n  const bytes = new Uint8Array(byteCount)\n  let offset = 0\n\n  for (let i = 0; i < quartetCount; i++) {\n    const enc1 = encoded.charAt(i * 4 + 0)\n    const enc2 = encoded.charAt(i * 4 + 1)\n    const enc3 = encoded.charAt(i * 4 + 2)\n    const enc4 = encoded.charAt(i * 4 + 3)\n\n    const sextet1 = lookupTable.get(enc1)\n    const sextet2 = lookupTable.get(enc2)\n    const sextet3 = lookupTable.get(enc3)\n    const sextet4 = lookupTable.get(enc4)\n\n    if (sextet1 == null || sextet2 == null || sextet3 == null || sextet4 == null) {\n      throw new Error(\n        `Invalid quartet at indices ${i * 4} .. ${i * 4 + 3}: ${encoded.substring(\n          i * 4,\n          i * 4 + 3,\n        )}`,\n      )\n    }\n\n    bytes[offset++] = (sextet1 << 2) | (sextet2 >> 4)\n    if (enc3 !== '=') {\n      bytes[offset++] = ((sextet2 & 15) << 4) | (sextet3 >> 2)\n    }\n    if (enc4 !== '=') {\n      bytes[offset++] = ((sextet3 & 7) << 6) | sextet4\n    }\n  }\n\n  if (offset !== byteCount) {\n    throw new Error(`Expected to decode ${byteCount} bytes, but only decoded ${offset})`)\n  }\n\n  return bytes\n}\n","class ListNode<V> {\n  prev: ListNode<V> | null = null\n  next: ListNode<V> | null = null\n  constructor(readonly data: V) {}\n}\n\nexport class List<V> {\n  private head: ListNode<V> | null = null\n  private tail: ListNode<V> | null = null\n  private size: number = 0\n  constructor() {}\n\n  getHead(): ListNode<V> | null {\n    return this.head\n  }\n  getTail(): ListNode<V> | null {\n    return this.tail\n  }\n  getSize(): number {\n    return this.size\n  }\n\n  append(node: ListNode<V>): void {\n    if (!this.tail) {\n      this.head = this.tail = node\n    } else {\n      this.tail.next = node\n      node.prev = this.tail\n      this.tail = node\n    }\n    this.size++\n  }\n\n  prepend(node: ListNode<V>): ListNode<V> {\n    if (!this.head) {\n      this.head = this.tail = node\n    } else {\n      this.head.prev = node\n      node.next = this.head\n      this.head = node\n    }\n    this.size++\n    return node\n  }\n\n  pop(): ListNode<V> | null {\n    if (!this.tail) {\n      return null\n    } else {\n      const ret = this.tail\n      if (ret.prev) {\n        this.tail = ret.prev\n        this.tail.next = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.prev = null\n      return ret\n    }\n  }\n\n  dequeue(): ListNode<V> | null {\n    if (!this.head) {\n      return null\n    } else {\n      const ret = this.head\n      if (ret.next) {\n        this.head = ret.next\n        this.head.prev = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.next = null\n      return ret\n    }\n  }\n\n  remove(node: ListNode<V>): void {\n    if (node.prev == null) {\n      this.dequeue()\n    } else if (node.next == null) {\n      this.pop()\n    } else {\n      // Neither first nor last, should be safe to just link\n      // neighbours.\n      node.next.prev = node.prev\n      node.prev.next = node.next\n      node.next = null\n      node.prev = null\n      this.size--\n    }\n  }\n}\n\ninterface LRUCacheNode<K, V> {\n  value: V\n  listNode: ListNode<K>\n}\n\nexport class LRUCache<K, V> {\n  private list = new List<K>()\n  private map = new Map<K, LRUCacheNode<K, V>>()\n\n  constructor(private capacity: number) {}\n\n  has(key: K): boolean {\n    return this.map.has(key)\n  }\n\n  get(key: K): V | null {\n    const node = this.map.get(key)\n    if (!node) {\n      return null\n    }\n    // Bring node to the front of the list\n    this.list.remove(node.listNode)\n    this.list.prepend(node.listNode)\n\n    return node ? node.value : null\n  }\n\n  getSize() {\n    return this.list.getSize()\n  }\n\n  getCapacity() {\n    return this.capacity\n  }\n\n  insert(key: K, value: V) {\n    const node = this.map.get(key)\n    if (node) {\n      this.list.remove(node.listNode)\n    }\n    // Evict old entries when out of capacity\n    while (this.list.getSize() >= this.capacity) {\n      this.map.delete(this.list.pop()!.data)\n    }\n    const listNode = this.list.prepend(new ListNode(key))\n    this.map.set(key, {value, listNode})\n  }\n\n  getOrInsert(key: K, f: (key: K) => V): V {\n    let value = this.get(key)\n    if (value == null) {\n      value = f(key)\n      this.insert(key, value)\n    }\n    return value\n  }\n\n  removeLRU(): [K, V] | null {\n    const oldest = this.list.pop()\n    if (!oldest) return null\n    const key = oldest.data\n    const value = this.map.get(key)!.value\n    this.map.delete(key)\n    return [key, value]\n  }\n\n  clear() {\n    this.list = new List<K>()\n    this.map = new Map<K, LRUCacheNode<K, V>>()\n  }\n}\n","export function clamp(x: number, minVal: number, maxVal: number) {\n  if (x < minVal) return minVal\n  if (x > maxVal) return maxVal\n  return x\n}\n\nexport class Vec2 {\n  constructor(\n    readonly x: number,\n    readonly y: number,\n  ) {}\n  withX(x: number) {\n    return new Vec2(x, this.y)\n  }\n  withY(y: number) {\n    return new Vec2(this.x, y)\n  }\n\n  plus(other: Vec2) {\n    return new Vec2(this.x + other.x, this.y + other.y)\n  }\n  minus(other: Vec2) {\n    return new Vec2(this.x - other.x, this.y - other.y)\n  }\n  times(scalar: number) {\n    return new Vec2(this.x * scalar, this.y * scalar)\n  }\n  timesPointwise(other: Vec2) {\n    return new Vec2(this.x * other.x, this.y * other.y)\n  }\n  dividedByPointwise(other: Vec2) {\n    return new Vec2(this.x / other.x, this.y / other.y)\n  }\n  dot(other: Vec2) {\n    return this.x * other.x + this.y * other.y\n  }\n  equals(other: Vec2) {\n    return this.x === other.x && this.y === other.y\n  }\n  approxEquals(other: Vec2, epsilon = 1e-9) {\n    return Math.abs(this.x - other.x) < epsilon && Math.abs(this.y - other.y) < epsilon\n  }\n\n  length2() {\n    return this.dot(this)\n  }\n  length() {\n    return Math.sqrt(this.length2())\n  }\n  abs() {\n    return new Vec2(Math.abs(this.x), Math.abs(this.y))\n  }\n\n  static min(a: Vec2, b: Vec2) {\n    return new Vec2(Math.min(a.x, b.x), Math.min(a.y, b.y))\n  }\n\n  static max(a: Vec2, b: Vec2) {\n    return new Vec2(Math.max(a.x, b.x), Math.max(a.y, b.y))\n  }\n\n  static clamp(v: Vec2, min: Vec2, max: Vec2) {\n    return new Vec2(clamp(v.x, min.x, max.x), clamp(v.y, min.y, max.y))\n  }\n\n  static zero = new Vec2(0, 0)\n  static unit = new Vec2(1, 1)\n\n  flatten(): [number, number] {\n    return [this.x, this.y]\n  }\n}\n\nexport class AffineTransform {\n  constructor(\n    readonly m00 = 1,\n    readonly m01 = 0,\n    readonly m02 = 0,\n    readonly m10 = 0,\n    readonly m11 = 1,\n    readonly m12 = 0,\n  ) {}\n\n  withScale(s: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m00 = s.x\n    m11 = s.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withScale(s: Vec2) {\n    return new AffineTransform().withScale(s)\n  }\n  scaledBy(s: Vec2) {\n    return AffineTransform.withScale(s).times(this)\n  }\n  getScale() {\n    return new Vec2(this.m00, this.m11)\n  }\n\n  withTranslation(t: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m02 = t.x\n    m12 = t.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withTranslation(t: Vec2) {\n    return new AffineTransform().withTranslation(t)\n  }\n  getTranslation() {\n    return new Vec2(this.m02, this.m12)\n  }\n  translatedBy(t: Vec2) {\n    return AffineTransform.withTranslation(t).times(this)\n  }\n\n  static betweenRects(from: Rect, to: Rect) {\n    return AffineTransform.withTranslation(from.origin.times(-1))\n      .scaledBy(new Vec2(to.size.x / from.size.x, to.size.y / from.size.y))\n      .translatedBy(to.origin)\n  }\n\n  times(other: AffineTransform) {\n    const m00 = this.m00 * other.m00 + this.m01 * other.m10\n    const m01 = this.m00 * other.m01 + this.m01 * other.m11\n    const m02 = this.m00 * other.m02 + this.m01 * other.m12 + this.m02\n\n    const m10 = this.m10 * other.m00 + this.m11 * other.m10\n    const m11 = this.m10 * other.m01 + this.m11 * other.m11\n    const m12 = this.m10 * other.m02 + this.m11 * other.m12 + this.m12\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n\n  equals(other: AffineTransform) {\n    return (\n      this.m00 == other.m00 &&\n      this.m01 == other.m01 &&\n      this.m02 == other.m02 &&\n      this.m10 == other.m10 &&\n      this.m11 == other.m11 &&\n      this.m12 == other.m12\n    )\n  }\n\n  approxEquals(other: AffineTransform, epsilon = 1e-9) {\n    return (\n      Math.abs(this.m00 - other.m00) < epsilon &&\n      Math.abs(this.m01 - other.m01) < epsilon &&\n      Math.abs(this.m02 - other.m02) < epsilon &&\n      Math.abs(this.m10 - other.m10) < epsilon &&\n      Math.abs(this.m11 - other.m11) < epsilon &&\n      Math.abs(this.m12 - other.m12) < epsilon\n    )\n  }\n\n  timesScalar(s: number) {\n    const {m00, m01, m02, m10, m11, m12} = this\n    return new AffineTransform(s * m00, s * m01, s * m02, s * m10, s * m11, s * m12)\n  }\n\n  det() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    return (\n      m00 * (m11 * m22 - m12 * m21) - m01 * (m10 * m22 - m12 * m20) + m02 * (m10 * m21 - m11 * m20)\n    )\n  }\n\n  adj() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    // Adjugate matrix (a) is the transpose of the\n    // cofactor matrix (c).\n    //\n    // 00 01 02\n    // 10 11 12\n    // 20 21 22\n\n    const a00 = /* c00 = */ +(m11 * m22 - m12 * m21)\n    const a01 = /* c10 = */ -(m01 * m22 - m02 * m21)\n    const a02 = /* c20 = */ +(m01 * m12 - m02 * m11)\n    const a10 = /* c01 = */ -(m10 * m22 - m12 * m20)\n    const a11 = /* c11 = */ +(m00 * m22 - m02 * m20)\n    const a12 = /* c21 = */ -(m00 * m12 - m02 * m10)\n\n    return new AffineTransform(a00, a01, a02, a10, a11, a12)\n  }\n\n  inverted(): AffineTransform | null {\n    const det = this.det()\n    if (det === 0) return null\n    const adj = this.adj()\n    return adj.timesScalar(1 / det)\n  }\n\n  transformVector(v: Vec2) {\n    return new Vec2(v.x * this.m00 + v.y * this.m01, v.x * this.m10 + v.y * this.m11)\n  }\n\n  inverseTransformVector(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformVector(v)\n  }\n\n  transformPosition(v: Vec2) {\n    return new Vec2(\n      v.x * this.m00 + v.y * this.m01 + this.m02,\n      v.x * this.m10 + v.y * this.m11 + this.m12,\n    )\n  }\n\n  inverseTransformPosition(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformPosition(v)\n  }\n\n  transformRect(r: Rect) {\n    const size = this.transformVector(r.size)\n    const origin = this.transformPosition(r.origin)\n\n    if (size.x < 0 && size.y < 0) {\n      return new Rect(origin.plus(size), size.abs())\n    } else if (size.x < 0) {\n      return new Rect(origin.withX(origin.x + size.x), size.abs())\n    } else if (size.y < 0) {\n      return new Rect(origin.withY(origin.y + size.y), size.abs())\n    }\n\n    return new Rect(origin, size)\n  }\n\n  inverseTransformRect(r: Rect): Rect | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformRect(r)\n  }\n\n  flatten(): [number, number, number, number, number, number, number, number, number] {\n    // Flatten into GLSL format\n    // prettier-ignore\n    return [\n      this.m00, this.m10, 0,\n      this.m01, this.m11, 0,\n      this.m02, this.m12, 1,\n    ]\n  }\n}\n\nexport class Rect {\n  constructor(\n    readonly origin: Vec2,\n    readonly size: Vec2,\n  ) {}\n\n  isEmpty() {\n    return this.width() == 0 || this.height() == 0\n  }\n\n  width() {\n    return this.size.x\n  }\n  height() {\n    return this.size.y\n  }\n\n  left() {\n    return this.origin.x\n  }\n  right() {\n    return this.left() + this.width()\n  }\n  top() {\n    return this.origin.y\n  }\n  bottom() {\n    return this.top() + this.height()\n  }\n\n  topLeft() {\n    return this.origin\n  }\n  topRight() {\n    return this.origin.plus(new Vec2(this.width(), 0))\n  }\n\n  bottomRight() {\n    return this.origin.plus(this.size)\n  }\n  bottomLeft() {\n    return this.origin.plus(new Vec2(0, this.height()))\n  }\n\n  withOrigin(origin: Vec2) {\n    return new Rect(origin, this.size)\n  }\n  withSize(size: Vec2) {\n    return new Rect(this.origin, size)\n  }\n\n  closestPointTo(p: Vec2) {\n    return new Vec2(clamp(p.x, this.left(), this.right()), clamp(p.y, this.top(), this.bottom()))\n  }\n\n  distanceFrom(p: Vec2) {\n    return p.minus(this.closestPointTo(p)).length()\n  }\n\n  contains(p: Vec2) {\n    return this.distanceFrom(p) === 0\n  }\n\n  hasIntersectionWith(other: Rect) {\n    const top = Math.max(this.top(), other.top())\n    const bottom = Math.max(top, Math.min(this.bottom(), other.bottom()))\n    if (bottom - top === 0) return false\n\n    const left = Math.max(this.left(), other.left())\n    const right = Math.max(left, Math.min(this.right(), other.right()))\n    if (right - left === 0) return false\n    return true\n  }\n\n  intersectWith(other: Rect): Rect {\n    const topLeft = Vec2.max(this.topLeft(), other.topLeft())\n    const bottomRight = Vec2.max(topLeft, Vec2.min(this.bottomRight(), other.bottomRight()))\n\n    return new Rect(topLeft, bottomRight.minus(topLeft))\n  }\n\n  equals(other: Rect) {\n    return this.origin.equals(other.origin) && this.size.equals(other.size)\n  }\n\n  approxEquals(other: Rect) {\n    return this.origin.approxEquals(other.origin) && this.size.approxEquals(other.size)\n  }\n\n  area() {\n    return this.size.x * this.size.y\n  }\n\n  static empty = new Rect(Vec2.zero, Vec2.zero)\n  static unit = new Rect(Vec2.zero, Vec2.unit)\n  static NDC = new Rect(new Vec2(-1, -1), new Vec2(2, 2))\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// This is a port of the GPU APIs from https://github.com/evanw/sky from Skew to\n// TypeScript.\n//\n// The MIT License (MIT)\n// Original work Copyright (c) 2016 Evan Wallace\n// Modified work Copyright (c) 2018 Jamie Wong\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n// NOTE: This file intentionally has no dependencies.\n\n// Dependencies & polyfills for import from skew\nconst RELEASE =\n  typeof process !== 'undefined' && process.env && process.env.NODE_ENV === 'production'\n\nfunction assert(condition: boolean) {\n  if (!RELEASE) {\n    if (!condition) throw new Error('Assertion failed.')\n  }\n}\n\nfunction appendOne<T>(ts: T[], t: T): void {\n  if (ts.indexOf(t) === -1) ts.push(t)\n}\n\nfunction removeOne<T>(ts: T[], t: T): void {\n  const index = ts.indexOf(t)\n  if (index !== -1) ts.splice(index, 1)\n}\n\nfunction TEXTURE_N(gl: WebGLRenderingContext, index: number) {\n  assert(index >= 0 && index <= 31)\n  return (gl.TEXTURE0 + index) as GLenum\n}\n\nexport namespace Graphics {\n  export class Rect {\n    constructor(\n      public x: number = 0,\n      public y: number = 0,\n      public width: number = 0,\n      public height: number = 0,\n    ) {}\n\n    set(x: number, y: number, width: number, height: number) {\n      this.x = x\n      this.y = y\n      this.width = width\n      this.height = height\n    }\n\n    equals(other: Rect) {\n      return (\n        this.x === other.x &&\n        this.y === other.y &&\n        this.width === other.width &&\n        this.height === other.height\n      )\n    }\n  }\n\n  export class Color {\n    constructor(\n      public redF: number,\n      public greenF: number,\n      public blueF: number,\n      public alphaF: number,\n    ) {}\n\n    equals(other: Color): boolean {\n      return (\n        this.redF === other.redF &&\n        this.greenF === other.greenF &&\n        this.blueF === other.blueF &&\n        this.alphaF === other.alphaF\n      )\n    }\n\n    static TRANSPARENT = new Color(0, 0, 0, 0)\n  }\n\n  // Converted from https://github.com/evanw/sky/blob/c72de77/src/graphics/context.sk\n  export enum BlendOperation {\n    ZERO = 0,\n    ONE = 1,\n\n    SOURCE_COLOR = 2,\n    TARGET_COLOR = 3,\n    INVERSE_SOURCE_COLOR = 4,\n    INVERSE_TARGET_COLOR = 5,\n\n    SOURCE_ALPHA = 6,\n    TARGET_ALPHA = 7,\n    INVERSE_SOURCE_ALPHA = 8,\n    INVERSE_TARGET_ALPHA = 9,\n\n    CONSTANT = 10,\n    INVERSE_CONSTANT = 11,\n  }\n\n  export enum Primitive {\n    TRIANGLES,\n    TRIANGLE_STRIP,\n  }\n\n  export abstract class Context {\n    abstract addContextResetHandler(callback: () => void): void\n    abstract beginFrame(): void\n    abstract clear(color: Color): void\n\n    abstract createMaterial(\n      format: VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Material\n    abstract createTexture(\n      format: TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Texture\n    abstract createRenderTarget(texture: Texture): RenderTarget\n    abstract createVertexBuffer(byteCount: number): VertexBuffer\n    abstract currentRenderTarget: RenderTarget | null\n    abstract draw(primitive: Primitive, material: Material, vertices: VertexBuffer): void\n    abstract endFrame(): void\n    abstract removeContextResetHandler(callback: () => void): void\n    abstract resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ): void\n    abstract setRenderTarget(renderTarget: RenderTarget | null): void\n    abstract setViewport(x: number, y: number, width: number, height: number): void\n    abstract viewport: Rect\n    abstract widthInPixels: number\n    abstract heightInPixels: number\n\n    abstract renderTargetHeightInPixels: number\n    abstract renderTargetWidthInPixels: number\n\n    abstract setBlendState(source: BlendOperation, target: BlendOperation): void\n    setCopyBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ZERO)\n    }\n    setAddBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ONE)\n    }\n    setPremultipliedBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n    setUnpremultipliedBlendState() {\n      this.setBlendState(BlendOperation.SOURCE_ALPHA, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n\n    protected resizeEventHandlers = new Set<() => void>()\n    addAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.add(callback)\n    }\n    removeAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.delete(callback)\n    }\n  }\n\n  export interface Material {\n    context: Context\n    format: VertexFormat\n    fragmentSource: string\n    vertexSource: string\n    setUniformFloat(name: string, x: number): void\n    setUniformInt(name: string, x: number): void\n    setUniformVec2(name: string, x: number, y: number): void\n    setUniformVec3(name: string, x: number, y: number, z: number): void\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number): void\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ): void\n    setUniformSampler(name: string, texture: Texture, index: number): void\n  }\n\n  export enum AttributeType {\n    FLOAT,\n    BYTE,\n  }\n\n  export function attributeByteLength(type: AttributeType) {\n    return type == AttributeType.FLOAT ? 4 : 1\n  }\n\n  export class Attribute {\n    constructor(\n      readonly name: string,\n      readonly type: AttributeType,\n      readonly count: number,\n      readonly byteOffset: number,\n    ) {}\n  }\n\n  export class VertexFormat {\n    private _attributes: Attribute[] = []\n    private _stride = 0\n\n    get attributes() {\n      return this._attributes\n    }\n    get stride() {\n      return this._stride\n    }\n\n    add(name: string, type: AttributeType, count: number): VertexFormat {\n      this.attributes.push(new Attribute(name, type, count, this.stride))\n      this._stride += count * attributeByteLength(type)\n      return this\n    }\n  }\n\n  export abstract class VertexBuffer {\n    abstract byteCount: number\n    abstract context: Context\n    abstract move(sourceByteOffset: number, targetByteOffset: number, byteCount: number): void\n    abstract upload(bytes: Uint8Array, byteOffset?: number): void\n    uploadFloat32Array(floats: Float32Array) {\n      this.upload(new Uint8Array(floats.buffer), 0)\n    }\n    uploadFloats(floats: number[]) {\n      this.uploadFloat32Array(new Float32Array(floats))\n    }\n    abstract free(): void\n  }\n\n  export enum PixelFilter {\n    NEAREST,\n    LINEAR,\n  }\n\n  export enum PixelWrap {\n    REPEAT,\n    CLAMP,\n  }\n\n  export class TextureFormat {\n    constructor(\n      readonly minFilter: PixelFilter,\n      readonly magFilter: PixelFilter,\n      readonly wrap: PixelWrap,\n    ) {}\n\n    static LINEAR_CLAMP = new TextureFormat(PixelFilter.LINEAR, PixelFilter.LINEAR, PixelWrap.CLAMP)\n    static LINEAR_MIN_NEAREST_MAG_CLAMP = new TextureFormat(\n      PixelFilter.LINEAR,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n    static NEAREST_CLAMP = new TextureFormat(\n      PixelFilter.NEAREST,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n  }\n\n  export interface Texture {\n    context: Context\n    format: TextureFormat\n    width: number\n    height: number\n    resize(width: number, height: number, pixels?: Uint8Array): void\n    setFormat(format: TextureFormat): void\n    free(): void\n  }\n\n  export interface RenderTarget {\n    context: Context\n    texture: Texture\n    setColor(texture: Texture): void\n    free(): void\n  }\n}\n\n// Converted from https://github.com/evanw/sky/blob/c72de77/src/browser/context.sk\nexport namespace WebGL {\n  export class Context extends Graphics.Context {\n    private _attributeCount = 0\n    private _blendOperationMap: {[key: number]: GLenum}\n    private _blendOperations = 0\n    private _contextResetHandlers: (() => void)[] = []\n    private _currentClearColor = Graphics.Color.TRANSPARENT\n    private _currentRenderTarget: RenderTarget | null = null\n    private _defaultViewport = new Graphics.Rect()\n    private _forceStateUpdate = true\n    private _generation = 1\n    private _gl: WebGLRenderingContext\n    private _height = 0\n    private _oldBlendOperations = 0\n    private _oldRenderTarget: RenderTarget | null = null\n    private _oldViewport = new Graphics.Rect()\n    private _width = 0\n\n    get widthInPixels() {\n      return this._width\n    }\n    get heightInPixels() {\n      return this._height\n    }\n\n    constructor(canvas: HTMLCanvasElement = document.createElement('canvas')) {\n      super()\n      let gl = canvas.getContext('webgl', {\n        alpha: false,\n        antialias: false,\n        depth: false,\n        preserveDrawingBuffer: false,\n        stencil: false,\n      })\n\n      if (gl == null) {\n        throw new Error('Setup failure')\n      }\n\n      this._gl = gl\n      let style = canvas.style\n      canvas.width = 0\n      canvas.height = 0\n      style.width = style.height = '0'\n\n      canvas.addEventListener('webglcontextlost', (e: Event) => {\n        e.preventDefault()\n      })\n\n      canvas.addEventListener('webglcontextrestored', this.handleWebglContextRestored)\n\n      // Using maps makes these compact in release\n      this._blendOperationMap = {\n        [Graphics.BlendOperation.ZERO]: this._gl.ZERO,\n        [Graphics.BlendOperation.ONE]: this._gl.ONE,\n\n        [Graphics.BlendOperation.SOURCE_COLOR]: this._gl.SRC_COLOR,\n        [Graphics.BlendOperation.TARGET_COLOR]: this._gl.DST_COLOR,\n        [Graphics.BlendOperation.INVERSE_SOURCE_COLOR]: this._gl.ONE_MINUS_SRC_COLOR,\n        [Graphics.BlendOperation.INVERSE_TARGET_COLOR]: this._gl.ONE_MINUS_DST_COLOR,\n\n        [Graphics.BlendOperation.SOURCE_ALPHA]: this._gl.SRC_ALPHA,\n        [Graphics.BlendOperation.TARGET_ALPHA]: this._gl.DST_ALPHA,\n        [Graphics.BlendOperation.INVERSE_SOURCE_ALPHA]: this._gl.ONE_MINUS_SRC_ALPHA,\n        [Graphics.BlendOperation.INVERSE_TARGET_ALPHA]: this._gl.ONE_MINUS_DST_ALPHA,\n\n        [Graphics.BlendOperation.CONSTANT]: this._gl.CONSTANT_COLOR,\n        [Graphics.BlendOperation.INVERSE_CONSTANT]: this._gl.ONE_MINUS_CONSTANT_COLOR,\n      }\n    }\n\n    private handleWebglContextRestored = () => {\n      this._attributeCount = 0\n      this._currentClearColor = Graphics.Color.TRANSPARENT\n      this._forceStateUpdate = true\n      this._generation++\n      for (let handler of this._contextResetHandlers) {\n        handler()\n      }\n    }\n\n    public testContextLoss() {\n      this.handleWebglContextRestored()\n    }\n\n    get gl() {\n      return this._gl\n    }\n    get generation() {\n      return this._generation\n    }\n    addContextResetHandler(callback: () => void) {\n      appendOne(this._contextResetHandlers, callback)\n    }\n    removeContextResetHandler(callback: () => void) {\n      removeOne(this._contextResetHandlers, callback)\n    }\n\n    get currentRenderTarget() {\n      return this._currentRenderTarget\n    }\n\n    beginFrame() {\n      this.setRenderTarget(null)\n    }\n\n    endFrame() {}\n\n    setBlendState(source: Graphics.BlendOperation, target: Graphics.BlendOperation) {\n      this._blendOperations = Context._packBlendModes(source, target)\n    }\n\n    setViewport(x: number, y: number, width: number, height: number) {\n      ;(this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n      ).set(x, y, width, height)\n    }\n\n    get viewport() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n    }\n\n    get renderTargetWidthInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.width\n        : this._width\n    }\n\n    get renderTargetHeightInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.height\n        : this._height\n    }\n\n    draw(\n      primitive: Graphics.Primitive,\n      material: Graphics.Material,\n      vertices: Graphics.VertexBuffer,\n    ) {\n      // Update the texture set before preparing the material so uniform samplers can check for that they use different textures\n      this._updateRenderTargetAndViewport()\n      Material.from(material).prepare()\n\n      // Update the vertex buffer before updating the format so attributes can bind correctly\n      VertexBuffer.from(vertices).prepare()\n      this._updateFormat(material.format)\n\n      // Draw now that everything is ready\n      this._updateBlendState()\n\n      this._gl.drawArrays(\n        primitive == Graphics.Primitive.TRIANGLES ? this._gl.TRIANGLES : this._gl.TRIANGLE_STRIP,\n        0,\n        Math.floor(vertices.byteCount / material.format.stride),\n      )\n\n      // Forced state updates are done once after a context loss\n      this._forceStateUpdate = false\n    }\n\n    resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ) {\n      let canvas = this._gl.canvas as HTMLCanvasElement\n      const bounds = canvas.getBoundingClientRect()\n\n      if (\n        this._width === widthInPixels &&\n        this._height === heightInPixels &&\n        bounds.width === widthInAppUnits &&\n        bounds.height === heightInAppUnits\n      ) {\n        // Nothing to do here!\n        return\n      }\n\n      let style = canvas.style\n      canvas.width = widthInPixels\n      canvas.height = heightInPixels\n      style.width = `${widthInAppUnits}px`\n      style.height = `${heightInAppUnits}px`\n      this.setViewport(0, 0, widthInPixels, heightInPixels)\n      this._width = widthInPixels\n      this._height = heightInPixels\n\n      this.resizeEventHandlers.forEach(cb => cb())\n    }\n\n    clear(color: Graphics.Color) {\n      this._updateRenderTargetAndViewport()\n      this._updateBlendState()\n\n      if (!color.equals(this._currentClearColor)) {\n        this._gl.clearColor(color.redF, color.greenF, color.blueF, color.alphaF)\n        this._currentClearColor = color\n      }\n\n      this._gl.clear(this._gl.COLOR_BUFFER_BIT)\n    }\n\n    setRenderTarget(renderTarget: Graphics.RenderTarget | null) {\n      this._currentRenderTarget = RenderTarget.from(renderTarget)\n    }\n\n    createMaterial(\n      format: Graphics.VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Graphics.Material {\n      let material = new Material(this, format, vertexSource, fragmentSource)\n\n      // Compiling shaders is really expensive so we want to get that started\n      // as early as possible. In Chrome and possibly other browsers, shader\n      // compilation can happen asynchronously as long as you don't call\n      // useProgram().\n      //\n      //   https://plus.google.com/+BrandonJonesToji/posts/4ERHkicC5Ny\n      //\n      material.program\n\n      return material\n    }\n\n    createVertexBuffer(byteCount: number): Graphics.VertexBuffer {\n      assert(byteCount > 0 && byteCount % 4 == 0)\n      return new VertexBuffer(this, byteCount)\n    }\n\n    createTexture(\n      format: Graphics.TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Graphics.Texture {\n      return new Texture(this, format, width, height, pixels)\n    }\n\n    createRenderTarget(texture: Graphics.Texture): Graphics.RenderTarget {\n      return new RenderTarget(this, Texture.from(texture))\n    }\n\n    private ANGLE_instanced_arrays: ANGLE_instanced_arrays | null = null\n    private ANGLE_instanced_arrays_generation: number = -1\n    getANGLE_instanced_arrays(): ANGLE_instanced_arrays {\n      if (this.ANGLE_instanced_arrays_generation !== this._generation) {\n        this.ANGLE_instanced_arrays = null\n      }\n      if (!this.ANGLE_instanced_arrays) {\n        this.ANGLE_instanced_arrays = this.gl.getExtension('ANGLE_instanced_arrays')\n        if (!this.ANGLE_instanced_arrays) {\n          throw new Error('Failed to get extension ANGLE_instanced_arrays')\n        }\n      }\n      return this.ANGLE_instanced_arrays!\n    }\n\n    _updateRenderTargetAndViewport() {\n      let renderTarget = this._currentRenderTarget\n      let viewport = renderTarget != null ? renderTarget.viewport : this._defaultViewport\n      let gl = this._gl\n\n      if (this._forceStateUpdate || this._oldRenderTarget != renderTarget) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, renderTarget ? renderTarget.framebuffer : null)\n        this._oldRenderTarget = renderTarget\n      }\n\n      if (this._forceStateUpdate || !this._oldViewport.equals(viewport)) {\n        gl.viewport(\n          viewport.x,\n          this.renderTargetHeightInPixels - viewport.y - viewport.height,\n          viewport.width,\n          viewport.height,\n        )\n        this._oldViewport.set(viewport.x, viewport.y, viewport.width, viewport.height)\n      }\n    }\n\n    _updateBlendState() {\n      if (this._forceStateUpdate || this._oldBlendOperations != this._blendOperations) {\n        let gl = this._gl\n        let operations = this._blendOperations\n        let oldOperations = this._oldBlendOperations\n        let source = (operations & 0xf) as Graphics.BlendOperation\n        let target = (operations >> 4) as Graphics.BlendOperation\n\n        assert(source in this._blendOperationMap)\n        assert(target in this._blendOperationMap)\n\n        // Special-case the blend mode that just writes over the target buffer\n        if (operations == Context.COPY_BLEND_OPERATIONS) {\n          gl.disable(gl.BLEND)\n        } else {\n          if (this._forceStateUpdate || oldOperations == Context.COPY_BLEND_OPERATIONS) {\n            gl.enable(gl.BLEND)\n          }\n\n          // Otherwise, use actual blending\n          gl.blendFunc(this._blendOperationMap[source], this._blendOperationMap[target])\n        }\n\n        this._oldBlendOperations = operations\n      }\n    }\n\n    _updateFormat(format: Graphics.VertexFormat) {\n      // Update the attributes\n      let gl = this._gl\n      let attributes = format.attributes\n      let count = attributes.length\n      for (let i = 0; i < count; i++) {\n        let attribute = attributes[i]\n        let isByte = attribute.type == Graphics.AttributeType.BYTE\n        gl.vertexAttribPointer(\n          i,\n          attribute.count,\n          isByte ? gl.UNSIGNED_BYTE : gl.FLOAT,\n          isByte,\n          format.stride,\n          attribute.byteOffset,\n        )\n      }\n\n      // Update the attribute count\n      while (this._attributeCount < count) {\n        gl.enableVertexAttribArray(this._attributeCount)\n        this._attributeCount++\n      }\n      while (this._attributeCount > count) {\n        this._attributeCount--\n        gl.disableVertexAttribArray(this._attributeCount)\n      }\n      this._attributeCount = count\n    }\n\n    getWebGLInfo(): {renderer: string | null; vendor: string | null; version: string | null} {\n      const ext = this.gl.getExtension('WEBGL_debug_renderer_info')\n      const renderer = ext ? this.gl.getParameter(ext.UNMASKED_RENDERER_WEBGL) : null\n      const vendor = ext ? this.gl.getParameter(ext.UNMASKED_VENDOR_WEBGL) : null\n      const version = this.gl.getParameter(this.gl.VERSION)\n      return {renderer, vendor, version}\n    }\n\n    static from(context: Graphics.Context): Context {\n      assert(context == null || context instanceof Context)\n      return context as Context\n    }\n\n    static _packBlendModes(\n      source: Graphics.BlendOperation,\n      target: Graphics.BlendOperation,\n    ): number {\n      return source | (target << 4)\n    }\n\n    static COPY_BLEND_OPERATIONS = Context._packBlendModes(\n      Graphics.BlendOperation.ONE,\n      Graphics.BlendOperation.ZERO,\n    )\n  }\n\n  abstract class Uniform {\n    constructor(\n      protected readonly _material: Material,\n      protected readonly _name: string,\n      protected _generation = 0,\n      protected _location: WebGLUniformLocation | null = null,\n      protected _isDirty = true,\n    ) {}\n\n    // Upload this uniform if it's dirty\n    abstract prepare(): void\n\n    get location(): WebGLUniformLocation {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation) {\n        this._location = context.gl.getUniformLocation(this._material.program, this._name)\n        this._generation = context.generation\n\n        // Validate the shader against this uniform\n        if (!RELEASE) {\n          let program = this._material.program\n          let gl = context.gl\n          for (let i = 0, ii = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS); i < ii; i++) {\n            let info = gl.getActiveUniform(program, i)\n            if (info && info.name == this._name) {\n              assert(info.size == 1)\n              switch (info.type) {\n                case gl.FLOAT: {\n                  assert(this instanceof UniformFloat)\n                  break\n                }\n                case gl.FLOAT_MAT3: {\n                  assert(this instanceof UniformMat3)\n                  break\n                }\n                case gl.FLOAT_VEC2: {\n                  assert(this instanceof UniformVec2)\n                  break\n                }\n                case gl.FLOAT_VEC3: {\n                  assert(this instanceof UniformVec3)\n                  break\n                }\n                case gl.FLOAT_VEC4: {\n                  assert(this instanceof UniformVec4)\n                  break\n                }\n                case gl.INT: {\n                  assert(this instanceof UniformInt)\n                  break\n                }\n                case gl.SAMPLER_2D: {\n                  assert(this instanceof UniformSampler)\n                  break\n                }\n                default:\n                  assert(false)\n              }\n            }\n          }\n        }\n      }\n      if (!this._location) {\n        throw new Error('Failed to get uniform location')\n      }\n      return this._location\n    }\n  }\n\n  class UniformFloat extends Uniform {\n    private _x = 0.0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1f(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformInt extends Uniform {\n    private _x = 0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1i(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec2 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n\n    set(x: number, y: number) {\n      if (x != this._x || y != this._y) {\n        this._x = x\n        this._y = y\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform2f(this.location, this._x, this._y)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec3 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n\n    set(x: number, y: number, z: number) {\n      if (x != this._x || y != this._y || z != this._z) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform3f(this.location, this._x, this._y, this._z)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec4 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n    private _w = 0.0\n\n    set(x: number, y: number, z: number, w: number) {\n      if (x != this._x || y != this._y || z != this._z || w != this._w) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._w = w\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform4f(this.location, this._x, this._y, this._z, this._w)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformMat3 extends Uniform {\n    private _values = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n\n    set(\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      // These values are deliberately transposed because WebGL requires the \"transpose\" argument of uniformMatrix() to be false\n      UniformMat3._cachedValues[0] = m00\n      UniformMat3._cachedValues[1] = m10\n      UniformMat3._cachedValues[2] = m20\n      UniformMat3._cachedValues[3] = m01\n      UniformMat3._cachedValues[4] = m11\n      UniformMat3._cachedValues[5] = m21\n      UniformMat3._cachedValues[6] = m02\n      UniformMat3._cachedValues[7] = m12\n      UniformMat3._cachedValues[8] = m22\n\n      for (let i = 0; i < 9; i++) {\n        if (UniformMat3._cachedValues[i] != this._values[i]) {\n          let swap = this._values\n          this._values = UniformMat3._cachedValues\n          UniformMat3._cachedValues = swap\n          this._isDirty = true\n          break\n        }\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniformMatrix3fv(this.location, false, this._values)\n        this._isDirty = false\n      }\n    }\n\n    // Statically allocate this to avoid allocations\n    static _cachedValues = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n  }\n\n  class UniformSampler extends Uniform {\n    private _texture: Texture | null = null\n    private _index = -1\n\n    set(texture: Graphics.Texture, index: number) {\n      if (this._texture != texture || this._index != index) {\n        this._texture = Texture.from(texture)\n        this._index = index\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      let gl = context.gl\n      assert(\n        this._texture == null ||\n          context.currentRenderTarget == null ||\n          this._texture != context.currentRenderTarget.texture,\n      )\n      if (this._generation != context.generation || this._isDirty) {\n        gl.uniform1i(this.location, this._index)\n        this._isDirty = false\n      }\n      gl.activeTexture(TEXTURE_N(gl, this._index))\n      gl.bindTexture(\n        gl.TEXTURE_2D,\n        this._texture != null && this._texture.width > 0 && this._texture.height > 0\n          ? this._texture.texture\n          : null,\n      )\n    }\n  }\n\n  class Material implements Graphics.Material {\n    constructor(\n      private readonly _context: Context,\n      private readonly _format: Graphics.VertexFormat,\n      private readonly _vertexSource: string,\n      private readonly _fragmentSource: string,\n      private readonly _uniformsMap: {[key: string]: Uniform} = {},\n      private readonly _uniformsList: Uniform[] = [],\n      private _generation = 0,\n      private _program: WebGLProgram | null = null,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get vertexSource() {\n      return this._vertexSource\n    }\n    get fragmentSource() {\n      return this._fragmentSource\n    }\n\n    setUniformFloat(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformFloat(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformFloat)\n      ;(uniform as UniformFloat).set(x)\n    }\n\n    setUniformInt(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformInt(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformInt)\n      ;(uniform as UniformInt).set(x)\n    }\n\n    setUniformVec2(name: string, x: number, y: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec2(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec2)\n      ;(uniform as UniformVec2).set(x, y)\n    }\n\n    setUniformVec3(name: string, x: number, y: number, z: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec3)\n      ;(uniform as UniformVec3).set(x, y, z)\n    }\n\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec4(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec4)\n      ;(uniform as UniformVec4).set(x, y, z, w)\n    }\n\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformMat3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformMat3)\n      ;(uniform as UniformMat3).set(m00, m01, m02, m10, m11, m12, m20, m21, m22)\n    }\n\n    setUniformSampler(name: string, texture: Graphics.Texture, index: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformSampler(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformSampler)\n      ;(uniform as UniformSampler).set(texture, index)\n    }\n\n    get program(): WebGLProgram {\n      let gl = this._context.gl\n      if (this._generation != this._context.generation) {\n        this._program = gl.createProgram()!\n        this._compileShader(gl, gl.VERTEX_SHADER, this.vertexSource)\n        this._compileShader(gl, gl.FRAGMENT_SHADER, this.fragmentSource)\n        let attributes = this.format.attributes\n        for (let i = 0; i < attributes.length; i++) {\n          gl.bindAttribLocation(this._program, i, attributes[i].name)\n        }\n        gl.linkProgram(this._program)\n        if (!gl.getProgramParameter(this._program, gl.LINK_STATUS)) {\n          throw new Error(`${gl.getProgramInfoLog(this._program)}`)\n        }\n        this._generation = this._context.generation\n\n        // Validate this shader against the format\n        if (!RELEASE) {\n          for (let attribute of attributes) {\n            for (\n              let i = 0, ii = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n              i < ii;\n              i++\n            ) {\n              let info = gl.getActiveAttrib(this.program, i)\n              if (info && info.name == attribute.name) {\n                assert(info.size == 1)\n                switch (attribute.count) {\n                  case 1: {\n                    assert(info.type == gl.FLOAT)\n                    break\n                  }\n                  case 2: {\n                    assert(info.type == gl.FLOAT_VEC2)\n                    break\n                  }\n                  case 3: {\n                    assert(info.type == gl.FLOAT_VEC3)\n                    break\n                  }\n                  case 4: {\n                    assert(info.type == gl.FLOAT_VEC4)\n                    break\n                  }\n                  default: {\n                    assert(false)\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      return this._program!\n    }\n\n    prepare(): void {\n      this._context.gl.useProgram(this.program)\n      for (let uniform of this._uniformsList) {\n        uniform.prepare()\n      }\n    }\n\n    _compileShader(gl: WebGLRenderingContext, type: GLenum, source: string) {\n      let shader = gl.createShader(type)\n      if (!shader) {\n        throw new Error('Failed to create shader')\n      }\n      gl.shaderSource(shader, source)\n      gl.compileShader(shader)\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        throw new Error(`${gl.getShaderInfoLog(shader)}`)\n      }\n      if (!this._program) {\n        throw new Error('Tried to attach shader before program was created')\n      }\n      gl.attachShader(this._program, shader)\n    }\n\n    static from(material: Graphics.Material): Material {\n      assert(material == null || material instanceof Material)\n      return material as Material\n    }\n  }\n\n  class VertexBuffer extends Graphics.VertexBuffer {\n    private readonly _context: Context\n    private _generation = 0\n    private _buffer: WebGLBuffer | null = null\n    private _bytes: Uint8Array | null = null\n    private _isDirty = true\n    private _dirtyMin = VertexBuffer.INT_MAX\n    private _dirtyMax = 0\n    private _totalMin = VertexBuffer.INT_MAX\n    private _totalMax = 0\n    private _byteCount = 0\n\n    constructor(context: Context, byteCount: number) {\n      super()\n      this._context = context\n      this._byteCount = byteCount\n      this._bytes = new Uint8Array(byteCount)\n    }\n\n    get context() {\n      return this._context\n    }\n    get byteCount() {\n      return this._byteCount\n    }\n\n    move(sourceByteOffset: number, targetByteOffset: number, byteCount: number) {\n      assert(byteCount >= 0)\n      assert(0 <= sourceByteOffset && sourceByteOffset + byteCount <= this._byteCount)\n      assert(0 <= targetByteOffset && targetByteOffset + byteCount <= this._byteCount)\n\n      if (this._bytes && sourceByteOffset != targetByteOffset && byteCount != 0) {\n        this._bytes.set(this._bytes.subarray(sourceByteOffset, this._byteCount), targetByteOffset)\n        this._growDirtyRegion(\n          Math.min(sourceByteOffset, targetByteOffset),\n          Math.max(sourceByteOffset, targetByteOffset) + byteCount,\n        )\n      }\n    }\n\n    upload(bytes: Uint8Array, byteOffset: number = 0) {\n      assert(0 <= byteOffset && byteOffset + bytes.length <= this._byteCount)\n      assert(this._bytes != null)\n      this._bytes!.set(bytes, byteOffset)\n      this._growDirtyRegion(byteOffset, byteOffset + bytes.length)\n    }\n\n    free() {\n      if (this._buffer) {\n        this._context.gl.deleteBuffer(this._buffer)\n      }\n\n      // Reset the generation to force this to be re-uploaded if it's used again\n      // in the future.\n      this._generation = 0\n    }\n\n    prepare(): void {\n      let gl = this._context.gl\n\n      if (this._generation !== this._context.generation) {\n        this._buffer = gl.createBuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer)\n\n      if (this._isDirty) {\n        gl.bufferData(gl.ARRAY_BUFFER, this._byteCount, gl.DYNAMIC_DRAW)\n        this._dirtyMin = this._totalMin\n        this._dirtyMax = this._totalMax\n        this._isDirty = false\n      }\n\n      if (this._dirtyMin < this._dirtyMax) {\n        gl.bufferSubData(\n          gl.ARRAY_BUFFER,\n          this._dirtyMin,\n          this._bytes!.subarray(this._dirtyMin, this._dirtyMax),\n        )\n        this._dirtyMin = VertexBuffer.INT_MAX\n        this._dirtyMax = 0\n      }\n    }\n\n    _growDirtyRegion(min: number, max: number) {\n      this._dirtyMin = Math.min(this._dirtyMin, min)\n      this._dirtyMax = Math.max(this._dirtyMax, max)\n      this._totalMin = Math.min(this._totalMin, min)\n      this._totalMax = Math.max(this._totalMax, max)\n    }\n\n    static INT_MAX = 0x7fffffff\n\n    static from(buffer: Graphics.VertexBuffer): VertexBuffer {\n      assert(buffer == null || buffer instanceof VertexBuffer)\n      return buffer as VertexBuffer\n    }\n  }\n\n  class Texture implements Graphics.Texture {\n    constructor(\n      private readonly _context: Context,\n      private _format: Graphics.TextureFormat,\n      private _width: number,\n      private _height: number,\n      private _pixels: Uint8Array | null = null,\n      private _texture: WebGLTexture | null = null,\n      private _generation = 0,\n      private _isFormatDirty = true,\n      private _isContentDirty = true,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get width() {\n      return this._width\n    }\n    get height() {\n      return this._height\n    }\n\n    resize(width: number, height: number, pixels: Uint8Array | null = null) {\n      this._width = width\n      this._height = height\n      this._pixels = pixels\n      this._isContentDirty = true\n    }\n\n    setFormat(format: Graphics.TextureFormat) {\n      if (this._format != format) {\n        this._format = format\n        this._isFormatDirty = true\n      }\n    }\n\n    get texture(): WebGLTexture {\n      let gl = this._context.gl\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._texture = gl.createTexture()\n        this._generation = this._context.generation\n        this._isFormatDirty = true\n        this._isContentDirty = true\n      }\n\n      // Format\n      if (this._isFormatDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MAG_FILTER,\n          this.format.magFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MIN_FILTER,\n          this.format.minFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_S,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_T,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        this._isFormatDirty = false\n      }\n\n      if (this._isContentDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          this._width,\n          this._height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          this._pixels,\n        )\n        this._isContentDirty = false\n      }\n\n      return this._texture!\n    }\n\n    free() {\n      if (this.texture) {\n        this._context.gl.deleteTexture(this.texture)\n        this._generation = 0\n      }\n    }\n\n    static from(texture: Graphics.Texture): Texture {\n      assert(texture == null || texture instanceof Texture)\n      return texture as Texture\n    }\n  }\n\n  class RenderTarget implements Graphics.RenderTarget {\n    constructor(\n      private _context: Context,\n      private _texture: Texture,\n      private _framebuffer: WebGLFramebuffer | null = null,\n      private _generation = 0,\n      private _isDirty = true,\n      private _viewport = new Graphics.Rect(),\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get texture() {\n      return this._texture\n    }\n    get viewport() {\n      return this._viewport\n    }\n    setColor(texture: Graphics.Texture) {\n      if (this._texture != texture) {\n        this._texture = Texture.from(texture)\n        this._isDirty = true\n      }\n    }\n\n    get framebuffer(): WebGLFramebuffer {\n      let gl = this._context.gl\n      let texture = this._texture.texture\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._framebuffer = gl.createFramebuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      // Update\n      if (this._isDirty) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer)\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0)\n        assert(gl.checkFramebufferStatus(gl.FRAMEBUFFER) == gl.FRAMEBUFFER_COMPLETE)\n        this._isDirty = false\n      }\n\n      return this._framebuffer!\n    }\n\n    free() {\n      if (this._framebuffer) {\n        this._context.gl.deleteFramebuffer(this._framebuffer)\n        this._generation = 0\n      }\n    }\n\n    static from(renderTarget: Graphics.RenderTarget | null): RenderTarget | null {\n      assert(renderTarget == null || renderTarget instanceof RenderTarget)\n      return renderTarget as RenderTarget | null\n    }\n  }\n}\n","import {Graphics} from './graphics'\nimport {AffineTransform, Vec2} from '../lib/math'\n\nexport function setUniformAffineTransform(\n  material: Graphics.Material,\n  name: string,\n  transform: AffineTransform,\n) {\n  let {m00, m01, m02, m10, m11, m12} = transform\n  material.setUniformMat3(name, m00, m01, m02, m10, m11, m12, 0, 0, 1)\n}\nexport function setUniformVec2(material: Graphics.Material, name: string, vec: Vec2) {\n  material.setUniformVec2(name, vec.x, vec.y)\n}\n\nexport function renderInto(gl: Graphics.Context, target: Graphics.RenderTarget, cb: () => void) {\n  gl.setRenderTarget(target)\n  gl.setViewport(0, 0, target.texture.width, target.texture.height)\n  cb()\n  gl.setRenderTarget(null)\n}\n","import {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('configSpacePos', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('color', Graphics.AttributeType.FLOAT, 3)\n\nconst vert = `\n  uniform mat3 configSpaceToNDC;\n\n  attribute vec2 configSpacePos;\n  attribute vec3 color;\n  varying vec3 vColor;\n\n  void main() {\n    vColor = color;\n    vec2 position = (configSpaceToNDC * vec3(configSpacePos, 1)).xy;\n    gl_Position = vec4(position, 1, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n  varying vec3 vColor;\n\n  void main() {\n    gl_FragColor = vec4(vColor.rgb, 1);\n  }\n`\n\nexport class RectangleBatch {\n  private rects: Rect[] = []\n  private colors: Color[] = []\n  constructor(private gl: Graphics.Context) {}\n\n  getRectCount() {\n    return this.rects.length\n  }\n\n  private buffer: Graphics.VertexBuffer | null = null\n  getBuffer(): Graphics.VertexBuffer {\n    if (this.buffer) {\n      return this.buffer\n    }\n\n    const corners = [\n      [0, 0],\n      [1, 0],\n      [0, 1],\n      [1, 0],\n      [0, 1],\n      [1, 1],\n    ]\n\n    const bytes = new Uint8Array(vertexFormat.stride * corners.length * this.rects.length)\n    const floats = new Float32Array(bytes.buffer)\n    let idx = 0\n\n    for (let i = 0; i < this.rects.length; i++) {\n      const rect = this.rects[i]\n      const color = this.colors[i]\n\n      // TODO(jlfwong): In the conversion from regl to graphics.ts, I lost the\n      // ability to do instanced drawing. This is a pretty significant hit to\n      // the performance here since I need 6x the memory to allocate these\n      // things. Adding instanced drawing to graphics.ts is non-trivial, so I'm\n      // just going to try this for now.\n      for (let corner of corners) {\n        floats[idx++] = rect.origin.x + corner[0] * rect.size.x\n        floats[idx++] = rect.origin.y + corner[1] * rect.size.y\n\n        floats[idx++] = color.r\n        floats[idx++] = color.g\n        floats[idx++] = color.b\n      }\n    }\n\n    if (idx !== floats.length) {\n      throw new Error(\"Buffer expected to be full but wasn't\")\n    }\n\n    this.buffer = this.gl.createVertexBuffer(bytes.length)\n    this.buffer.upload(bytes)\n    return this.buffer\n  }\n\n  addRect(rect: Rect, color: Color) {\n    this.rects.push(rect)\n    this.colors.push(color)\n\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n\n  free() {\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n}\n\nexport interface RectangleBatchRendererProps {\n  batch: RectangleBatch\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n}\n\nexport class RectangleBatchRenderer {\n  material: Graphics.Material\n  constructor(private gl: Graphics.Context) {\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: RectangleBatchRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToNDC',\n      (() => {\n        const configToPhysical = AffineTransform.betweenRects(\n          props.configSpaceSrcRect,\n          props.physicalSpaceDstRect,\n        )\n\n        const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n        const physicalToNDC = AffineTransform.withTranslation(new Vec2(-1, 1)).times(\n          AffineTransform.withScale(new Vec2(2, -2).dividedByPointwise(viewportSize)),\n        )\n\n        return physicalToNDC.times(configToPhysical)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLES, this.material, props.batch.getBuffer())\n  }\n}\n","import {clamp} from './math'\n\nexport class Color {\n  constructor(\n    readonly r: number = 0,\n    readonly g: number = 0,\n    readonly b: number = 0,\n    readonly a: number = 1,\n  ) {}\n\n  static fromLumaChromaHue(L: number, C: number, H: number) {\n    // 0 <= L <= 1\n    // 0 <= C <= 1\n    // 0 <= H <= 360\n    // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n\n    const hPrime = H / 60\n    const X = C * (1 - Math.abs((hPrime % 2) - 1))\n    const [R1, G1, B1] =\n      hPrime < 1\n        ? [C, X, 0]\n        : hPrime < 2\n          ? [X, C, 0]\n          : hPrime < 3\n            ? [0, C, X]\n            : hPrime < 4\n              ? [0, X, C]\n              : hPrime < 5\n                ? [X, 0, C]\n                : [C, 0, X]\n\n    const m = L - (0.3 * R1 + 0.59 * G1 + 0.11 * B1)\n\n    return new Color(clamp(R1 + m, 0, 1), clamp(G1 + m, 0, 1), clamp(B1 + m, 0, 1), 1.0)\n  }\n\n  static fromCSSHex(hex: string) {\n    if (hex.length !== 7 || hex[0] !== '#') {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    const r = parseInt(hex.substr(1, 2), 16) / 255\n    const g = parseInt(hex.substr(3, 2), 16) / 255\n    const b = parseInt(hex.substr(5, 2), 16) / 255\n    if (r < 0 || r > 1 || g < 0 || g > 1 || b < 0 || b > 1) {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    return new Color(r, g, b)\n  }\n\n  withAlpha(a: number): Color {\n    return new Color(this.r, this.g, this.b, a)\n  }\n\n  toCSS(): string {\n    return `rgba(${(255 * this.r).toFixed()}, ${(255 * this.g).toFixed()}, ${(\n      255 * this.b\n    ).toFixed()}, ${this.a.toFixed(2)})`\n  }\n}\n","import {LRUCache} from '../lib/lru-cache'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {TextureRenderer} from './texture-renderer'\nimport {renderInto} from './utils'\n\nexport class RowAtlas<K> {\n  private texture: Graphics.Texture\n  private renderTarget: Graphics.RenderTarget\n  private rowCache: LRUCache<K, number>\n  private clearLineBatch: RectangleBatch\n\n  constructor(\n    private gl: Graphics.Context,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private textureRenderer: TextureRenderer,\n  ) {\n    this.texture = gl.createTexture(Graphics.TextureFormat.NEAREST_CLAMP, 4096, 4096)\n    this.renderTarget = gl.createRenderTarget(this.texture)\n    this.rowCache = new LRUCache(this.texture.height)\n    this.clearLineBatch = new RectangleBatch(gl)\n    this.clearLineBatch.addRect(Rect.unit, new Color(0, 0, 0, 0))\n\n    // All of the cached data is stored GPU-side, and we don't retain a copy of\n    // it client-side. This means when we get a context loss event, the data is\n    // totally gone. So let's clear our CPU-side cache to reflect that fact.\n    gl.addContextResetHandler(() => {\n      this.rowCache.clear()\n    })\n  }\n\n  has(key: K) {\n    return this.rowCache.has(key)\n  }\n  getResolution() {\n    return this.texture.width\n  }\n  getCapacity() {\n    return this.texture.height\n  }\n\n  private allocateLine(key: K): number {\n    if (this.rowCache.getSize() < this.rowCache.getCapacity()) {\n      // Not in cache, but cache isn't full\n      const row = this.rowCache.getSize()\n      this.rowCache.insert(key, row)\n      return row\n    } else {\n      // Not in cache, and cache is full. Evict something.\n      const [, row] = this.rowCache.removeLRU()!\n      this.rowCache.insert(key, row)\n      return row\n    }\n  }\n\n  writeToAtlasIfNeeded(keys: K[], render: (textureDstRect: Rect, key: K) => void) {\n    renderInto(this.gl, this.renderTarget, () => {\n      for (let key of keys) {\n        let row = this.rowCache.get(key)\n        if (row != null) {\n          // Already cached!\n          continue\n        }\n        // Not cached -- we'll have to actually render\n        row = this.allocateLine(key)\n\n        const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n        this.rectangleBatchRenderer.render({\n          batch: this.clearLineBatch,\n          configSpaceSrcRect: Rect.unit,\n          physicalSpaceDstRect: textureRect,\n        })\n        render(textureRect, key)\n      }\n    })\n  }\n\n  renderViaAtlas(key: K, dstRect: Rect): boolean {\n    let row = this.rowCache.get(key)\n    if (row == null) {\n      return false\n    }\n\n    const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n\n    // At this point, we have the row in cache, and we can\n    // paint directly from it into the framebuffer.\n    this.textureRenderer.render({\n      texture: this.texture,\n      srcRect: textureRect,\n      dstRect: dstRect,\n    })\n    return true\n  }\n}\n","import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n\n  varying vec2 vUv;\n  uniform sampler2D texture;\n\n  void main() {\n   gl_FragColor = texture2D(texture, vUv);\n  }\n`\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class TextureRenderer {\n  private buffer: Graphics.VertexBuffer\n  private material: Graphics.Material\n\n  constructor(private gl: Graphics.Context) {\n    const vertexFormat = new Graphics.VertexFormat()\n    vertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n    vertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: TextureRendererProps) {\n    this.material.setUniformSampler('texture', props.texture, 0)\n    setUniformAffineTransform(\n      this.material,\n      'uvTransform',\n      (() => {\n        const {srcRect, texture} = props\n        const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n          .times(AffineTransform.withScale(new Vec2(1, -1)))\n          .times(\n            AffineTransform.betweenRects(\n              new Rect(Vec2.zero, new Vec2(texture.width, texture.height)),\n              Rect.unit,\n            ),\n          )\n        const uvRect = physicalToUV.transformRect(srcRect)\n        return AffineTransform.betweenRects(Rect.unit, uvRect)\n      })(),\n    )\n    setUniformAffineTransform(\n      this.material,\n      'positionTransform',\n      (() => {\n        const {dstRect} = props\n\n        const {viewport} = this.gl\n        const viewportSize = new Vec2(viewport.width, viewport.height)\n\n        const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n          AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n        )\n        const ndcRect = physicalToNDC.transformRect(dstRect)\n        return AffineTransform.betweenRects(Rect.NDC, ndcRect)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Color} from '../lib/color'\nimport {AffineTransform, Rect} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform, setUniformVec2} from './utils'\n\nexport interface ViewportRectangleRendererProps {\n  configSpaceToPhysicalViewSpace: AffineTransform\n  configSpaceViewportRect: Rect\n}\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  attribute vec2 position;\n\n  void main() {\n    gl_Position = vec4(position, 0, 1);\n  }\n`\n\nconst frag = (theme: Theme) => {\n  const {r, g, b} = Color.fromCSSHex(theme.fgSecondaryColor)\n  const rgb = `${r.toFixed(1)}, ${g.toFixed(1)}, ${b.toFixed(1)}`\n  return `\n    precision mediump float;\n\n    uniform mat3 configSpaceToPhysicalViewSpace;\n    uniform vec2 physicalSize;\n    uniform vec2 physicalOrigin;\n    uniform vec2 configSpaceViewportOrigin;\n    uniform vec2 configSpaceViewportSize;\n    uniform float framebufferHeight;\n\n    void main() {\n      vec2 origin = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportOrigin, 1.0)).xy;\n      vec2 size = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportSize, 0.0)).xy;\n\n      vec2 halfSize = physicalSize / 2.0;\n\n      float borderWidth = 2.0;\n\n      origin = floor(origin * halfSize) / halfSize + borderWidth * vec2(1.0, 1.0);\n      size = floor(size * halfSize) / halfSize - 2.0 * borderWidth * vec2(1.0, 1.0);\n\n      vec2 coord = gl_FragCoord.xy;\n      coord.x = coord.x - physicalOrigin.x;\n      coord.y = framebufferHeight - coord.y - physicalOrigin.y;\n      vec2 clamped = clamp(coord, origin, origin + size);\n      vec2 gap = clamped - coord;\n      float maxdist = max(abs(gap.x), abs(gap.y));\n\n      // TOOD(jlfwong): Could probably optimize this to use mix somehow.\n      if (maxdist == 0.0) {\n        // Inside viewport rectangle\n        gl_FragColor = vec4(0, 0, 0, 0);\n      } else if (maxdist < borderWidth) {\n        // Inside viewport rectangle at border\n        gl_FragColor = vec4(${rgb}, 0.8);\n      } else {\n        // Outside viewport rectangle\n        gl_FragColor = vec4(${rgb}, 0.5);\n      }\n    }\n  `\n}\n\nexport class ViewportRectangleRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(\n    private gl: Graphics.Context,\n    theme: Theme,\n  ) {\n    const vertices = [\n      [-1, 1],\n      [1, 1],\n      [-1, -1],\n      [1, -1],\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v[0])\n      floats.push(v[1])\n    }\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme))\n  }\n\n  render(props: ViewportRectangleRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToPhysicalViewSpace',\n      props.configSpaceToPhysicalViewSpace,\n    )\n\n    // TODO(jlfwong): Pack these into a Vec4 instead\n    setUniformVec2(this.material, 'configSpaceViewportOrigin', props.configSpaceViewportRect.origin)\n    setUniformVec2(this.material, 'configSpaceViewportSize', props.configSpaceViewportRect.size)\n    // TODO(jlfwong): Pack these into a Vec4 instead\n\n    const viewport = this.gl.viewport\n    this.material.setUniformVec2('physicalOrigin', viewport.x, viewport.y)\n    this.material.setUniformVec2('physicalSize', viewport.width, viewport.height)\n\n    this.material.setUniformFloat('framebufferHeight', this.gl.renderTargetHeightInPixels)\n\n    this.gl.setBlendState(\n      Graphics.BlendOperation.SOURCE_ALPHA,\n      Graphics.BlendOperation.INVERSE_SOURCE_ALPHA,\n    )\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = (colorForBucket: string) => `\n  precision mediump float;\n\n  uniform vec2 uvSpacePixelSize;\n  uniform float renderOutlines;\n\n  varying vec2 vUv;\n  uniform sampler2D colorTexture;\n\n  // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n  vec3 hcl2rgb(float H, float C, float L) {\n    float hPrime = H / 60.0;\n    float X = C * (1.0 - abs(mod(hPrime, 2.0) - 1.0));\n    vec3 RGB =\n      hPrime < 1.0 ? vec3(C, X, 0) :\n      hPrime < 2.0 ? vec3(X, C, 0) :\n      hPrime < 3.0 ? vec3(0, C, X) :\n      hPrime < 4.0 ? vec3(0, X, C) :\n      hPrime < 5.0 ? vec3(X, 0, C) :\n      vec3(C, 0, X);\n\n    float m = L - dot(RGB, vec3(0.30, 0.59, 0.11));\n    return RGB + vec3(m, m, m);\n  }\n\n  float triangle(float x) {\n    return 2.0 * abs(fract(x) - 0.5) - 1.0;\n  }\n\n  ${colorForBucket}\n\n  void main() {\n    vec4 here = texture2D(colorTexture, vUv);\n\n    if (here.z == 0.0) {\n      // Background color\n      gl_FragColor = vec4(0, 0, 0, 0);\n      return;\n    }\n\n    // Sample the 4 surrounding pixels in the depth texture to determine\n    // if we should draw a boundary here or not.\n    vec4 N = texture2D(colorTexture, vUv + vec2(0, uvSpacePixelSize.y));\n    vec4 E = texture2D(colorTexture, vUv + vec2(uvSpacePixelSize.x, 0));\n    vec4 S = texture2D(colorTexture, vUv + vec2(0, -uvSpacePixelSize.y));\n    vec4 W = texture2D(colorTexture, vUv + vec2(-uvSpacePixelSize.x, 0));\n\n    // NOTE: For outline checks, we intentionally check both the right\n    // and the left to determine if we're an edge. If a rectangle is a single\n    // pixel wide, we don't want to render it as an outline, so this method\n    // of checking ensures that we don't outline single physical-space\n    // pixel width rectangles.\n    if (\n      renderOutlines > 0.0 &&\n      (\n        here.y == N.y && here.y != S.y || // Top edge\n        here.y == S.y && here.y != N.y || // Bottom edge\n        here.x == E.x && here.x != W.x || // Left edge\n        here.x == W.x && here.x != E.x\n      )\n    ) {\n      // We're on an edge! Draw transparent.\n      gl_FragColor = vec4(0, 0, 0, 0);\n    } else {\n      // Not on an edge. Draw the appropriate color.\n      gl_FragColor = vec4(colorForBucket(here.z), here.a);\n    }\n  }\n`\n\nexport interface FlamechartColorPassRenderProps {\n  rectInfoTexture: Graphics.Texture\n  renderOutlines: boolean\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class FlamechartColorPassRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(\n    private gl: Graphics.Context,\n    theme: Theme,\n  ) {\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.uploadFloats(floats)\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme.colorForBucketGLSL))\n  }\n\n  render(props: FlamechartColorPassRenderProps) {\n    const {srcRect, rectInfoTexture} = props\n    const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n      .times(AffineTransform.withScale(new Vec2(1, -1)))\n      .times(\n        AffineTransform.betweenRects(\n          new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n          Rect.unit,\n        ),\n      )\n    const uvRect = physicalToUV.transformRect(srcRect)\n    const uvTransform = AffineTransform.betweenRects(Rect.unit, uvRect)\n\n    const {dstRect} = props\n    const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n    const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n      AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n    )\n    const ndcRect = physicalToNDC.transformRect(dstRect)\n    const positionTransform = AffineTransform.betweenRects(Rect.NDC, ndcRect)\n\n    const uvSpacePixelSize = Vec2.unit.dividedByPointwise(\n      new Vec2(props.rectInfoTexture.width, props.rectInfoTexture.height),\n    )\n\n    this.material.setUniformSampler('colorTexture', props.rectInfoTexture, 0)\n    setUniformAffineTransform(this.material, 'uvTransform', uvTransform)\n    this.material.setUniformFloat('renderOutlines', props.renderOutlines ? 1.0 : 0.0)\n    this.material.setUniformVec2('uvSpacePixelSize', uvSpacePixelSize.x, uvSpacePixelSize.y)\n    setUniformAffineTransform(this.material, 'positionTransform', positionTransform)\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n","import {Graphics, WebGL} from './graphics'\nimport {RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {TextureRenderer} from './texture-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {ViewportRectangleRenderer} from './overlay-rectangle-renderer'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {Color} from '../lib/color'\nimport {Theme} from '../views/themes/theme'\n\ntype FrameCallback = () => void\n\nexport class CanvasContext {\n  public readonly gl: WebGL.Context\n  public readonly rectangleBatchRenderer: RectangleBatchRenderer\n  public readonly textureRenderer: TextureRenderer\n  public readonly viewportRectangleRenderer: ViewportRectangleRenderer\n  public readonly flamechartColorPassRenderer: FlamechartColorPassRenderer\n  public readonly theme: Theme\n\n  constructor(canvas: HTMLCanvasElement, theme: Theme) {\n    this.gl = new WebGL.Context(canvas)\n    this.rectangleBatchRenderer = new RectangleBatchRenderer(this.gl)\n    this.textureRenderer = new TextureRenderer(this.gl)\n    this.viewportRectangleRenderer = new ViewportRectangleRenderer(this.gl, theme)\n    this.flamechartColorPassRenderer = new FlamechartColorPassRenderer(this.gl, theme)\n    this.theme = theme\n\n    // Whenever the canvas is resized, draw immediately. This prevents\n    // flickering during resizing.\n    this.gl.addAfterResizeEventHandler(this.onBeforeFrame)\n\n    const webGLInfo = this.gl.getWebGLInfo()\n    if (webGLInfo) {\n      console.log(\n        `WebGL initialized. renderer: ${webGLInfo.renderer}, vendor: ${webGLInfo.vendor}, version: ${webGLInfo.version}`,\n      )\n    }\n    ;(window as any)['testContextLoss'] = () => {\n      this.gl.testContextLoss()\n    }\n  }\n\n  private animationFrameRequest: number | null = null\n  private beforeFrameHandlers = new Set<FrameCallback>()\n  addBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.add(callback)\n  }\n  removeBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.delete(callback)\n  }\n  requestFrame() {\n    if (!this.animationFrameRequest) {\n      this.animationFrameRequest = requestAnimationFrame(this.onBeforeFrame)\n    }\n  }\n  private onBeforeFrame = () => {\n    this.animationFrameRequest = null\n    this.gl.setViewport(0, 0, this.gl.renderTargetWidthInPixels, this.gl.renderTargetHeightInPixels)\n    const color = Color.fromCSSHex(this.theme.bgPrimaryColor)\n    this.gl.clear(new Graphics.Color(color.r, color.g, color.b, color.a))\n\n    for (const handler of this.beforeFrameHandlers) {\n      handler()\n    }\n  }\n\n  setViewport(physicalBounds: Rect, cb: () => void): void {\n    const {origin, size} = physicalBounds\n    let viewportBefore = this.gl.viewport\n    this.gl.setViewport(origin.x, origin.y, size.x, size.y)\n\n    cb()\n\n    let {x, y, width, height} = viewportBefore\n    this.gl.setViewport(x, y, width, height)\n  }\n\n  renderBehind(el: Element, cb: () => void) {\n    const bounds = el.getBoundingClientRect()\n    const physicalBounds = new Rect(\n      new Vec2(bounds.left * window.devicePixelRatio, bounds.top * window.devicePixelRatio),\n      new Vec2(bounds.width * window.devicePixelRatio, bounds.height * window.devicePixelRatio),\n    )\n\n    this.setViewport(physicalBounds, cb)\n  }\n}\n","import {Frame, Profile} from '../lib/profile'\nimport {memoizeByReference, memoizeByShallowEquality} from '../lib/utils'\nimport {RowAtlas} from '../gl/row-atlas'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRowAtlasKey} from '../gl/flamechart-renderer'\nimport {Theme} from '../views/themes/theme'\n\nexport const createGetColorBucketForFrame = memoizeByReference(\n  (frameToColorBucket: Map<number | string, number>) => {\n    return (frame: Frame): number => {\n      return frameToColorBucket.get(frame.key) || 0\n    }\n  },\n)\n\nexport const createGetCSSColorForFrame = memoizeByShallowEquality(\n  ({\n    theme,\n    frameToColorBucket,\n  }: {\n    theme: Theme\n    frameToColorBucket: Map<number | string, number>\n  }) => {\n    const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n    return (frame: Frame): string => {\n      const t = getColorBucketForFrame(frame) / 255\n      return theme.colorForBucket(t).toCSS()\n    }\n  },\n)\n\nexport const getCanvasContext = memoizeByShallowEquality(\n  ({theme, canvas}: {theme: Theme; canvas: HTMLCanvasElement}) => {\n    return new CanvasContext(canvas, theme)\n  },\n)\n\nexport const getRowAtlas = memoizeByReference((canvasContext: CanvasContext) => {\n  return new RowAtlas<FlamechartRowAtlasKey>(\n    canvasContext.gl,\n    canvasContext.rectangleBatchRenderer,\n    canvasContext.textureRenderer,\n  )\n})\n\nexport const getProfileToView = memoizeByShallowEquality(\n  ({profile, flattenRecursion}: {profile: Profile; flattenRecursion: boolean}): Profile => {\n    return flattenRecursion ? profile.getProfileWithRecursionFlattened() : profile\n  },\n)\n\nexport const getFrameToColorBucket = memoizeByReference(\n  (profile: Profile): Map<string | number, number> => {\n    const frames: Frame[] = []\n    profile.forEachFrame(f => frames.push(f))\n    function key(f: Frame) {\n      return (f.file || '') + f.name\n    }\n    function compare(a: Frame, b: Frame) {\n      return key(a) > key(b) ? 1 : -1\n    }\n    frames.sort(compare)\n    const frameToColorBucket = new Map<string | number, number>()\n    for (let i = 0; i < frames.length; i++) {\n      frameToColorBucket.set(frames[i].key, Math.floor((255 * i) / frames.length))\n    }\n\n    return frameToColorBucket\n  },\n)\n","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tif (currentComponent.__hooks) {\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\tcurrentComponent.__hooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\tif (hooks._pendingEffects.length) {\n\t\t\tafterPaint(afterPaintEffects.push(c));\n\t\t}\n\t}\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\ttry {\n\t\t\thooks._list.forEach(hook => hook._cleanup && hook._cleanup());\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {import('./internal').HookState}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} initialState\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\tif (!hookState._component) {\n\t\thookState._component = currentComponent;\n\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value[0] = nextValue;\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t\treturn (state._value = factory());\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\nexport function useErrorBoundary(cb) {\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.some(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tcancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (typeof window != 'undefined') {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\tif (hook._cleanup) hook._cleanup();\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\tconst result = hook._value();\n\tif (typeof result == 'function') hook._cleanup = result;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn !oldArgs || newArgs.some((arg, index) => arg !== oldArgs[index]);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","import { Component } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Component class with a predefined `shouldComponentUpdate` implementation\n */\nexport class PureComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// Some third-party libraries check if this property is present\n\t\tthis.isPureReactComponent = true;\n\t}\n\n\tshouldComponentUpdate(props, state) {\n\t\treturn (\n\t\t\tshallowDiffers(this.props, props) || shallowDiffers(this.state, state)\n\t\t);\n\t}\n}\n","import { createElement } from 'preact';\nimport { shallowDiffers, assign } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionalComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, assign({}, props));\n\t}\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","import { options } from 'preact';\nimport { assign } from './util';\n\nlet oldDiffHook = options._diff;\noptions._diff = vnode => {\n\tif (vnode.type && vnode.type._forwarded && vnode.ref) {\n\t\tvnode.props.ref = vnode.ref;\n\t\tvnode.ref = null;\n\t}\n\tif (oldDiffHook) oldDiffHook(vnode);\n};\n\n/**\n * Pass ref down to a child. This is mainly used in libraries with HOCs that\n * wrap components. Using `forwardRef` there is an easy way to get a reference\n * of the wrapped component instead of one of the wrapper itself.\n * @param {import('./index').ForwardFn} fn\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function forwardRef(fn) {\n\tfunction Forwarded(props) {\n\t\tlet clone = assign({}, props);\n\t\tdelete clone.ref;\n\t\treturn fn(clone, props.ref);\n\t}\n\tForwarded.prototype.isReactComponent = Forwarded._forwarded = true;\n\tForwarded.displayName = 'ForwardRef(' + (fn.displayName || fn.name) + ')';\n\treturn Forwarded;\n}\n","import { toChildArray } from 'preact';\n\nconst mapFn = (children, fn) => {\n\tif (!children) return null;\n\treturn toChildArray(children).reduce(\n\t\t(acc, value, index) => acc.concat(fn(value, index)),\n\t\t[]\n\t);\n};\n\n// This API is completely unnecessary for Preact, so it's basically passthrough.\nexport const Children = {\n\tmap: mapFn,\n\tforEach: mapFn,\n\tcount(children) {\n\t\treturn children ? toChildArray(children).length : 0;\n\t},\n\tonly(children) {\n\t\tchildren = toChildArray(children);\n\t\tif (children.length !== 1) {\n\t\t\tthrow new Error('Children.only() expects only one child.');\n\t\t}\n\t\treturn children[0];\n\t},\n\ttoArray: toChildArray\n};\n","import { Component, createElement, options } from 'preact';\nimport { assign } from './util';\n\nconst oldCatchError = options._catchError;\noptions._catchError = function(error, newVNode, oldVNode) {\n\tif (error.then) {\n\t\t/** @type {import('./internal').Component} */\n\t\tlet component;\n\t\tlet vnode = newVNode;\n\n\t\tfor (; (vnode = vnode._parent); ) {\n\t\t\tif ((component = vnode._component) && component._childDidSuspend) {\n\t\t\t\t// Don't call oldCatchError if we found a Suspense\n\t\t\t\treturn component._childDidSuspend(error, newVNode._component);\n\t\t\t}\n\t\t}\n\t}\n\toldCatchError(error, newVNode, oldVNode);\n};\n\nfunction detachedClone(vnode) {\n\tif (vnode) {\n\t\tvnode = assign({}, vnode);\n\t\tvnode._component = null;\n\t\tvnode._children = vnode._children && vnode._children.map(detachedClone);\n\t}\n\treturn vnode;\n}\n\n// having custom inheritance instead of a class here saves a lot of bytes\nexport function Suspense() {\n\t// we do not call super here to golf some bytes...\n\tthis._pendingSuspensionCount = 0;\n\tthis._suspenders = null;\n\tthis._detachOnNextRender = null;\n}\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspense.prototype = new Component();\n\n/**\n * @param {Promise} promise The thrown promise\n * @param {Component<any, any>} suspendingComponent The suspending component\n */\nSuspense.prototype._childDidSuspend = function(promise, suspendingComponent) {\n\t/** @type {import('./internal').SuspenseComponent} */\n\tconst c = this;\n\n\tif (c._suspenders == null) {\n\t\tc._suspenders = [];\n\t}\n\tc._suspenders.push(suspendingComponent);\n\n\tconst resolve = suspended(c._vnode);\n\n\tlet resolved = false;\n\tconst onResolved = () => {\n\t\tif (resolved) return;\n\n\t\tresolved = true;\n\n\t\tif (resolve) {\n\t\t\tresolve(onSuspensionComplete);\n\t\t} else {\n\t\t\tonSuspensionComplete();\n\t\t}\n\t};\n\n\tsuspendingComponent._suspendedComponentWillUnmount =\n\t\tsuspendingComponent.componentWillUnmount;\n\tsuspendingComponent.componentWillUnmount = () => {\n\t\tonResolved();\n\n\t\tif (suspendingComponent._suspendedComponentWillUnmount) {\n\t\t\tsuspendingComponent._suspendedComponentWillUnmount();\n\t\t}\n\t};\n\n\tconst onSuspensionComplete = () => {\n\t\tif (!--c._pendingSuspensionCount) {\n\t\t\tc._vnode._children[0] = c.state._suspended;\n\t\t\tc.setState({ _suspended: (c._detachOnNextRender = null) });\n\n\t\t\tlet suspended;\n\t\t\twhile ((suspended = c._suspenders.pop())) {\n\t\t\t\tsuspended.forceUpdate();\n\t\t\t}\n\t\t}\n\t};\n\n\tif (!c._pendingSuspensionCount++) {\n\t\tc.setState({ _suspended: (c._detachOnNextRender = c._vnode._children[0]) });\n\t}\n\tpromise.then(onResolved, onResolved);\n};\n\nSuspense.prototype.render = function(props, state) {\n\tif (this._detachOnNextRender) {\n\t\tthis._vnode._children[0] = detachedClone(this._detachOnNextRender);\n\t\tthis._detachOnNextRender = null;\n\t}\n\n\treturn [\n\t\tcreateElement(Component, null, state._suspended ? null : props.children),\n\t\tstate._suspended && props.fallback\n\t];\n};\n\n/**\n * Checks and calls the parent component's _suspended method, passing in the\n * suspended vnode. This is a way for a parent (e.g. SuspenseList) to get notified\n * that one of its children/descendants suspended.\n *\n * The parent MAY return a callback. The callback will get called when the\n * suspension resolves, notifying the parent of the fact.\n * Moreover, the callback gets function `unsuspend` as a parameter. The resolved\n * child descendant will not actually get unsuspended until `unsuspend` gets called.\n * This is a way for the parent to delay unsuspending.\n *\n * If the parent does not return a callback then the resolved vnode\n * gets unsuspended immediately when it resolves.\n *\n * @param {import('../src/internal').VNode} vnode\n * @returns {((unsuspend: () => void) => void)?}\n */\nexport function suspended(vnode) {\n\tlet component = vnode._parent._component;\n\treturn component && component._suspended && component._suspended(vnode);\n}\n\nexport function lazy(loader) {\n\tlet prom;\n\tlet component;\n\tlet error;\n\n\tfunction Lazy(props) {\n\t\tif (!prom) {\n\t\t\tprom = loader();\n\t\t\tprom.then(\n\t\t\t\texports => {\n\t\t\t\t\tcomponent = exports.default || exports;\n\t\t\t\t},\n\t\t\t\te => {\n\t\t\t\t\terror = e;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\n\t\tif (!component) {\n\t\t\tthrow prom;\n\t\t}\n\n\t\treturn createElement(component, props);\n\t}\n\n\tLazy.displayName = 'Lazy';\n\tLazy._forwarded = true;\n\treturn Lazy;\n}\n","import { Component, toChildArray } from 'preact';\nimport { suspended } from './suspense.js';\n\n// Indexes to linked list nodes (nodes are stored as arrays to save bytes).\nconst SUSPENDED_COUNT = 0;\nconst RESOLVED_COUNT = 1;\nconst NEXT_NODE = 2;\n\n// Having custom inheritance instead of a class here saves a lot of bytes.\nexport function SuspenseList() {\n\tthis._next = null;\n\tthis._map = null;\n}\n\n// Mark one of child's earlier suspensions as resolved.\n// Some pending callbacks may become callable due to this\n// (e.g. the last suspended descendant gets resolved when\n// revealOrder === 'together'). Process those callbacks as well.\nconst resolve = (list, child, node) => {\n\tif (++node[RESOLVED_COUNT] === node[SUSPENDED_COUNT]) {\n\t\t// The number a child (or any of its descendants) has been suspended\n\t\t// matches the number of times it's been resolved. Therefore we\n\t\t// mark the child as completely resolved by deleting it from ._map.\n\t\t// This is used to figure out when *all* children have been completely\n\t\t// resolved when revealOrder is 'together'.\n\t\tlist._map.delete(child);\n\t}\n\n\t// If revealOrder is falsy then we can do an early exit, as the\n\t// callbacks won't get queued in the node anyway.\n\t// If revealOrder is 'together' then also do an early exit\n\t// if all suspended descendants have not yet been resolved.\n\tif (\n\t\t!list.props.revealOrder ||\n\t\t(list.props.revealOrder[0] === 't' && list._map.size)\n\t) {\n\t\treturn;\n\t}\n\n\t// Walk the currently suspended children in order, calling their\n\t// stored callbacks on the way. Stop if we encounter a child that\n\t// has not been completely resolved yet.\n\tnode = list._next;\n\twhile (node) {\n\t\twhile (node.length > 3) {\n\t\t\tnode.pop()();\n\t\t}\n\t\tif (node[RESOLVED_COUNT] < node[SUSPENDED_COUNT]) {\n\t\t\tbreak;\n\t\t}\n\t\tlist._next = node = node[NEXT_NODE];\n\t}\n};\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspenseList.prototype = new Component();\n\nSuspenseList.prototype._suspended = function(child) {\n\tconst list = this;\n\tconst delegated = suspended(list._vnode);\n\n\tlet node = list._map.get(child);\n\tnode[SUSPENDED_COUNT]++;\n\n\treturn unsuspend => {\n\t\tconst wrappedUnsuspend = () => {\n\t\t\tif (!list.props.revealOrder) {\n\t\t\t\t// Special case the undefined (falsy) revealOrder, as there\n\t\t\t\t// is no need to coordinate a specific order or unsuspends.\n\t\t\t\tunsuspend();\n\t\t\t} else {\n\t\t\t\tnode.push(unsuspend);\n\t\t\t\tresolve(list, child, node);\n\t\t\t}\n\t\t};\n\t\tif (delegated) {\n\t\t\tdelegated(wrappedUnsuspend);\n\t\t} else {\n\t\t\twrappedUnsuspend();\n\t\t}\n\t};\n};\n\nSuspenseList.prototype.render = function(props) {\n\tthis._next = null;\n\tthis._map = new Map();\n\n\tconst children = toChildArray(props.children);\n\tif (props.revealOrder && props.revealOrder[0] === 'b') {\n\t\t// If order === 'backwards' (or, well, anything starting with a 'b')\n\t\t// then flip the child list around so that the last child will be\n\t\t// the first in the linked list.\n\t\tchildren.reverse();\n\t}\n\t// Build the linked list. Iterate through the children in reverse order\n\t// so that `_next` points to the first linked list node to be resolved.\n\tfor (let i = children.length; i--; ) {\n\t\t// Create a new linked list node as an array of form:\n\t\t// \t[suspended_count, resolved_count, next_node]\n\t\t// where suspended_count and resolved_count are numeric counters for\n\t\t// keeping track how many times a node has been suspended and resolved.\n\t\t//\n\t\t// Note that suspended_count starts from 1 instead of 0, so we can block\n\t\t// processing callbacks until componentDidMount has been called. In a sense\n\t\t// node is suspended at least until componentDidMount gets called!\n\t\t//\n\t\t// Pending callbacks are added to the end of the node:\n\t\t// \t[suspended_count, resolved_count, next_node, callback_0, callback_1, ...]\n\t\tthis._map.set(children[i], (this._next = [1, 0, this._next]));\n\t}\n\treturn props.children;\n};\n\nSuspenseList.prototype.componentDidUpdate = SuspenseList.prototype.componentDidMount = function() {\n\t// Iterate through all children after mounting for two reasons:\n\t// 1. As each node[SUSPENDED_COUNT] starts from 1, this iteration increases\n\t//    each node[RELEASED_COUNT] by 1, therefore balancing the counters.\n\t//    The nodes can now be completely consumed from the linked list.\n\t// 2. Handle nodes that might have gotten resolved between render and\n\t//    componentDidMount.\n\tconst list = this;\n\tlist._map.forEach((node, child) => {\n\t\tresolve(list, child, node);\n\t});\n};\n","import { createElement, hydrate, render, _unmount } from 'preact';\n\nclass ContextProvider {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender(props) {\n\t\treturn props.children;\n\t}\n}\n\n/**\n * Portal component\n * @param {object | null | undefined} props\n */\nfunction Portal(props) {\n\tlet _this = this;\n\tlet container = props.container;\n\tlet wrap = createElement(\n\t\tContextProvider,\n\t\t{ context: _this.context },\n\t\tprops.vnode\n\t);\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t\t_this._hasMounted = false;\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props.vnode) {\n\t\tif (!_this._hasMounted) {\n\t\t\t// Create a placeholder that we can use to insert into.\n\t\t\t_this._temp = document.createTextNode('');\n\t\t\t// Hydrate existing nodes to keep the dom intact, when rendering\n\t\t\t// wrap into the container.\n\t\t\thydrate('', container);\n\t\t\t// Append to the container (this matches React's behavior)\n\t\t\tcontainer.appendChild(_this._temp);\n\t\t\t// At this point we have mounted and should set our container.\n\t\t\t_this._hasMounted = true;\n\t\t\t_this._container = container;\n\t\t\t// Render our wrapping element into temp.\n\t\t\trender(wrap, container, _this._temp);\n\t\t\t_this._children = _this._temp._children;\n\t\t} else {\n\t\t\t// When we have mounted and the vnode is present it means the\n\t\t\t// props have changed or a parent is triggering a rerender.\n\t\t\t// This implies we only need to call render. But we need to keep\n\t\t\t// the old tree around, otherwise will treat the vnodes as new and\n\t\t\t// will wrongly call `componentDidMount` on them\n\t\t\tcontainer._children = _this._children;\n\t\t\trender(wrap, container);\n\t\t\t_this._children = container._children;\n\t\t}\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._hasMounted) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t}\n\t// Set the wrapping element for future unmounting.\n\t_this._wrap = wrap;\n\n\t_this.componentWillUnmount = () => {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t};\n\n\treturn null;\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { vnode, container });\n}\n","/**\n * Normalize event handlers like react does. Most famously it uses `onChange` for any input element.\n * @param {import('./internal').VNode} vnode The vnode to normalize events on\n */\nexport function applyEventNormalization({ type, props }) {\n\tif (!props || typeof type != 'string') return;\n\tlet newProps = {};\n\n\tfor (let i in props) {\n\t\tif (/^on(Ani|Tra|Tou)/.test(i)) {\n\t\t\tprops[i.toLowerCase()] = props[i];\n\t\t\tdelete props[i];\n\t\t}\n\t\tnewProps[i.toLowerCase()] = i;\n\t}\n\tif (newProps.ondoubleclick) {\n\t\tprops.ondblclick = props[newProps.ondoubleclick];\n\t\tdelete props[newProps.ondoubleclick];\n\t}\n\tif (newProps.onbeforeinput) {\n\t\tprops.onbeforeinput = props[newProps.onbeforeinput];\n\t\tdelete props[newProps.onbeforeinput];\n\t}\n\t// for *textual inputs* (incl textarea), normalize `onChange` -> `onInput`:\n\tif (\n\t\tnewProps.onchange &&\n\t\t(type === 'textarea' ||\n\t\t\t(type.toLowerCase() === 'input' && !/^fil|che|ra/i.test(props.type)))\n\t) {\n\t\tlet normalized = newProps.oninput || 'oninput';\n\t\tif (!props[normalized]) {\n\t\t\tprops[normalized] = props[newProps.onchange];\n\t\t\tdelete props[newProps.onchange];\n\t\t}\n\t}\n}\n","// This is a very small application state management library.\n//\n// All it provides is a way of specifying state \"atoms\" (basically a value with\n// a setter and a way to be notified when the value updates), and a single\n// preact hook to manage the subscribe/unsubscribe process for you.\n//\n// At the moment, atoms are intended to be globally defined, but the system\n// could easily be adapted to pass down the atoms via context rather than being\n// globally available.\n//\n// To support complex data-types, you can either have simple functions that call\n// the public setter, or subclass Atom. So, for example, here are a few\n// different ways of making a list atom with convenient helpers:\n//\n// # Simple functions being passed atom\n//\n//     const myListAtom = new Atom<number[]>([], \"myList\")\n//     function push<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get(), t]\n//       atom.set(next)\n//     }\n//     function removeLast<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get()]\n//       next.pop()\n//       atom.set(next)\n//     }\n//\n//\n// # Simple functions operating on global atoms\n//\n//     const myListAtom = new Atom<number[]>([], \"myLisT\")\n//     function push(t: number) {\n//       myListAtom.set([...myListAtom.get(), t])\n//     }\n//     function removeLast() {\n//       const next = [...myListAtom.get()]\n//       myListAtom.set(next)\n//     }\n//\n//\n// # Subclassing\n//\n//     class ListAtom<T> extends Atom<T[]> {\n//        push(t: T) {\n//          const next = [...this.state, t]\n//          this.set(next)\n//        }\n//        removeLast() {\n//          const next = [...this.state]\n//          next.pop()\n//          this.set(next)\n//        }\n//     }\n//     const myListAtom = new ListAtom<number>([], \"myList\")\n//\n// This library is inspired by https://recoiljs.org/\n\nimport {useLayoutEffect, useState} from 'preact/hooks'\n\ntype AtomListener = () => void\n\nlet AtomDev: {[key: string]: Atom<any>} | null = null\nlet hotReloadStash: Map<string, any> | null = null\n\ndeclare const module: any\nif (process.env.NODE_ENV === 'development') {\n  ;(window as any)['Atom'] = AtomDev = {}\n\n  module.hot.dispose(() => {\n    if (AtomDev) {\n      hotReloadStash = new Map()\n      for (let key in AtomDev) {\n        hotReloadStash.set(key, AtomDev[key].get())\n      }\n    }\n\n    ;(window as any)['Atom_hotReloadStash'] = hotReloadStash\n  })\n\n  hotReloadStash = (window as any)['Atom_hotReloadStash'] || null\n}\n\nexport class Atom<T> {\n  private observers: AtomListener[] = []\n  constructor(\n    protected state: T,\n    debugKey: string,\n  ) {\n    if (process.env.NODE_ENV === 'development') {\n      if (hotReloadStash?.has(debugKey)) {\n        // If we have a stored value from a previous hot reload, use that\n        // instead of whatever was passed to the constructor.\n        this.state = hotReloadStash.get(debugKey)\n      }\n\n      if (AtomDev) {\n        if (debugKey in AtomDev) {\n          console.warn(`[Atom] Multiple atoms tried to register with the key ${debugKey}`)\n        }\n        AtomDev[debugKey] = this\n      }\n    }\n\n    // We do the bind here rather than in the definition to facilitate\n    // inheritance (we want the value defined on both the prototype and the\n    // instance).\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n  }\n\n  set(t: T) {\n    if (this.state === t) {\n      // No-op if the value didn't actually change\n      return\n    }\n    this.state = t\n    this.observers.forEach(fn => fn())\n  }\n\n  get(): T {\n    return this.state\n  }\n\n  subscribe(listener: AtomListener) {\n    this.observers.push(listener)\n  }\n\n  unsubscribe(listener: AtomListener) {\n    const index = this.observers.indexOf(listener)\n    if (index !== -1) {\n      this.observers.splice(index, 1)\n    }\n  }\n}\n\nexport function useAtom<T>(atom: Atom<T>): T {\n  const [value, setValue] = useState(atom.get())\n\n  useLayoutEffect(() => {\n    // We need to setValue here because it's possible something has changed the\n    // value in the store between the atom.get() call above and layout. In most\n    // cases this should no-op.\n    setValue(atom.get())\n\n    function listener() {\n      setValue(atom.get())\n    }\n\n    atom.subscribe(listener)\n    return () => {\n      atom.unsubscribe(listener)\n    }\n  }, [atom])\n\n  return value\n}\n","export const enum ViewMode {\n  CHRONO_FLAME_CHART,\n  LEFT_HEAVY_FLAME_GRAPH,\n  SANDWICH_VIEW,\n  COMPARE_VIEW,\n}\n","import {ViewMode} from '../lib/view-mode'\n\nexport interface HashParams {\n  profileURL?: string\n  title?: string\n  localProfilePath?: string\n  viewMode?: ViewMode\n}\n\nfunction getViewMode(value: string): ViewMode | null {\n  switch (value) {\n    case 'time-ordered':\n      return ViewMode.CHRONO_FLAME_CHART\n    case 'left-heavy':\n      return ViewMode.LEFT_HEAVY_FLAME_GRAPH\n    case 'sandwich':\n      return ViewMode.SANDWICH_VIEW\n    default:\n      return null\n  }\n}\n\nexport function getHashParams(hashContents = window.location.hash): HashParams {\n  try {\n    if (!hashContents.startsWith('#')) {\n      return {}\n    }\n    const components = hashContents.substr(1).split('&')\n    const result: HashParams = {}\n    for (const component of components) {\n      let [key, value] = component.split('=')\n      value = decodeURIComponent(value)\n      if (key === 'profileURL') {\n        result.profileURL = value\n      } else if (key === 'title') {\n        result.title = value\n      } else if (key === 'localProfilePath') {\n        result.localProfilePath = value\n      } else if (key === 'view') {\n        const mode = getViewMode(value)\n        if (mode !== null) {\n          result.viewMode = mode\n        } else {\n          console.error(`Ignoring invalid view specifier: ${value}`)\n        }\n      }\n    }\n    return result\n  } catch (e) {\n    console.error(`Error when loading hash fragment.`)\n    console.error(e)\n    return {}\n  }\n}\n","import {Atom} from '../lib/atom'\nimport {clamp, Rect, Vec2} from '../lib/math'\nimport {CallTreeNode, Frame, Profile, ProfileGroup} from '../lib/profile'\nimport {objectsHaveShallowEquality} from '../lib/utils'\n\nexport interface FlamechartViewState {\n  hover: {\n    node: CallTreeNode\n    event: MouseEvent\n  } | null\n  selectedNode: CallTreeNode | null\n  logicalSpaceViewportSize: Vec2\n  configSpaceViewportRect: Rect\n}\n\nexport interface CallerCalleeState {\n  selectedFrame: Frame\n  invertedCallerFlamegraph: FlamechartViewState\n  calleeFlamegraph: FlamechartViewState\n}\n\nexport interface SandwichViewState {\n  callerCallee: CallerCalleeState | null\n}\n\nexport interface ProfileState {\n  profile: Profile\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport type ProfileGroupState = {\n  name: string\n\n  // The index within the list of profiles currently being viewed\n  indexToView: number\n\n  profiles: ProfileState[]\n} | null\n\nexport enum FlamechartID {\n  LEFT_HEAVY = 'LEFT_HEAVY',\n  CHRONO = 'CHRONO',\n  SANDWICH_INVERTED_CALLERS = 'SANDWICH_INVERTED_CALLERS',\n  SANDWICH_CALLEES = 'SANDWICH_CALLEES',\n}\n\nlet initialFlameChartViewState: FlamechartViewState = {\n  hover: null,\n  selectedNode: null,\n  configSpaceViewportRect: Rect.empty,\n  logicalSpaceViewportSize: Vec2.zero,\n}\n\nexport class ProfileGroupAtom extends Atom<ProfileGroupState> {\n  set(newState: ProfileGroupState) {\n    const oldState = this.state\n    if (oldState != null && newState != null && objectsHaveShallowEquality(oldState, newState)) {\n      return\n    }\n    super.set(newState)\n  }\n\n  getActiveProfile(): ProfileState | null {\n    if (this.state == null) return null\n    return this.state.profiles[this.state?.indexToView] || null\n  }\n\n  setProfileGroup = (group: ProfileGroup) => {\n    this.set({\n      name: group.name,\n      indexToView: group.indexToView,\n      profiles: group.profiles.map(p => ({\n        profile: p,\n        chronoViewState: initialFlameChartViewState,\n        leftHeavyViewState: initialFlameChartViewState,\n        sandwichViewState: {callerCallee: null},\n      })),\n    })\n  }\n\n  setProfileIndexToView = (indexToView: number) => {\n    if (this.state == null) return\n\n    indexToView = clamp(indexToView, 0, this.state.profiles.length - 1)\n\n    this.set({\n      ...this.state,\n      indexToView,\n    })\n  }\n\n  private updateActiveProfileState(fn: (profileState: ProfileState) => ProfileState) {\n    if (this.state == null) return\n    const {indexToView, profiles} = this.state\n    this.set({\n      ...this.state,\n      profiles: profiles.map((p, i) => {\n        if (i != indexToView) return p\n        return fn(p)\n      }),\n    })\n  }\n\n  private updateActiveSandwichViewState(\n    fn: (sandwichViewState: SandwichViewState) => SandwichViewState,\n  ) {\n    this.updateActiveProfileState(p => ({\n      ...p,\n      sandwichViewState: fn(p.sandwichViewState),\n    }))\n  }\n\n  setSelectedFrame = (frame: Frame | null) => {\n    if (this.state == null) return\n\n    const profile = this.getActiveProfile()\n    if (profile == null) {\n      return\n    }\n\n    this.updateActiveSandwichViewState(sandwichViewState => {\n      if (frame == null) {\n        return {callerCallee: null}\n      }\n      return {\n        callerCallee: {\n          invertedCallerFlamegraph: initialFlameChartViewState,\n          calleeFlamegraph: initialFlameChartViewState,\n          selectedFrame: frame,\n        },\n      }\n    })\n  }\n\n  private updateFlamechartState(\n    id: FlamechartID,\n    fn: (flamechartViewState: FlamechartViewState) => FlamechartViewState,\n  ) {\n    switch (id) {\n      case FlamechartID.CHRONO: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          chronoViewState: fn(p.chronoViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.LEFT_HEAVY: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          leftHeavyViewState: fn(p.leftHeavyViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_CALLEES: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  calleeFlamegraph: fn(s.callerCallee.calleeFlamegraph),\n                },\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_INVERTED_CALLERS: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  invertedCallerFlamegraph: fn(s.callerCallee.invertedCallerFlamegraph),\n                },\n        }))\n        break\n      }\n    }\n  }\n\n  setFlamechartHoveredNode(\n    id: FlamechartID,\n    hover: {node: CallTreeNode; event: MouseEvent} | null,\n  ) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      hover,\n    }))\n  }\n\n  setSelectedNode(id: FlamechartID, selectedNode: CallTreeNode | null) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      selectedNode,\n    }))\n  }\n\n  setConfigSpaceViewportRect(id: FlamechartID, configSpaceViewportRect: Rect) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      configSpaceViewportRect,\n    }))\n  }\n\n  setLogicalSpaceViewportSize(id: FlamechartID, logicalSpaceViewportSize: Vec2) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      logicalSpaceViewportSize,\n    }))\n  }\n\n  clearHoverNode() {\n    // TODO(jlfwong): This causes 4 separate observer events. This is probably\n    // fine, since I hope that Preact/React are smart about batching re-renders?\n    this.setFlamechartHoveredNode(FlamechartID.CHRONO, null)\n    this.setFlamechartHoveredNode(FlamechartID.LEFT_HEAVY, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_CALLEES, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_INVERTED_CALLERS, null)\n  }\n}\n","import {Atom} from '../lib/atom'\nimport {ViewMode} from '../lib/view-mode'\nimport {getHashParams, HashParams} from '../lib/hash-params'\nimport {ProfileGroupAtom} from './profile-group'\n\n// True if recursion should be flattened when viewing flamegraphs\nexport const flattenRecursionAtom = new Atom<boolean>(false, 'flattenRecursion')\n\n// The query used in top-level views\n//\n// An empty string indicates that the search is open by no filter is applied.\n// searchIsActive is stored separately, because we may choose to persist the\n// query even when the search input is closed.\nexport const searchIsActiveAtom = new Atom<boolean>(false, 'searchIsActive')\nexport const searchQueryAtom = new Atom<string>('', 'searchQueryAtom')\n\n// Which top-level view should be displayed\nexport const viewModeAtom = new Atom<ViewMode>(ViewMode.CHRONO_FLAME_CHART, 'viewMode')\n\n// The top-level profile group from which most other data will be derived\nexport const profileGroupAtom = new ProfileGroupAtom(null, 'profileGroup')\n\n// The top-level profile group from which most other data will be derived\nexport const compareProfileGroupAtom = new ProfileGroupAtom(null, 'compareProfileGroup')\n\nviewModeAtom.subscribe(() => {\n  // If we switch views, the hover information is no longer relevant\n  profileGroupAtom.clearHoverNode()\n})\n\n// Parameters defined by the URL encoded k=v pairs after the # in the URL\nconst hashParams = getHashParams()\nexport const hashParamsAtom = new Atom<HashParams>(hashParams, 'hashParams')\n\n// The <canvas> element used for WebGL\nexport const glCanvasAtom = new Atom<HTMLCanvasElement | null>(null, 'glCanvas')\n\n// True when a file drag is currently active. Used to indicate that the\n// application is a valid drop target.\nexport const dragActiveAtom = new Atom<boolean>(false, 'dragActive')\n\n// True when the application is currently in a loading state. Used to\n// display a loading progress bar.\n\n// Speedscope is usable both from a local HTML file being served\n// from a file:// URL, and via websites. In the case of file:// URLs,\n// however, XHR will be unavailable to fetching files in adjacent directories.\nconst protocol = window.location.protocol\nexport const canUseXHR = protocol === 'http:' || protocol === 'https:'\nconst isImmediatelyLoading = canUseXHR && hashParams.profileURL != null\nexport const loadingAtom = new Atom<boolean>(isImmediatelyLoading, 'loading')\n\n// True when the application is an error state, e.g. because the profile\n// imported was invalid.\nexport const errorAtom = new Atom<boolean>(false, 'error')\n\nexport enum SortField {\n  SYMBOL_NAME,\n  SELF,\n  TOTAL,\n}\n\nexport enum CompareSortField {\n  SYMBOL_NAME,\n  SELF_CHANGE,\n  TOTAL_CHANGE,\n}\n\nexport enum SortDirection {\n  ASCENDING,\n  DESCENDING,\n}\n\nexport interface SortMethod {\n  field: SortField\n  direction: SortDirection\n}\n\nexport interface CompareSortMethod {\n  field: CompareSortField\n  direction: SortDirection\n}\n\n// The table sorting method using for the sandwich view, specifying the column\n// to sort by, and the direction to sort that clumn.\nexport const tableSortMethodAtom = new Atom<SortMethod>(\n  {\n    field: SortField.SELF,\n    direction: SortDirection.DESCENDING,\n  },\n  'tableSortMethod',\n)\n","import {Profile} from '../lib/profile'\nimport {getProfileToView} from './getters'\nimport {compareProfileGroupAtom, flattenRecursionAtom, profileGroupAtom} from '.'\nimport {FlamechartViewState, SandwichViewState} from './profile-group'\nimport {useAtom} from '../lib/atom'\n\nexport interface ApplicationState {}\n\nexport interface ActiveProfileState {\n  profile: Profile\n  index: number\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport function useActiveProfileState(): ActiveProfileState | null {\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const profileGroupState = useAtom(profileGroupAtom)\n\n  if (!profileGroupState) return null\n  if (profileGroupState.indexToView >= profileGroupState.profiles.length) return null\n\n  const index = profileGroupState.indexToView\n  const profileState = profileGroupState.profiles[index]\n  return {\n    ...profileGroupState.profiles[profileGroupState.indexToView],\n    profile: getProfileToView({\n      profile: profileState.profile,\n      flattenRecursion,\n    }),\n    index: profileGroupState.indexToView,\n  }\n}\n\nexport function useActiveCompareProfileState(): ActiveProfileState | null {\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const profileGroupState = useAtom(compareProfileGroupAtom)\n\n  if (!profileGroupState) return null\n  if (profileGroupState.indexToView >= profileGroupState.profiles.length) return null\n\n  const index = profileGroupState.indexToView\n  const profileState = profileGroupState.profiles[index]\n  return {\n    ...profileGroupState.profiles[profileGroupState.indexToView],\n    profile: getProfileToView({\n      profile: profileState.profile,\n      flattenRecursion,\n    }),\n    index: profileGroupState.indexToView,\n  }\n}\n","import {Atom} from '../lib/atom'\n\nexport const enum ColorScheme {\n  // Default: respect prefers-color-schema\n  SYSTEM,\n\n  // Use dark theme\n  DARK,\n\n  // use light theme\n  LIGHT,\n}\n\nconst localStorageKey = 'speedscope-color-scheme'\n\nfunction getStoredPreference(): ColorScheme {\n  const storedPreference = window.localStorage && window.localStorage[localStorageKey]\n  if (storedPreference === 'DARK') {\n    return ColorScheme.DARK\n  } else if (storedPreference === 'LIGHT') {\n    return ColorScheme.LIGHT\n  } else {\n    return ColorScheme.SYSTEM\n  }\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nfunction nextColorScheme(scheme: ColorScheme): ColorScheme {\n  const systemPrefersDarkMode = matchMediaDarkColorScheme().matches\n\n  // We'll use a different cycling order for changing the color scheme depending\n  // on what the *current* system preference is. This should guarantee that when\n  // a user interacts with the color scheme toggle for the first time, it always\n  // changes the color scheme.\n  if (systemPrefersDarkMode) {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  } else {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  }\n}\n\nclass ColorSchemeAtom extends Atom<ColorScheme> {\n  cycleToNextColorScheme = () => {\n    this.set(nextColorScheme(this.get()))\n  }\n}\n\nexport const colorSchemeAtom = new ColorSchemeAtom(getStoredPreference(), 'colorScheme')\n\ncolorSchemeAtom.subscribe(() => {\n  const value = colorSchemeAtom.get()\n\n  switch (value) {\n    case ColorScheme.DARK: {\n      window.localStorage[localStorageKey] = 'DARK'\n      break\n    }\n    case ColorScheme.LIGHT: {\n      window.localStorage[localStorageKey] = 'LIGHT'\n      break\n    }\n    case ColorScheme.SYSTEM: {\n      delete window.localStorage[localStorageKey]\n      break\n    }\n    default: {\n      const _exhaustiveCheck: never = value\n      return _exhaustiveCheck\n    }\n  }\n  return value\n})\n","import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  LIGHTER_GRAY = '#D0D0D0',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  DARKER_GRAY = '#0C0C0C',\n  OFF_BLACK = '#060606',\n  BLACK = '#000000',\n  BLUE = '#00769B',\n  PALE_BLUE = '#004E75',\n  GREEN = '#0F8A42',\n  RED = '#C03737',\n  LIGHT_BROWN = '#D6AE24',\n  BROWN = '#A66F1C',\n}\n\nconst C_0 = 0.2\nconst C_d = 0.1\nconst L_0 = 0.2\nconst L_d = 0.1\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const darkTheme: Theme = {\n  fgPrimaryColor: Colors.LIGHTER_GRAY,\n  fgSecondaryColor: Colors.GRAY,\n\n  bgPrimaryColor: Colors.OFF_BLACK,\n  bgSecondaryColor: Colors.DARKER_GRAY,\n\n  altFgPrimaryColor: Colors.LIGHTER_GRAY,\n  altFgSecondaryColor: Colors.GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARKER_GRAY,\n\n  selectionPrimaryColor: Colors.BLUE,\n  selectionSecondaryColor: Colors.PALE_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.DARKER_GRAY,\n  searchMatchPrimaryColor: Colors.BROWN,\n  searchMatchSecondaryColor: Colors.LIGHT_BROWN,\n\n  positive: Colors.GREEN,\n  negative: Colors.RED,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n","import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  WHITE = '#FFFFFF',\n  OFF_WHITE = '#F6F6F6',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  OFF_BLACK = '#111111',\n  BLACK = '#000000',\n  DARK_BLUE = '#2F80ED',\n  PALE_DARK_BLUE = '#8EB7ED',\n  GREEN = '#6FCF97',\n  RED = '#E66B6B',\n  YELLOW = '#FEDC62',\n  ORANGE = '#FFAC02',\n}\n\nconst C_0 = 0.25\nconst C_d = 0.2\nconst L_0 = 0.8\nconst L_d = 0.15\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const lightTheme: Theme = {\n  fgPrimaryColor: Colors.BLACK,\n  fgSecondaryColor: Colors.LIGHT_GRAY,\n\n  bgPrimaryColor: Colors.WHITE,\n  bgSecondaryColor: Colors.OFF_WHITE,\n\n  altFgPrimaryColor: Colors.WHITE,\n  altFgSecondaryColor: Colors.LIGHT_GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARK_GRAY,\n\n  selectionPrimaryColor: Colors.DARK_BLUE,\n  selectionSecondaryColor: Colors.PALE_DARK_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.BLACK,\n  searchMatchPrimaryColor: Colors.ORANGE,\n  searchMatchSecondaryColor: Colors.YELLOW,\n\n  positive: Colors.GREEN,\n  negative: Colors.RED,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n","import {h, ComponentChildren, createContext} from 'preact'\nimport {useCallback, useContext, useEffect, useState} from 'preact/hooks'\nimport {ColorScheme, colorSchemeAtom} from '../../app-state/color-scheme'\nimport {useAtom} from '../../lib/atom'\nimport {Color} from '../../lib/color'\nimport {memoizeByReference} from '../../lib/utils'\nimport {darkTheme} from './dark-theme'\nimport {lightTheme} from './light-theme'\n\nexport interface Theme {\n  fgPrimaryColor: string\n  fgSecondaryColor: string\n  bgPrimaryColor: string\n  bgSecondaryColor: string\n\n  altFgPrimaryColor: string\n  altFgSecondaryColor: string\n  altBgPrimaryColor: string\n  altBgSecondaryColor: string\n\n  selectionPrimaryColor: string\n  selectionSecondaryColor: string\n\n  weightColor: string\n\n  searchMatchTextColor: string\n  searchMatchPrimaryColor: string\n  searchMatchSecondaryColor: string\n\n  negative: string\n  positive: string\n\n  colorForBucket: (t: number) => Color\n  colorForBucketGLSL: string\n}\n\nexport const ThemeContext = createContext<Theme>(lightTheme)\n\nexport function useTheme(): Theme {\n  return useContext(ThemeContext)\n}\n\nexport function withTheme<T>(cb: (theme: Theme) => T) {\n  return memoizeByReference(cb)\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nexport function colorSchemeToString(scheme: ColorScheme): string {\n  switch (scheme) {\n    case ColorScheme.SYSTEM: {\n      return 'System'\n    }\n    case ColorScheme.DARK: {\n      return 'Dark'\n    }\n    case ColorScheme.LIGHT: {\n      return 'Light'\n    }\n  }\n}\n\nfunction getTheme(colorScheme: ColorScheme, systemPrefersDarkMode: boolean) {\n  switch (colorScheme) {\n    case ColorScheme.SYSTEM: {\n      return systemPrefersDarkMode ? darkTheme : lightTheme\n    }\n    case ColorScheme.DARK: {\n      return darkTheme\n    }\n    case ColorScheme.LIGHT: {\n      return lightTheme\n    }\n  }\n}\n\nexport function ThemeProvider(props: {children: ComponentChildren}) {\n  const [systemPrefersDarkMode, setSystemPrefersDarkMode] = useState(\n    () => matchMediaDarkColorScheme().matches,\n  )\n\n  const matchMediaListener = useCallback(\n    (event: MediaQueryListEvent) => {\n      setSystemPrefersDarkMode(event.matches)\n    },\n    [setSystemPrefersDarkMode],\n  )\n\n  useEffect(() => {\n    const media = matchMediaDarkColorScheme()\n    media.addEventListener('change', matchMediaListener)\n    return () => {\n      media.removeEventListener('change', matchMediaListener)\n    }\n  }, [matchMediaListener])\n\n  const colorScheme = useAtom(colorSchemeAtom)\n  const theme = getTheme(colorScheme, systemPrefersDarkMode)\n\n  return <ThemeContext.Provider value={theme} children={props.children} />\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isPrefixedValue;\nvar regex = /-webkit-|-moz-|-ms-/;\n\nfunction isPrefixedValue(value) {\n  return typeof value === 'string' && regex.test(value);\n}\nmodule.exports = exports['default'];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = calc;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\nfunction calc(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"calc(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/calc\\(/g, prefix + \"calc(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = crossFade;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#search=cross-fade\nvar prefixes = [\"-webkit-\", \"\"];\nfunction crossFade(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"cross-fade(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/cross-fade\\(/g, prefix + \"cross-fade(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = cursor;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = {\n  \"zoom-in\": true,\n  \"zoom-out\": true,\n  grab: true,\n  grabbing: true\n};\n\nfunction cursor(property, value) {\n  if (property === \"cursor\" && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = filter;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-filter-function\nvar prefixes = [\"-webkit-\", \"\"];\nfunction filter(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"filter(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/filter\\(/g, prefix + \"filter(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flex;\nvar values = {\n  flex: [\"-webkit-box\", \"-moz-box\", \"-ms-flexbox\", \"-webkit-flex\", \"flex\"],\n  \"inline-flex\": [\"-webkit-inline-box\", \"-moz-inline-box\", \"-ms-inline-flexbox\", \"-webkit-inline-flex\", \"inline-flex\"]\n};\n\nfunction flex(property, value) {\n  if (property === \"display\" && values.hasOwnProperty(value)) {\n    return values[value];\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxIE;\nvar alternativeValues = {\n  \"space-around\": \"distribute\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\"\n};\nvar alternativeProps = {\n  alignContent: \"msFlexLinePack\",\n  alignSelf: \"msFlexItemAlign\",\n  alignItems: \"msFlexAlign\",\n  justifyContent: \"msFlexPack\",\n  order: \"msFlexOrder\",\n  flexGrow: \"msFlexPositive\",\n  flexShrink: \"msFlexNegative\",\n  flexBasis: \"msFlexPreferredSize\"\n};\n\nfunction flexboxIE(property, value, style) {\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxOld;\nvar alternativeValues = {\n  \"space-around\": \"justify\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\",\n  \"wrap-reverse\": \"multiple\",\n  wrap: \"multiple\"\n};\n\nvar alternativeProps = {\n  alignItems: \"WebkitBoxAlign\",\n  justifyContent: \"WebkitBoxPack\",\n  flexWrap: \"WebkitBoxLines\"\n};\n\nfunction flexboxOld(property, value, style) {\n  if (property === \"flexDirection\" && typeof value === \"string\") {\n    if (value.indexOf(\"column\") > -1) {\n      style.WebkitBoxOrient = \"vertical\";\n    } else {\n      style.WebkitBoxOrient = \"horizontal\";\n    }\n    if (value.indexOf(\"reverse\") > -1) {\n      style.WebkitBoxDirection = \"reverse\";\n    } else {\n      style.WebkitBoxDirection = \"normal\";\n    }\n  }\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = gradient;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = /linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;\n\nfunction gradient(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && values.test(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = imageSet;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-image-set\nvar prefixes = [\"-webkit-\", \"\"];\nfunction imageSet(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"image-set(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/image-set\\(/g, prefix + \"image-set(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = position;\nfunction position(property, value) {\n  if (property === \"position\" && value === \"sticky\") {\n    return [\"-webkit-sticky\", \"sticky\"];\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = sizing;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar properties = {\n  maxHeight: true,\n  maxWidth: true,\n  width: true,\n  height: true,\n  columnWidth: true,\n  minWidth: true,\n  minHeight: true\n};\nvar values = {\n  \"min-content\": true,\n  \"max-content\": true,\n  \"fill-available\": true,\n  \"fit-content\": true,\n  \"contain-floats\": true\n};\n\nfunction sizing(property, value) {\n  if (properties.hasOwnProperty(property) && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];","'use strict';\n\nvar uppercasePattern = /[A-Z]/g;\nvar msPattern = /^ms-/;\nvar cache = {};\n\nfunction hyphenateStyleName(string) {\n    return string in cache\n    ? cache[string]\n    : cache[string] = string\n      .replace(uppercasePattern, '-$&')\n      .toLowerCase()\n      .replace(msPattern, '-ms-');\n}\n\nmodule.exports = hyphenateStyleName;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = hyphenateProperty;\n\nvar _hyphenateStyleName = require('hyphenate-style-name');\n\nvar _hyphenateStyleName2 = _interopRequireDefault(_hyphenateStyleName);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction hyphenateProperty(property) {\n  return (0, _hyphenateStyleName2.default)(property);\n}\nmodule.exports = exports['default'];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = capitalizeString;\nfunction capitalizeString(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = transition;\n\nvar _hyphenateProperty = require(\"css-in-js-utils/lib/hyphenateProperty\");\n\nvar _hyphenateProperty2 = _interopRequireDefault(_hyphenateProperty);\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nvar _capitalizeString = require(\"../../utils/capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar properties = {\n  transition: true,\n  transitionProperty: true,\n  WebkitTransition: true,\n  WebkitTransitionProperty: true,\n  MozTransition: true,\n  MozTransitionProperty: true\n};\n\n\nvar prefixMapping = {\n  Webkit: \"-webkit-\",\n  Moz: \"-moz-\",\n  ms: \"-ms-\"\n};\n\nfunction prefixValue(value, propertyPrefixMap) {\n  if ((0, _isPrefixedValue2.default)(value)) {\n    return value;\n  }\n\n  // only split multi values, not cubic beziers\n  var multipleValues = value.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g);\n\n  for (var i = 0, len = multipleValues.length; i < len; ++i) {\n    var singleValue = multipleValues[i];\n    var values = [singleValue];\n    for (var property in propertyPrefixMap) {\n      var dashCaseProperty = (0, _hyphenateProperty2.default)(property);\n\n      if (singleValue.indexOf(dashCaseProperty) > -1 && dashCaseProperty !== \"order\") {\n        var prefixes = propertyPrefixMap[property];\n        for (var j = 0, pLen = prefixes.length; j < pLen; ++j) {\n          // join all prefixes and create a new value\n          values.unshift(singleValue.replace(dashCaseProperty, prefixMapping[prefixes[j]] + dashCaseProperty));\n        }\n      }\n    }\n\n    multipleValues[i] = values.join(\",\");\n  }\n\n  return multipleValues.join(\",\");\n}\n\nfunction transition(property, value, style, propertyPrefixMap) {\n  // also check for already prefixed transitions\n  if (typeof value === \"string\" && properties.hasOwnProperty(property)) {\n    var outputValue = prefixValue(value, propertyPrefixMap);\n    // if the property is already prefixed\n    var webkitOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-moz-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Webkit\") > -1) {\n      return webkitOutput;\n    }\n\n    var mozOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-webkit-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Moz\") > -1) {\n      return mozOutput;\n    }\n\n    style[\"Webkit\" + (0, _capitalizeString2.default)(property)] = webkitOutput;\n    style[\"Moz\" + (0, _capitalizeString2.default)(property)] = mozOutput;\n    return outputValue;\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nmodule.exports = hash;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixProperty;\n\nvar _capitalizeString = require(\"./capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction prefixProperty(prefixProperties, property, style) {\n  if (prefixProperties.hasOwnProperty(property)) {\n    var newStyle = {};\n    var requiredPrefixes = prefixProperties[property];\n    var capitalizedProperty = (0, _capitalizeString2.default)(property);\n    var keys = Object.keys(style);\n    for (var i = 0; i < keys.length; i++) {\n      var styleProperty = keys[i];\n      if (styleProperty === property) {\n        for (var j = 0; j < requiredPrefixes.length; j++) {\n          newStyle[requiredPrefixes[j] + capitalizedProperty] = style[property];\n        }\n      }\n      newStyle[styleProperty] = style[styleProperty];\n    }\n    return newStyle;\n  }\n  return style;\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixValue;\nfunction prefixValue(plugins, property, value, style, metaData) {\n  for (var i = 0, len = plugins.length; i < len; ++i) {\n    var processedValue = plugins[i](property, value, style, metaData);\n\n    // we can stop processing if a value is returned\n    // as all plugin criteria are unique\n    if (processedValue) {\n      return processedValue;\n    }\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addNewValuesOnly;\nfunction addIfNew(list, value) {\n  if (list.indexOf(value) === -1) {\n    list.push(value);\n  }\n}\n\nfunction addNewValuesOnly(list, values) {\n  if (Array.isArray(values)) {\n    for (var i = 0, len = values.length; i < len; ++i) {\n      addIfNew(list, values[i]);\n    }\n  } else {\n    addIfNew(list, values);\n  }\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isObject;\nfunction isObject(value) {\n  return value instanceof Object && !Array.isArray(value);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createPrefixer;\n\nvar _prefixProperty = require(\"../utils/prefixProperty\");\n\nvar _prefixProperty2 = _interopRequireDefault(_prefixProperty);\n\nvar _prefixValue = require(\"../utils/prefixValue\");\n\nvar _prefixValue2 = _interopRequireDefault(_prefixValue);\n\nvar _addNewValuesOnly = require(\"../utils/addNewValuesOnly\");\n\nvar _addNewValuesOnly2 = _interopRequireDefault(_addNewValuesOnly);\n\nvar _isObject = require(\"../utils/isObject\");\n\nvar _isObject2 = _interopRequireDefault(_isObject);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction createPrefixer(_ref) {\n  var prefixMap = _ref.prefixMap,\n      plugins = _ref.plugins;\n\n  function prefixAll(style) {\n    for (var property in style) {\n      var value = style[property];\n\n      // handle nested objects\n      if ((0, _isObject2.default)(value)) {\n        style[property] = prefixAll(value);\n        // handle array values\n      } else if (Array.isArray(value)) {\n        var combinedValue = [];\n\n        for (var i = 0, len = value.length; i < len; ++i) {\n          var processedValue = (0, _prefixValue2.default)(plugins, property, value[i], style, prefixMap);\n          (0, _addNewValuesOnly2.default)(combinedValue, processedValue || value[i]);\n        }\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (combinedValue.length > 0) {\n          style[property] = combinedValue;\n        }\n      } else {\n        var _processedValue = (0, _prefixValue2.default)(plugins, property, value, style, prefixMap);\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (_processedValue) {\n          style[property] = _processedValue;\n        }\n\n        style = (0, _prefixProperty2.default)(prefixMap, property, style);\n      }\n    }\n\n    return style;\n  }\n\n  return prefixAll;\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\n// Use the fastest means possible to execute a task in its own turn, with\n// priority over other events including IO, animation, reflow, and redraw\n// events in browsers.\n//\n// An exception thrown by a task will permanently interrupt the processing of\n// subsequent tasks. The higher level `asap` function ensures that if an\n// exception is thrown by a task, that the task queue will continue flushing as\n// soon as possible, but if you use `rawAsap` directly, you are responsible to\n// either ensure that no exceptions are thrown from your task, or to manually\n// call `rawAsap.requestFlush` if an exception is thrown.\nmodule.exports = rawAsap;\nfunction rawAsap(task) {\n    if (!queue.length) {\n        requestFlush();\n        flushing = true;\n    }\n    // Equivalent to push, but avoids a function call.\n    queue[queue.length] = task;\n}\n\nvar queue = [];\n// Once a flush has been requested, no further calls to `requestFlush` are\n// necessary until the next `flush` completes.\nvar flushing = false;\n// `requestFlush` is an implementation-specific method that attempts to kick\n// off a `flush` event as quickly as possible. `flush` will attempt to exhaust\n// the event queue before yielding to the browser's own event loop.\nvar requestFlush;\n// The position of the next task to execute in the task queue. This is\n// preserved between calls to `flush` so that it can be resumed if\n// a task throws an exception.\nvar index = 0;\n// If a task schedules additional tasks recursively, the task queue can grow\n// unbounded. To prevent memory exhaustion, the task queue will periodically\n// truncate already-completed tasks.\nvar capacity = 1024;\n\n// The flush function processes all tasks that have been scheduled with\n// `rawAsap` unless and until one of those tasks throws an exception.\n// If a task throws an exception, `flush` ensures that its state will remain\n// consistent and will resume where it left off when called again.\n// However, `flush` does not make any arrangements to be called again if an\n// exception is thrown.\nfunction flush() {\n    while (index < queue.length) {\n        var currentIndex = index;\n        // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n        index = index + 1;\n        queue[currentIndex].call();\n        // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n        if (index > capacity) {\n            // Manually shift all values starting at the index back to the\n            // beginning of the queue.\n            for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n                queue[scan] = queue[scan + index];\n            }\n            queue.length -= index;\n            index = 0;\n        }\n    }\n    queue.length = 0;\n    index = 0;\n    flushing = false;\n}\n\n// `requestFlush` is implemented using a strategy based on data collected from\n// every available SauceLabs Selenium web driver worker at time of writing.\n// https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nvar scope = typeof global !== \"undefined\" ? global : self;\nvar BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\n// MutationObservers are desirable because they have high priority and work\n// reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nif (typeof BrowserMutationObserver === \"function\") {\n    requestFlush = makeRequestCallFromMutationObserver(flush);\n\n// MessageChannels are desirable because they give direct access to the HTML\n// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\n} else {\n    requestFlush = makeRequestCallFromTimer(flush);\n}\n\n// `requestFlush` requests that the high priority event queue be flushed as\n// soon as possible.\n// This is useful to prevent an error thrown in a task from stalling the event\n// queue if the exception handled by Node.jss\n// `process.on(\"uncaughtException\")` or by a domain.\nrawAsap.requestFlush = requestFlush;\n\n// To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\nfunction makeRequestCallFromMutationObserver(callback) {\n    var toggle = 1;\n    var observer = new BrowserMutationObserver(callback);\n    var node = document.createTextNode(\"\");\n    observer.observe(node, {characterData: true});\n    return function requestCall() {\n        toggle = -toggle;\n        node.data = toggle;\n    };\n}\n\n// The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n\nfunction makeRequestCallFromTimer(callback) {\n    return function requestCall() {\n        // We dispatch a timeout with a specified delay of 0 for engines that\n        // can reliably accommodate that request. This will usually be snapped\n        // to a 4 milisecond delay, but once we're flushing, there's no delay\n        // between events.\n        var timeoutHandle = setTimeout(handleTimer, 0);\n        // However, since this timer gets frequently dropped in Firefox\n        // workers, we enlist an interval handle that will try to fire\n        // an event 20 times per second until it succeeds.\n        var intervalHandle = setInterval(handleTimer, 50);\n\n        function handleTimer() {\n            // Whichever timer succeeds will cancel both timers and\n            // execute the callback.\n            clearTimeout(timeoutHandle);\n            clearInterval(intervalHandle);\n            callback();\n        }\n    };\n}\n\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// its existence.\nrawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer;\n\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n","\"use strict\";\n\n// rawAsap provides everything we need except exception management.\nvar rawAsap = require(\"./raw\");\n// RawTasks are recycled to reduce GC churn.\nvar freeTasks = [];\n// We queue errors to ensure they are thrown in right order (FIFO).\n// Array-as-queue is good enough here, since we are just dealing with exceptions.\nvar pendingErrors = [];\nvar requestErrorThrow = rawAsap.makeRequestCallFromTimer(throwFirstError);\n\nfunction throwFirstError() {\n    if (pendingErrors.length) {\n        throw pendingErrors.shift();\n    }\n}\n\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\nmodule.exports = asap;\nfunction asap(task) {\n    var rawTask;\n    if (freeTasks.length) {\n        rawTask = freeTasks.pop();\n    } else {\n        rawTask = new RawTask();\n    }\n    rawTask.task = task;\n    rawAsap(rawTask);\n}\n\n// We wrap tasks with recyclable task objects.  A task object implements\n// `call`, just like a function.\nfunction RawTask() {\n    this.task = null;\n}\n\n// The sole purpose of wrapping the task is to catch the exception and recycle\n// the task object after its single use.\nRawTask.prototype.call = function () {\n    try {\n        this.task.call();\n    } catch (error) {\n        if (asap.onerror) {\n            // This hook exists purely for testing purposes.\n            // Its name will be periodically randomized to break any code that\n            // depends on its existence.\n            asap.onerror(error);\n        } else {\n            // In a web browser, exceptions are not fatal. However, to avoid\n            // slowing down the queue of pending tasks, we rethrow the error in a\n            // lower priority turn.\n            pendingErrors.push(error);\n            requestErrorThrow();\n        }\n    } finally {\n        this.task = null;\n        freeTasks[freeTasks.length] = this;\n    }\n};\n","import calc from 'inline-style-prefixer/static/plugins/calc';\nimport crossFade from 'inline-style-prefixer/static/plugins/crossFade';\nimport cursor from 'inline-style-prefixer/static/plugins/cursor';\nimport filter from 'inline-style-prefixer/static/plugins/filter';\nimport flex from 'inline-style-prefixer/static/plugins/flex';\nimport flexboxIE from 'inline-style-prefixer/static/plugins/flexboxIE';\nimport flexboxOld from 'inline-style-prefixer/static/plugins/flexboxOld';\nimport gradient from 'inline-style-prefixer/static/plugins/gradient';\nimport imageSet from 'inline-style-prefixer/static/plugins/imageSet';\nimport position from 'inline-style-prefixer/static/plugins/position';\nimport sizing from 'inline-style-prefixer/static/plugins/sizing';\nimport transition from 'inline-style-prefixer/static/plugins/transition';\nimport stringHash from 'string-hash';\nimport createPrefixer from 'inline-style-prefixer/static/createPrefixer';\nimport asap from 'asap';\n\nvar w = [\"Webkit\"];\nvar m = [\"Moz\"];\nvar ms = [\"ms\"];\nvar wm = [\"Webkit\", \"Moz\"];\nvar wms = [\"Webkit\", \"ms\"];\nvar wmms = [\"Webkit\", \"Moz\", \"ms\"];\n\nvar staticPrefixData = {\n  plugins: [calc, crossFade, cursor, filter, flex, flexboxIE, flexboxOld, gradient, imageSet, position, sizing, transition],\n  prefixMap: { \"transform\": wms, \"transformOrigin\": wms, \"transformOriginX\": wms, \"transformOriginY\": wms, \"backfaceVisibility\": w, \"perspective\": w, \"perspectiveOrigin\": w, \"transformStyle\": w, \"transformOriginZ\": w, \"animation\": w, \"animationDelay\": w, \"animationDirection\": w, \"animationFillMode\": w, \"animationDuration\": w, \"animationIterationCount\": w, \"animationName\": w, \"animationPlayState\": w, \"animationTimingFunction\": w, \"appearance\": wm, \"userSelect\": wmms, \"fontKerning\": w, \"textEmphasisPosition\": w, \"textEmphasis\": w, \"textEmphasisStyle\": w, \"textEmphasisColor\": w, \"boxDecorationBreak\": w, \"clipPath\": w, \"maskImage\": w, \"maskMode\": w, \"maskRepeat\": w, \"maskPosition\": w, \"maskClip\": w, \"maskOrigin\": w, \"maskSize\": w, \"maskComposite\": w, \"mask\": w, \"maskBorderSource\": w, \"maskBorderMode\": w, \"maskBorderSlice\": w, \"maskBorderWidth\": w, \"maskBorderOutset\": w, \"maskBorderRepeat\": w, \"maskBorder\": w, \"maskType\": w, \"textDecorationStyle\": wm, \"textDecorationSkip\": wm, \"textDecorationLine\": wm, \"textDecorationColor\": wm, \"filter\": w, \"fontFeatureSettings\": wm, \"breakAfter\": wmms, \"breakBefore\": wmms, \"breakInside\": wmms, \"columnCount\": wm, \"columnFill\": wm, \"columnGap\": wm, \"columnRule\": wm, \"columnRuleColor\": wm, \"columnRuleStyle\": wm, \"columnRuleWidth\": wm, \"columns\": wm, \"columnSpan\": wm, \"columnWidth\": wm, \"writingMode\": wms, \"flex\": wms, \"flexBasis\": w, \"flexDirection\": wms, \"flexGrow\": w, \"flexFlow\": wms, \"flexShrink\": w, \"flexWrap\": wms, \"alignContent\": w, \"alignItems\": w, \"alignSelf\": w, \"justifyContent\": w, \"order\": w, \"transitionDelay\": w, \"transitionDuration\": w, \"transitionProperty\": w, \"transitionTimingFunction\": w, \"backdropFilter\": w, \"scrollSnapType\": wms, \"scrollSnapPointsX\": wms, \"scrollSnapPointsY\": wms, \"scrollSnapDestination\": wms, \"scrollSnapCoordinate\": wms, \"shapeImageThreshold\": w, \"shapeImageMargin\": w, \"shapeImageOutside\": w, \"hyphens\": wmms, \"flowInto\": wms, \"flowFrom\": wms, \"regionFragment\": wms, \"boxSizing\": m, \"textAlignLast\": m, \"tabSize\": m, \"wrapFlow\": ms, \"wrapThrough\": ms, \"wrapMargin\": ms, \"touchAction\": ms, \"gridTemplateColumns\": ms, \"gridTemplateRows\": ms, \"gridTemplateAreas\": ms, \"gridTemplate\": ms, \"gridAutoColumns\": ms, \"gridAutoRows\": ms, \"gridAutoFlow\": ms, \"grid\": ms, \"gridRowStart\": ms, \"gridColumnStart\": ms, \"gridRowEnd\": ms, \"gridRow\": ms, \"gridColumn\": ms, \"gridColumnEnd\": ms, \"gridColumnGap\": ms, \"gridRowGap\": ms, \"gridArea\": ms, \"gridGap\": ms, \"textSizeAdjust\": wms, \"borderImage\": w, \"borderImageOutset\": w, \"borderImageRepeat\": w, \"borderImageSlice\": w, \"borderImageSource\": w, \"borderImageWidth\": w }\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MAP_EXISTS = typeof Map !== 'undefined';\n\nvar OrderedElements = function () {\n    /* ::\n    elements: {[string]: any};\n    keyOrder: string[];\n    */\n\n    function OrderedElements() {\n        _classCallCheck(this, OrderedElements);\n\n        this.elements = {};\n        this.keyOrder = [];\n    }\n\n    _createClass(OrderedElements, [{\n        key: 'forEach',\n        value: function () {\n            function forEach(callback /* : (string, any) => void */) {\n                for (var i = 0; i < this.keyOrder.length; i++) {\n                    // (value, key) to match Map's API\n                    callback(this.elements[this.keyOrder[i]], this.keyOrder[i]);\n                }\n            }\n\n            return forEach;\n        }()\n    }, {\n        key: 'set',\n        value: function () {\n            function set(key /* : string */, value /* : any */, shouldReorder /* : ?boolean */) {\n                if (!this.elements.hasOwnProperty(key)) {\n                    this.keyOrder.push(key);\n                } else if (shouldReorder) {\n                    var index = this.keyOrder.indexOf(key);\n                    this.keyOrder.splice(index, 1);\n                    this.keyOrder.push(key);\n                }\n\n                if (value == null) {\n                    this.elements[key] = value;\n                    return;\n                }\n\n                if (MAP_EXISTS && value instanceof Map || value instanceof OrderedElements) {\n                    // We have found a nested Map, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    value.forEach(function (value, key) {\n                        nested.set(key, value, shouldReorder);\n                    });\n                    this.elements[key] = nested;\n                    return;\n                }\n\n                if (!Array.isArray(value) && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n                    // We have found a nested object, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var _nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    var keys = Object.keys(value);\n                    for (var i = 0; i < keys.length; i += 1) {\n                        _nested.set(keys[i], value[keys[i]], shouldReorder);\n                    }\n                    this.elements[key] = _nested;\n                    return;\n                }\n\n                this.elements[key] = value;\n            }\n\n            return set;\n        }()\n    }, {\n        key: 'get',\n        value: function () {\n            function get(key /* : string */) /* : any */{\n                return this.elements[key];\n            }\n\n            return get;\n        }()\n    }, {\n        key: 'has',\n        value: function () {\n            function has(key /* : string */) /* : boolean */{\n                return this.elements.hasOwnProperty(key);\n            }\n\n            return has;\n        }()\n    }, {\n        key: 'addStyleType',\n        value: function () {\n            function addStyleType(styleType /* : any */) /* : void */{\n                var _this = this;\n\n                if (MAP_EXISTS && styleType instanceof Map || styleType instanceof OrderedElements) {\n                    styleType.forEach(function (value, key) {\n                        _this.set(key, value, true);\n                    });\n                } else {\n                    var keys = Object.keys(styleType);\n                    for (var i = 0; i < keys.length; i++) {\n                        this.set(keys[i], styleType[keys[i]], true);\n                    }\n                }\n            }\n\n            return addStyleType;\n        }()\n    }]);\n\n    return OrderedElements;\n}();\n\n/* ::\ntype ObjectMap = { [id:string]: any };\n*/\n\nvar UPPERCASE_RE = /([A-Z])/g;\nvar UPPERCASE_RE_TO_KEBAB = function UPPERCASE_RE_TO_KEBAB(match /* : string */) {\n    return (/* : string */'-' + String(match.toLowerCase())\n    );\n};\n\nvar kebabifyStyleName = function kebabifyStyleName(string /* : string */) /* : string */{\n    var result = string.replace(UPPERCASE_RE, UPPERCASE_RE_TO_KEBAB);\n    if (result[0] === 'm' && result[1] === 's' && result[2] === '-') {\n        return '-' + String(result);\n    }\n    return result;\n};\n\n/**\n * CSS properties which accept numbers but are not in units of \"px\".\n * Taken from React's CSSProperty.js\n */\nvar isUnitlessNumber = {\n    animationIterationCount: true,\n    borderImageOutset: true,\n    borderImageSlice: true,\n    borderImageWidth: true,\n    boxFlex: true,\n    boxFlexGroup: true,\n    boxOrdinalGroup: true,\n    columnCount: true,\n    flex: true,\n    flexGrow: true,\n    flexPositive: true,\n    flexShrink: true,\n    flexNegative: true,\n    flexOrder: true,\n    gridRow: true,\n    gridColumn: true,\n    fontWeight: true,\n    lineClamp: true,\n    lineHeight: true,\n    opacity: true,\n    order: true,\n    orphans: true,\n    tabSize: true,\n    widows: true,\n    zIndex: true,\n    zoom: true,\n\n    // SVG-related properties\n    fillOpacity: true,\n    floodOpacity: true,\n    stopOpacity: true,\n    strokeDasharray: true,\n    strokeDashoffset: true,\n    strokeMiterlimit: true,\n    strokeOpacity: true,\n    strokeWidth: true\n};\n\n/**\n * Taken from React's CSSProperty.js\n *\n * @param {string} prefix vendor-specific prefix, eg: Webkit\n * @param {string} key style name, eg: transitionDuration\n * @return {string} style name prefixed with `prefix`, properly camelCased, eg:\n * WebkitTransitionDuration\n */\nfunction prefixKey(prefix, key) {\n    return prefix + key.charAt(0).toUpperCase() + key.substring(1);\n}\n\n/**\n * Support style names that may come passed in prefixed by adding permutations\n * of vendor prefixes.\n * Taken from React's CSSProperty.js\n */\nvar prefixes = ['Webkit', 'ms', 'Moz', 'O'];\n\n// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an\n// infinite loop, because it iterates over the newly added props too.\n// Taken from React's CSSProperty.js\nObject.keys(isUnitlessNumber).forEach(function (prop) {\n    prefixes.forEach(function (prefix) {\n        isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];\n    });\n});\n\nvar stringifyValue = function stringifyValue(key /* : string */\n, prop /* : any */\n) /* : string */{\n    if (typeof prop === \"number\") {\n        if (isUnitlessNumber[key]) {\n            return \"\" + prop;\n        } else {\n            return prop + \"px\";\n        }\n    } else {\n        return '' + prop;\n    }\n};\n\nvar stringifyAndImportantifyValue = function stringifyAndImportantifyValue(key /* : string */\n, prop /* : any */\n) {\n    return (/* : string */importantify(stringifyValue(key, prop))\n    );\n};\n\n// Turn a string into a hash string of base-36 values (using letters and numbers)\n// eslint-disable-next-line no-unused-vars\nvar hashString = function hashString(string /* : string */, key /* : ?string */) {\n    return (/* string */stringHash(string).toString(36)\n    );\n};\n\n// Hash a javascript object using JSON.stringify. This is very fast, about 3\n// microseconds on my computer for a sample object:\n// http://jsperf.com/test-hashfnv32a-hash/5\n//\n// Note that this uses JSON.stringify to stringify the objects so in order for\n// this to produce consistent hashes browsers need to have a consistent\n// ordering of objects. Ben Alpert says that Facebook depends on this, so we\n// can probably depend on this too.\nvar hashObject = function hashObject(object /* : ObjectMap */) {\n    return (/* : string */hashString(JSON.stringify(object))\n    );\n};\n\n// Given a single style value string like the \"b\" from \"a: b;\", adds !important\n// to generate \"b !important\".\nvar importantify = function importantify(string /* : string */) {\n    return (/* : string */\n        // Bracket string character access is very fast, and in the default case we\n        // normally don't expect there to be \"!important\" at the end of the string\n        // so we can use this simple check to take an optimized path. If there\n        // happens to be a \"!\" in this position, we follow up with a more thorough\n        // check.\n        string[string.length - 10] === '!' && string.slice(-11) === ' !important' ? string : String(string) + ' !important'\n    );\n};\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar prefixAll = createPrefixer(staticPrefixData);\n\n/* ::\nimport type { SheetDefinition } from './index.js';\ntype StringHandlers = { [id:string]: Function };\ntype SelectorCallback = (selector: string) => string[];\nexport type SelectorHandler = (\n    selector: string,\n    baseSelector: string,\n    callback: SelectorCallback\n) => string[] | string | null;\n*/\n\n/**\n * `selectorHandlers` are functions which handle special selectors which act\n * differently than normal style definitions. These functions look at the\n * current selector and can generate CSS for the styles in their subtree by\n * calling the callback with a new selector.\n *\n * For example, when generating styles with a base selector of '.foo' and the\n * following styles object:\n *\n *   {\n *     ':nth-child(2n)': {\n *       ':hover': {\n *         color: 'red'\n *       }\n *     }\n *   }\n *\n * when we reach the ':hover' style, we would call our selector handlers like\n *\n *   handler(':hover', '.foo:nth-child(2n)', callback)\n *\n * Since our `pseudoSelectors` handles ':hover' styles, that handler would call\n * the callback like\n *\n *   callback('.foo:nth-child(2n):hover')\n *\n * to generate its subtree `{ color: 'red' }` styles with a\n * '.foo:nth-child(2n):hover' selector. The callback would return an array of CSS\n * rules like\n *\n *   ['.foo:nth-child(2n):hover{color:red !important;}']\n *\n * and the handler would then return that resulting CSS.\n *\n * `defaultSelectorHandlers` is the list of default handlers used in a call to\n * `generateCSS`.\n *\n * @name SelectorHandler\n * @function\n * @param {string} selector: The currently inspected selector. ':hover' in the\n *     example above.\n * @param {string} baseSelector: The selector of the parent styles.\n *     '.foo:nth-child(2n)' in the example above.\n * @param {function} generateSubtreeStyles: A function which can be called to\n *     generate CSS for the subtree of styles corresponding to the selector.\n *     Accepts a new baseSelector to use for generating those styles.\n * @returns {string[] | string | null} The generated CSS for this selector, or\n *     null if we don't handle this selector.\n */\nvar defaultSelectorHandlers /* : SelectorHandler[] */ = [\n// Handle pseudo-selectors, like :hover and :nth-child(3n)\nfunction () {\n    function pseudoSelectors(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \":\") {\n            return null;\n        }\n        return generateSubtreeStyles(baseSelector + selector);\n    }\n\n    return pseudoSelectors;\n}(),\n\n// Handle media queries (or font-faces)\nfunction () {\n    function mediaQueries(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \"@\") {\n            return null;\n        }\n        // Generate the styles normally, and then wrap them in the media query.\n        var generated = generateSubtreeStyles(baseSelector);\n        return [String(selector) + '{' + String(generated.join('')) + '}'];\n    }\n\n    return mediaQueries;\n}()];\n\n/**\n * Generate CSS for a selector and some styles.\n *\n * This function handles the media queries and pseudo selectors that can be used\n * in aphrodite styles.\n *\n * @param {string} selector: A base CSS selector for the styles to be generated\n *     with.\n * @param {Object} styleTypes: A list of properties of the return type of\n *     StyleSheet.create, e.g. [styles.red, styles.blue].\n * @param {Array.<SelectorHandler>} selectorHandlers: A list of selector\n *     handlers to use for handling special selectors. See\n *     `defaultSelectorHandlers`.\n * @param stringHandlers: See `generateCSSRuleset`\n * @param useImportant: See `generateCSSRuleset`\n *\n * To actually generate the CSS special-construct-less styles are passed to\n * `generateCSSRuleset`.\n *\n * For instance, a call to\n *\n *     generateCSS(\".foo\", [{\n *       color: \"red\",\n *       \"@media screen\": {\n *         height: 20,\n *         \":hover\": {\n *           backgroundColor: \"black\"\n *         }\n *       },\n *       \":active\": {\n *         fontWeight: \"bold\"\n *       }\n *     }], defaultSelectorHandlers);\n *\n * with the default `selectorHandlers` will make 5 calls to\n * `generateCSSRuleset`:\n *\n *     generateCSSRuleset(\".foo\", { color: \"red\" }, ...)\n *     generateCSSRuleset(\".foo:active\", { fontWeight: \"bold\" }, ...)\n *     // These 2 will be wrapped in @media screen {}\n *     generateCSSRuleset(\".foo\", { height: 20 }, ...)\n *     generateCSSRuleset(\".foo:hover\", { backgroundColor: \"black\" }, ...)\n */\nvar generateCSS = function generateCSS(selector /* : string */\n, styleTypes /* : SheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n) /* : string[] */{\n    var merged = new OrderedElements();\n\n    for (var i = 0; i < styleTypes.length; i++) {\n        merged.addStyleType(styleTypes[i]);\n    }\n\n    var plainDeclarations = new OrderedElements();\n    var generatedStyles = [];\n\n    // TODO(emily): benchmark this to see if a plain for loop would be faster.\n    merged.forEach(function (val, key) {\n        // For each key, see if one of the selector handlers will handle these\n        // styles.\n        var foundHandler = selectorHandlers.some(function (handler) {\n            var result = handler(key, selector, function (newSelector) {\n                return generateCSS(newSelector, [val], selectorHandlers, stringHandlers, useImportant);\n            });\n            if (result != null) {\n                // If the handler returned something, add it to the generated\n                // CSS and stop looking for another handler.\n                if (Array.isArray(result)) {\n                    generatedStyles.push.apply(generatedStyles, _toConsumableArray(result));\n                } else {\n                    // eslint-disable-next-line\n                    console.warn('WARNING: Selector handlers should return an array of rules.' + 'Returning a string containing multiple rules is deprecated.', handler);\n                    generatedStyles.push('@media all {' + String(result) + '}');\n                }\n                return true;\n            }\n        });\n        // If none of the handlers handled it, add it to the list of plain\n        // style declarations.\n        if (!foundHandler) {\n            plainDeclarations.set(key, val, true);\n        }\n    });\n    var generatedRuleset = generateCSSRuleset(selector, plainDeclarations, stringHandlers, useImportant, selectorHandlers);\n\n    if (generatedRuleset) {\n        generatedStyles.unshift(generatedRuleset);\n    }\n\n    return generatedStyles;\n};\n\n/**\n * Helper method of generateCSSRuleset to facilitate custom handling of certain\n * CSS properties. Used for e.g. font families.\n *\n * See generateCSSRuleset for usage and documentation of paramater types.\n */\nvar runStringHandlers = function runStringHandlers(declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : void */{\n    if (!stringHandlers) {\n        return;\n    }\n\n    var stringHandlerKeys = Object.keys(stringHandlers);\n    for (var i = 0; i < stringHandlerKeys.length; i++) {\n        var key = stringHandlerKeys[i];\n        if (declarations.has(key)) {\n            // A declaration exists for this particular string handler, so we\n            // need to let the string handler interpret the declaration first\n            // before proceeding.\n            //\n            // TODO(emily): Pass in a callback which generates CSS, similar to\n            // how our selector handlers work, instead of passing in\n            // `selectorHandlers` and have them make calls to `generateCSS`\n            // themselves. Right now, this is impractical because our string\n            // handlers are very specialized and do complex things.\n            declarations.set(key, stringHandlers[key](declarations.get(key), selectorHandlers),\n\n            // Preserve order here, since we are really replacing an\n            // unprocessed style with a processed style, not overriding an\n            // earlier style\n            false);\n        }\n    }\n};\n\nvar transformRule = function transformRule(key /* : string */\n, value /* : string */\n, transformValue /* : function */\n) {\n    return (/* : string */String(kebabifyStyleName(key)) + ':' + String(transformValue(key, value)) + ';'\n    );\n};\n\nvar arrayToObjectKeysReducer = function arrayToObjectKeysReducer(acc, val) {\n    acc[val] = true;\n    return acc;\n};\n\n/**\n * Generate a CSS ruleset with the selector and containing the declarations.\n *\n * This function assumes that the given declarations don't contain any special\n * children (such as media queries, pseudo-selectors, or descendant styles).\n *\n * Note that this method does not deal with nesting used for e.g.\n * psuedo-selectors or media queries. That responsibility is left to  the\n * `generateCSS` function.\n *\n * @param {string} selector: the selector associated with the ruleset\n * @param {Object} declarations: a map from camelCased CSS property name to CSS\n *     property value.\n * @param {Object.<string, function>} stringHandlers: a map from camelCased CSS\n *     property name to a function which will map the given value to the value\n *     that is output.\n * @param {bool} useImportant: A boolean saying whether to append \"!important\"\n *     to each of the CSS declarations.\n * @returns {string} A string of raw CSS.\n *\n * Examples:\n *\n *    generateCSSRuleset(\".blah\", { color: \"red\" })\n *    -> \".blah{color: red !important;}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {}, false)\n *    -> \".blah{color: red}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {color: c => c.toUpperCase})\n *    -> \".blah{color: RED}\"\n *    generateCSSRuleset(\".blah:hover\", { color: \"red\" })\n *    -> \".blah:hover{color: red}\"\n */\nvar generateCSSRuleset = function generateCSSRuleset(selector /* : string */\n, declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    // Mutates declarations\n    runStringHandlers(declarations, stringHandlers, selectorHandlers);\n\n    var originalElements = Object.keys(declarations.elements).reduce(arrayToObjectKeysReducer, Object.create(null));\n\n    // NOTE(emily): This mutates handledDeclarations.elements.\n    var prefixedElements = prefixAll(declarations.elements);\n\n    var elementNames = Object.keys(prefixedElements);\n    if (elementNames.length !== declarations.keyOrder.length) {\n        // There are some prefixed values, so we need to figure out how to sort\n        // them.\n        //\n        // Loop through prefixedElements, looking for anything that is not in\n        // sortOrder, which means it was added by prefixAll. This means that we\n        // need to figure out where it should appear in the sortOrder.\n        for (var i = 0; i < elementNames.length; i++) {\n            if (!originalElements[elementNames[i]]) {\n                // This element is not in the sortOrder, which means it is a prefixed\n                // value that was added by prefixAll. Let's try to figure out where it\n                // goes.\n                var originalStyle = void 0;\n                if (elementNames[i][0] === 'W') {\n                    // This is a Webkit-prefixed style, like \"WebkitTransition\". Let's\n                    // find its original style's sort order.\n                    originalStyle = elementNames[i][6].toLowerCase() + elementNames[i].slice(7);\n                } else if (elementNames[i][1] === 'o') {\n                    // This is a Moz-prefixed style, like \"MozTransition\". We check\n                    // the second character to avoid colliding with Ms-prefixed\n                    // styles. Let's find its original style's sort order.\n                    originalStyle = elementNames[i][3].toLowerCase() + elementNames[i].slice(4);\n                } else {\n                    // if (elementNames[i][1] === 's') {\n                    // This is a Ms-prefixed style, like \"MsTransition\".\n                    originalStyle = elementNames[i][2].toLowerCase() + elementNames[i].slice(3);\n                }\n\n                if (originalStyle && originalElements[originalStyle]) {\n                    var originalIndex = declarations.keyOrder.indexOf(originalStyle);\n                    declarations.keyOrder.splice(originalIndex, 0, elementNames[i]);\n                } else {\n                    // We don't know what the original style was, so sort it to\n                    // top. This can happen for styles that are added that don't\n                    // have the same base name as the original style.\n                    declarations.keyOrder.unshift(elementNames[i]);\n                }\n            }\n        }\n    }\n\n    var transformValue = useImportant === false ? stringifyValue : stringifyAndImportantifyValue;\n\n    var rules = [];\n    for (var _i = 0; _i < declarations.keyOrder.length; _i++) {\n        var key = declarations.keyOrder[_i];\n        var value = prefixedElements[key];\n        if (Array.isArray(value)) {\n            // inline-style-prefixer returns an array when there should be\n            // multiple rules for the same key. Here we flatten to multiple\n            // pairs with the same key.\n            for (var j = 0; j < value.length; j++) {\n                rules.push(transformRule(key, value[j], transformValue));\n            }\n        } else {\n            rules.push(transformRule(key, value, transformValue));\n        }\n    }\n\n    if (rules.length) {\n        return String(selector) + '{' + String(rules.join(\"\")) + '}';\n    } else {\n        return \"\";\n    }\n};\n\nvar _typeof$1 = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray$1(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* ::\nimport type { SheetDefinition, SheetDefinitions } from './index.js';\nimport type { MaybeSheetDefinition } from './exports.js';\nimport type { SelectorHandler } from './generate.js';\n*/\n\n// The current <style> tag we are inserting into, or null if we haven't\n// inserted anything yet. We could find this each time using\n// `document.querySelector(\"style[data-aphrodite\"])`, but holding onto it is\n// faster.\nvar styleTag /* : ?HTMLStyleElement */ = null;\n\n// Inject a set of rules into a <style> tag in the head of the document. This\n// will automatically create a style tag and then continue to use it for\n// multiple injections. It will also use a style tag with the `data-aphrodite`\n// tag on it if that exists in the DOM. This could be used for e.g. reusing the\n// same style tag that server-side rendering inserts.\nvar injectStyleTag = function injectStyleTag(cssRules /* : string[] */) {\n    if (styleTag == null) {\n        // Try to find a style tag with the `data-aphrodite` attribute first.\n        styleTag = document.querySelector(\"style[data-aphrodite]\") /* : any */;\n\n        // If that doesn't work, generate a new style tag.\n        if (styleTag == null) {\n            // Taken from\n            // http://stackoverflow.com/questions/524696/how-to-create-a-style-tag-with-javascript\n            var head = document.head || document.getElementsByTagName('head')[0];\n            styleTag = document.createElement('style');\n\n            styleTag.type = 'text/css';\n            styleTag.setAttribute(\"data-aphrodite\", \"\");\n            head.appendChild(styleTag);\n        }\n    }\n\n    var sheet = styleTag.styleSheet || styleTag.sheet /* : any */;\n\n    if (sheet.insertRule) {\n        var numRules = sheet.cssRules.length;\n        cssRules.forEach(function (rule) {\n            try {\n                sheet.insertRule(rule, numRules);\n                numRules += 1;\n            } catch (e) {\n                // The selector for this rule wasn't compatible with the browser\n            }\n        });\n    } else {\n        styleTag.innerText = (styleTag.innerText || '') + cssRules.join('');\n    }\n};\n\n// Custom handlers for stringifying CSS values that have side effects\n// (such as fontFamily, which can cause @font-face rules to be injected)\nvar stringHandlers = {\n    // With fontFamily we look for objects that are passed in and interpret\n    // them as @font-face rules that we need to inject. The value of fontFamily\n    // can either be a string (as normal), an object (a single font face), or\n    // an array of objects and strings.\n    fontFamily: function () {\n        function fontFamily(val) {\n            if (Array.isArray(val)) {\n                return val.map(fontFamily).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                injectStyleOnce(val.src, \"@font-face\", [val], false);\n                return '\"' + String(val.fontFamily) + '\"';\n            } else {\n                return val;\n            }\n        }\n\n        return fontFamily;\n    }(),\n\n    // With animationName we look for an object that contains keyframes and\n    // inject them as an `@keyframes` block, returning a uniquely generated\n    // name. The keyframes object should look like\n    //  animationName: {\n    //    from: {\n    //      left: 0,\n    //      top: 0,\n    //    },\n    //    '50%': {\n    //      left: 15,\n    //      top: 5,\n    //    },\n    //    to: {\n    //      left: 20,\n    //      top: 20,\n    //    }\n    //  }\n    // TODO(emily): `stringHandlers` doesn't let us rename the key, so I have\n    // to use `animationName` here. Improve that so we can call this\n    // `animation` instead of `animationName`.\n    animationName: function () {\n        function animationName(val, selectorHandlers) {\n            if (Array.isArray(val)) {\n                return val.map(function (v) {\n                    return animationName(v, selectorHandlers);\n                }).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                // Generate a unique name based on the hash of the object. We can't\n                // just use the hash because the name can't start with a number.\n                // TODO(emily): this probably makes debugging hard, allow a custom\n                // name?\n                var name = 'keyframe_' + String(hashObject(val));\n\n                // Since keyframes need 3 layers of nesting, we use `generateCSS` to\n                // build the inner layers and wrap it in `@keyframes` ourselves.\n                var finalVal = '@keyframes ' + name + '{';\n\n                // TODO see if we can find a way where checking for OrderedElements\n                // here is not necessary. Alternatively, perhaps we should have a\n                // utility method that can iterate over either a plain object, an\n                // instance of OrderedElements, or a Map, and then use that here and\n                // elsewhere.\n                if (val instanceof OrderedElements) {\n                    val.forEach(function (valVal, valKey) {\n                        finalVal += generateCSS(valKey, [valVal], selectorHandlers, stringHandlers, false).join('');\n                    });\n                } else {\n                    Object.keys(val).forEach(function (key) {\n                        finalVal += generateCSS(key, [val[key]], selectorHandlers, stringHandlers, false).join('');\n                    });\n                }\n                finalVal += '}';\n\n                injectGeneratedCSSOnce(name, [finalVal]);\n\n                return name;\n            } else {\n                return val;\n            }\n        }\n\n        return animationName;\n    }()\n};\n\n// This is a map from Aphrodite's generated class names to `true` (acting as a\n// set of class names)\nvar alreadyInjected = {};\n\n// This is the buffer of styles which have not yet been flushed.\nvar injectionBuffer /* : string[] */ = [];\n\n// A flag to tell if we are already buffering styles. This could happen either\n// because we scheduled a flush call already, so newly added styles will\n// already be flushed, or because we are statically buffering on the server.\nvar isBuffering = false;\n\nvar injectGeneratedCSSOnce = function injectGeneratedCSSOnce(key, generatedCSS) {\n    var _injectionBuffer;\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    if (!isBuffering) {\n        // We should never be automatically buffering on the server (or any\n        // place without a document), so guard against that.\n        if (typeof document === \"undefined\") {\n            throw new Error(\"Cannot automatically buffer without a document\");\n        }\n\n        // If we're not already buffering, schedule a call to flush the\n        // current styles.\n        isBuffering = true;\n        asap(flushToStyleTag);\n    }\n\n    (_injectionBuffer = injectionBuffer).push.apply(_injectionBuffer, _toConsumableArray$1(generatedCSS));\n    alreadyInjected[key] = true;\n};\n\nvar injectStyleOnce = function injectStyleOnce(key /* : string */\n, selector /* : string */\n, definitions /* : SheetDefinition[] */\n, useImportant /* : boolean */\n) {\n    var selectorHandlers /* : SelectorHandler[] */ = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    var generated = generateCSS(selector, definitions, selectorHandlers, stringHandlers, useImportant);\n\n    injectGeneratedCSSOnce(key, generated);\n};\n\nvar reset = function reset() {\n    injectionBuffer = [];\n    alreadyInjected = {};\n    isBuffering = false;\n    styleTag = null;\n};\n\nvar getBufferedStyles = function getBufferedStyles() {\n    return injectionBuffer;\n};\n\nvar startBuffering = function startBuffering() {\n    if (isBuffering) {\n        throw new Error(\"Cannot buffer while already buffering\");\n    }\n    isBuffering = true;\n};\n\nvar flushToArray = function flushToArray() {\n    isBuffering = false;\n    var ret = injectionBuffer;\n    injectionBuffer = [];\n    return ret;\n};\n\nvar flushToString = function flushToString() {\n    return flushToArray().join('');\n};\n\nvar flushToStyleTag = function flushToStyleTag() {\n    var cssRules = flushToArray();\n    if (cssRules.length > 0) {\n        injectStyleTag(cssRules);\n    }\n};\n\nvar getRenderedClassNames = function getRenderedClassNames() {\n    return Object.keys(alreadyInjected);\n};\n\nvar addRenderedClassNames = function addRenderedClassNames(classNames /* : string[] */) {\n    classNames.forEach(function (className) {\n        alreadyInjected[className] = true;\n    });\n};\n\nvar processStyleDefinitions = function processStyleDefinitions(styleDefinitions /* : any[] */\n, classNameBits /* : string[] */\n, definitionBits /* : Object[] */\n, length /* : number */\n) /* : number */{\n    for (var i = 0; i < styleDefinitions.length; i += 1) {\n        // Filter out falsy values from the input, to allow for\n        // `css(a, test && c)`\n        if (styleDefinitions[i]) {\n            if (Array.isArray(styleDefinitions[i])) {\n                // We've encountered an array, so let's recurse\n                length += processStyleDefinitions(styleDefinitions[i], classNameBits, definitionBits, length);\n            } else {\n                classNameBits.push(styleDefinitions[i]._name);\n                definitionBits.push(styleDefinitions[i]._definition);\n                length += styleDefinitions[i]._len;\n            }\n        }\n    }\n    return length;\n};\n\n/**\n * Inject styles associated with the passed style definition objects, and return\n * an associated CSS class name.\n *\n * @param {boolean} useImportant If true, will append !important to generated\n *     CSS output. e.g. {color: red} -> \"color: red !important\".\n * @param {(Object|Object[])[]} styleDefinitions style definition objects, or\n *     arbitrarily nested arrays of them, as returned as properties of the\n *     return value of StyleSheet.create().\n */\nvar injectAndGetClassName = function injectAndGetClassName(useImportant /* : boolean */\n, styleDefinitions /* : MaybeSheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    var classNameBits = [];\n    var definitionBits = [];\n\n    // Mutates classNameBits and definitionBits and returns a length which we\n    // will append to the hash to decrease the chance of hash collisions.\n    var length = processStyleDefinitions(styleDefinitions, classNameBits, definitionBits, 0);\n\n    // Break if there aren't any valid styles.\n    if (classNameBits.length === 0) {\n        return \"\";\n    }\n\n    var className = void 0;\n    if (process.env.NODE_ENV === 'production') {\n        className = classNameBits.length === 1 ? '_' + String(classNameBits[0]) : '_' + String(hashString(classNameBits.join())) + String((length % 36).toString(36));\n    } else {\n        className = classNameBits.join(\"-o_O-\");\n    }\n\n    injectStyleOnce(className, '.' + String(className), definitionBits, useImportant, selectorHandlers);\n\n    return className;\n};\n\n/* ::\nimport type { SelectorHandler } from './generate.js';\nexport type SheetDefinition = { [id:string]: any };\nexport type SheetDefinitions = SheetDefinition | SheetDefinition[];\ntype RenderFunction = () => string;\ntype Extension = {\n    selectorHandler: SelectorHandler\n};\nexport type MaybeSheetDefinition = SheetDefinition | false | null | void\n*/\n\nvar unminifiedHashFn = function unminifiedHashFn(str /* : string */, key /* : string */) {\n    return String(key) + '_' + String(hashString(str));\n};\n\n// StyleSheet.create is in a hot path so we want to keep as much logic out of it\n// as possible. So, we figure out which hash function to use once, and only\n// switch it out via minify() as necessary.\n//\n// This is in an exported function to make it easier to test.\nvar initialHashFn = function initialHashFn() {\n    return process.env.NODE_ENV === 'production' ? hashString : unminifiedHashFn;\n};\n\nvar hashFn = initialHashFn();\n\nvar StyleSheet = {\n    create: function () {\n        function create(sheetDefinition /* : SheetDefinition */) /* : Object */{\n            var mappedSheetDefinition = {};\n            var keys = Object.keys(sheetDefinition);\n\n            for (var i = 0; i < keys.length; i += 1) {\n                var key = keys[i];\n                var val = sheetDefinition[key];\n                var stringVal = JSON.stringify(val);\n\n                mappedSheetDefinition[key] = {\n                    _len: stringVal.length,\n                    _name: hashFn(stringVal, key),\n                    _definition: val\n                };\n            }\n\n            return mappedSheetDefinition;\n        }\n\n        return create;\n    }(),\n    rehydrate: function () {\n        function rehydrate() {\n            var renderedClassNames /* : string[] */ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            addRenderedClassNames(renderedClassNames);\n        }\n\n        return rehydrate;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite server-side.\n *\n * This can be minified out in client-only bundles by replacing `typeof window`\n * with `\"object\"`, e.g. via Webpack's DefinePlugin:\n *\n *   new webpack.DefinePlugin({\n *     \"typeof window\": JSON.stringify(\"object\")\n *   })\n */\nvar StyleSheetServer = typeof window !== 'undefined' ? null : {\n    renderStatic: function () {\n        function renderStatic(renderFunc /* : RenderFunction */) {\n            reset();\n            startBuffering();\n            var html = renderFunc();\n            var cssContent = flushToString();\n\n            return {\n                html: html,\n                css: {\n                    content: cssContent,\n                    renderedClassNames: getRenderedClassNames()\n                }\n            };\n        }\n\n        return renderStatic;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite in tests.\n *\n * Not meant to be used in production.\n */\nvar StyleSheetTestUtils = process.env.NODE_ENV === 'production' ? null : {\n    /**\n    * Prevent styles from being injected into the DOM.\n    *\n    * This is useful in situations where you'd like to test rendering UI\n    * components which use Aphrodite without any of the side-effects of\n    * Aphrodite happening. Particularly useful for testing the output of\n    * components when you have no DOM, e.g. testing in Node without a fake DOM.\n    *\n    * Should be paired with a subsequent call to\n    * clearBufferAndResumeStyleInjection.\n    */\n    suppressStyleInjection: function () {\n        function suppressStyleInjection() {\n            reset();\n            startBuffering();\n        }\n\n        return suppressStyleInjection;\n    }(),\n\n\n    /**\n    * Opposite method of preventStyleInject.\n    */\n    clearBufferAndResumeStyleInjection: function () {\n        function clearBufferAndResumeStyleInjection() {\n            reset();\n        }\n\n        return clearBufferAndResumeStyleInjection;\n    }(),\n\n\n    /**\n    * Returns a string of buffered styles which have not been flushed\n    *\n    * @returns {string}  Buffer of styles which have not yet been flushed.\n    */\n    getBufferedStyles: function () {\n        function getBufferedStyles$$1() {\n            return getBufferedStyles();\n        }\n\n        return getBufferedStyles$$1;\n    }()\n};\n\n/**\n * Generate the Aphrodite API exports, with given `selectorHandlers` and\n * `useImportant` state.\n */\nfunction makeExports(useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) {\n    return {\n        StyleSheet: Object.assign({}, StyleSheet, {\n\n            /**\n             * Returns a version of the exports of Aphrodite (i.e. an object\n             * with `css` and `StyleSheet` properties) which have some\n             * extensions included.\n             *\n             * @param {Array.<Object>} extensions: An array of extensions to\n             *     add to this instance of Aphrodite. Each object should have a\n             *     single property on it, defining which kind of extension to\n             *     add.\n             * @param {SelectorHandler} [extensions[].selectorHandler]: A\n             *     selector handler extension. See `defaultSelectorHandlers` in\n             *     generate.js.\n             *\n             * @returns {Object} An object containing the exports of the new\n             *     instance of Aphrodite.\n             */\n            extend: function () {\n                function extend(extensions /* : Extension[] */) {\n                    var extensionSelectorHandlers = extensions\n                    // Pull out extensions with a selectorHandler property\n                    .map(function (extension) {\n                        return extension.selectorHandler;\n                    })\n                    // Remove nulls (i.e. extensions without a selectorHandler\n                    // property).\n                    .filter(function (handler) {\n                        return handler;\n                    });\n\n                    return makeExports(useImportant, selectorHandlers.concat(extensionSelectorHandlers));\n                }\n\n                return extend;\n            }()\n        }),\n\n        StyleSheetServer: StyleSheetServer,\n        StyleSheetTestUtils: StyleSheetTestUtils,\n\n        minify: function () {\n            function minify(shouldMinify /* : boolean */) {\n                hashFn = shouldMinify ? hashString : unminifiedHashFn;\n            }\n\n            return minify;\n        }(),\n        css: function () {\n            function css() /* : MaybeSheetDefinition[] */{\n                for (var _len = arguments.length, styleDefinitions = Array(_len), _key = 0; _key < _len; _key++) {\n                    styleDefinitions[_key] = arguments[_key];\n                }\n\n                return injectAndGetClassName(useImportant, styleDefinitions, selectorHandlers);\n            }\n\n            return css;\n        }()\n    };\n}\n\nvar useImportant = true; // Add !important to all style definitions\n\nvar Aphrodite = makeExports(useImportant, defaultSelectorHandlers);\n\nvar StyleSheet$1 = Aphrodite.StyleSheet,\n    StyleSheetServer$1 = Aphrodite.StyleSheetServer,\n    StyleSheetTestUtils$1 = Aphrodite.StyleSheetTestUtils,\n    css = Aphrodite.css,\n    minify = Aphrodite.minify;\n\nexport { StyleSheet$1 as StyleSheet, StyleSheetServer$1 as StyleSheetServer, StyleSheetTestUtils$1 as StyleSheetTestUtils, css, minify, flushToStyleTag };\n","import {StyleSheet} from 'aphrodite'\n\nexport enum FontFamily {\n  MONOSPACE = '\"Source Code Pro\", Courier, monospace',\n}\n\nexport enum FontSize {\n  LABEL = 10,\n  TITLE = 12,\n  BIG_BUTTON = 36,\n}\n\nexport enum Sizes {\n  MINIMAP_HEIGHT = 100,\n  DETAIL_VIEW_HEIGHT = 150,\n  TOOLTIP_WIDTH_MAX = 900,\n  TOOLTIP_HEIGHT_MAX = 80,\n  SEPARATOR_HEIGHT = 2,\n  FRAME_HEIGHT = 20,\n  TOOLBAR_HEIGHT = 20,\n  TOOLBAR_TAB_HEIGHT = TOOLBAR_HEIGHT - SEPARATOR_HEIGHT,\n}\n\nexport enum Duration {\n  HOVER_CHANGE = '0.07s',\n}\n\nexport enum ZIndex {\n  PROFILE_SELECT = 1,\n  HOVERTIP = 2,\n}\n\nexport const commonStyle = StyleSheet.create({\n  fillY: {\n    height: '100%',\n  },\n  fillX: {\n    width: '100%',\n  },\n  hbox: {\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n  vbox: {\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n  hide: {\n    display: 'none',\n  },\n})\n","import {Profile, Frame, CallTreeNode} from './profile'\nimport {Flamechart, FlamechartFrame} from './flamechart'\nimport {Rect, Vec2} from './math'\n\nexport enum FlamechartType {\n  CHRONO_FLAME_CHART,\n  LEFT_HEAVY_FLAME_GRAPH,\n}\n\n// In previous versions of speedscope, searching for strings within the profile\n// was done using fuzzy finding. As it turns out, this was surprising behavior\n// to most people, so we've switched to a more traditional substring search that\n// more closely mimics browser behavior.\n//\n// This is case insensitive for both the needle & the haystack. This means\n// searching for \"hello\" will match \"Hello\" and \"HELLO\", and searching for\n// \"HELLO\" will match both \"hello\" and \"Hello\". This matches Chrome's behavior\n// as far as I can tell.\n//\n// See https://github.com/jlfwong/speedscope/issues/352\n//\n// Return ranges for all matches in order to highlight them.\nexport function exactMatchStrings(text: string, pattern: string): [number, number][] {\n  const lowerText = text.toLocaleLowerCase()\n  const lowerPattern = pattern.toLocaleLowerCase()\n\n  let lastIndex = 0\n  const matchedRanges: Array<[number, number]> = []\n  while (true) {\n    let index = lowerText.indexOf(lowerPattern, lastIndex)\n    if (index === -1) {\n      return matchedRanges\n    }\n    matchedRanges.push([index, index + pattern.length])\n    lastIndex = index + pattern.length\n  }\n}\n\n// A utility class for storing cached search results to avoid recomputation when\n// the search results & profile did not change.\nexport class ProfileSearchResults {\n  constructor(\n    readonly profile: Profile,\n    readonly searchQuery: string,\n  ) {}\n\n  private matches: Map<Frame, [number, number][] | null> | null = null\n  getMatchForFrame(frame: Frame): [number, number][] | null {\n    if (!this.matches) {\n      this.matches = new Map()\n      this.profile.forEachFrame(frame => {\n        const match = exactMatchStrings(frame.name, this.searchQuery)\n        this.matches!.set(frame, match.length === 0 ? null : match)\n      })\n    }\n    return this.matches.get(frame) || null\n  }\n}\n\nexport interface FlamechartSearchMatch {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\ninterface CachedFlamechartResult {\n  matches: FlamechartSearchMatch[]\n  indexForNode: Map<CallTreeNode, number>\n}\n\nexport class FlamechartSearchResults {\n  constructor(\n    readonly flamechart: Flamechart,\n    readonly profileResults: ProfileSearchResults,\n  ) {}\n\n  private matches: CachedFlamechartResult | null = null\n  private getResults(): CachedFlamechartResult {\n    if (this.matches == null) {\n      const matches: FlamechartSearchMatch[] = []\n      const indexForNode = new Map<CallTreeNode, number>()\n      const visit = (frame: FlamechartFrame, depth: number) => {\n        const {node} = frame\n        if (this.profileResults.getMatchForFrame(node.frame)) {\n          const configSpaceBounds = new Rect(\n            new Vec2(frame.start, depth),\n            new Vec2(frame.end - frame.start, 1),\n          )\n          indexForNode.set(node, matches.length)\n          matches.push({configSpaceBounds, node})\n        }\n\n        frame.children.forEach(child => {\n          visit(child, depth + 1)\n        })\n      }\n\n      const layers = this.flamechart.getLayers()\n      if (layers.length > 0) {\n        layers[0].forEach(frame => visit(frame, 0))\n      }\n\n      this.matches = {matches, indexForNode}\n    }\n    return this.matches\n  }\n\n  count(): number {\n    return this.getResults().matches.length\n  }\n\n  indexOf(node: CallTreeNode): number | null {\n    const result = this.getResults().indexForNode.get(node)\n    return result === undefined ? null : result\n  }\n\n  at(index: number): FlamechartSearchMatch {\n    const matches = this.getResults().matches\n    if (index < 0 || index >= matches.length) {\n      throw new Error(`Index ${index} out of bounds in list of ${matches.length} matches.`)\n    }\n    return matches[index]\n  }\n}\n","import {StyleSheet, css} from 'aphrodite'\nimport {h, createContext, ComponentChildren, Fragment} from 'preact'\nimport {useCallback, useRef, useEffect, useMemo} from 'preact/hooks'\nimport {memo} from 'preact/compat'\nimport {Sizes, FontSize} from './style'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {Profile} from '../lib/profile'\nimport {useActiveProfileState} from '../app-state/active-profile-state'\nimport {useTheme, withTheme} from './themes/theme'\nimport {searchIsActiveAtom, searchQueryAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nfunction stopPropagation(ev: Event) {\n  ev.stopPropagation()\n}\n\nexport const ProfileSearchContext = createContext<ProfileSearchResults | null>(null)\n\nexport const ProfileSearchContextProvider = ({children}: {children: ComponentChildren}) => {\n  const activeProfileState = useActiveProfileState()\n  const profile: Profile | null = activeProfileState ? activeProfileState.profile : null\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  const searchResults = useMemo(() => {\n    if (!profile || !searchIsActive || searchQuery.length === 0) {\n      return null\n    }\n    return new ProfileSearchResults(profile, searchQuery)\n  }, [searchIsActive, searchQuery, profile])\n\n  return (\n    <ProfileSearchContext.Provider value={searchResults}>{children}</ProfileSearchContext.Provider>\n  )\n}\n\ninterface SearchViewProps {\n  resultIndex: number | null\n  numResults: number | null\n  selectNext: () => void\n  selectPrev: () => void\n}\n\nexport const SearchView = memo(\n  ({numResults, resultIndex, selectNext, selectPrev}: SearchViewProps) => {\n    const theme = useTheme()\n    const style = getStyle(theme)\n    const searchIsActive = useAtom(searchIsActiveAtom)\n    const searchQuery = useAtom(searchQueryAtom)\n    const setSearchQuery = searchQueryAtom.set\n    const setSearchIsActive = searchIsActiveAtom.set\n\n    const onInput = useCallback(\n      (ev: Event) => {\n        const value = (ev.target as HTMLInputElement).value\n        setSearchQuery(value)\n      },\n      [setSearchQuery],\n    )\n\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    const close = useCallback(() => setSearchIsActive(false), [setSearchIsActive])\n\n    const selectPrevOrNextResult = useCallback(\n      (ev: KeyboardEvent) => {\n        if (ev.shiftKey) {\n          selectPrev()\n        } else {\n          selectNext()\n        }\n      },\n      [selectPrev, selectNext],\n    )\n\n    const onKeyDown = useCallback(\n      (ev: KeyboardEvent) => {\n        ev.stopPropagation()\n\n        // Hitting Esc should close the search box\n        if (ev.key === 'Escape') {\n          setSearchIsActive(false)\n        }\n\n        if (ev.key === 'Enter') {\n          selectPrevOrNextResult(ev)\n        }\n\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          if (inputRef.current) {\n            // If the input is already focused, select all\n            inputRef.current.select()\n          }\n\n          // It seems like when an input is focused, the browser find menu pops\n          // up without this line. It seems like it's not sufficient to only\n          // preventDefault in the window keydown handler.\n          ev.preventDefault()\n        }\n      },\n      [setSearchIsActive, selectPrevOrNextResult],\n    )\n\n    useEffect(() => {\n      const onWindowKeyDown = (ev: KeyboardEvent) => {\n        // Cmd+F or Ctrl+F open the search box\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          // Prevent the browser's search menu from appearing\n          ev.preventDefault()\n\n          if (inputRef.current) {\n            // If the search box is already open, then re-select it immediately.\n            inputRef.current.select()\n          } else {\n            // Otherwise, focus the search, then focus the input on the next\n            // frame, when the search box should have mounted.\n            setSearchIsActive(true)\n            requestAnimationFrame(() => {\n              if (inputRef.current) {\n                inputRef.current.select()\n              }\n            })\n          }\n        }\n      }\n\n      window.addEventListener('keydown', onWindowKeyDown)\n      return () => {\n        window.removeEventListener('keydown', onWindowKeyDown)\n      }\n    }, [setSearchIsActive])\n\n    if (!searchIsActive) return null\n\n    return (\n      <div className={css(style.searchView)}>\n        <span className={css(style.icon)}></span>\n        <span className={css(style.inputContainer)}>\n          <input\n            className={css(style.input)}\n            value={searchQuery}\n            onInput={onInput}\n            onKeyDown={onKeyDown}\n            onKeyUp={stopPropagation}\n            onKeyPress={stopPropagation}\n            ref={inputRef}\n          />\n        </span>\n        {numResults != null && (\n          <Fragment>\n            <span className={css(style.resultCount)}>\n              {resultIndex == null ? '?' : resultIndex + 1}/{numResults}\n            </span>\n            <button className={css(style.icon, style.button)} onClick={selectPrev}>\n              \n            </button>\n            <button className={css(style.icon, style.button)} onClick={selectNext}>\n              \n            </button>\n          </Fragment>\n        )}\n        <svg\n          className={css(style.icon)}\n          onClick={close}\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M4.99999 4.16217L11.6427 10.8048M11.6427 4.16217L4.99999 10.8048\"\n            stroke={theme.altFgSecondaryColor}\n          />\n        </svg>\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    searchView: {\n      position: 'absolute',\n      top: 0,\n      right: 10,\n      height: Sizes.TOOLBAR_HEIGHT,\n      width: 16 * 13,\n      borderWidth: 2,\n      borderColor: theme.altFgPrimaryColor,\n      borderStyle: 'solid',\n      fontSize: FontSize.LABEL,\n      boxSizing: 'border-box',\n      background: theme.altBgSecondaryColor,\n      color: theme.altFgPrimaryColor,\n      display: 'flex',\n      alignItems: 'center',\n    },\n    inputContainer: {\n      flexShrink: 1,\n      flexGrow: 1,\n      display: 'flex',\n    },\n    input: {\n      width: '100%',\n      border: 'none',\n      background: 'none',\n      fontSize: FontSize.LABEL,\n      lineHeight: `${Sizes.TOOLBAR_HEIGHT}px`,\n      color: theme.altFgPrimaryColor,\n      ':focus': {\n        border: 'none',\n        outline: 'none',\n      },\n      '::selection': {\n        color: theme.altFgPrimaryColor,\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    resultCount: {\n      verticalAlign: 'middle',\n    },\n    icon: {\n      flexShrink: 0,\n      verticalAlign: 'middle',\n      height: '100%',\n      margin: '0px 2px 0px 2px',\n      fontSize: FontSize.LABEL,\n    },\n    button: {\n      display: 'inline',\n      background: 'none',\n      border: 'none',\n      padding: 0,\n      ':focus': {\n        outline: 'none',\n      },\n    },\n  }),\n)\n","// Returns `input` with hex escapes expanded (e.g. `\\20` becomes ` `.)\n//\n\nimport {Frame, SymbolRemapper} from './profile'\n\n// NOTE: This will fail to ignore escaped backslahes (e.g. `\\\\20`).\nfunction unescapeHex(input: string): string {\n  return input.replace(/\\\\([a-fA-F0-9]{2})/g, (_match, group) => {\n    const scalar = parseInt(group, 16)\n    return String.fromCharCode(scalar)\n  })\n}\n\n// This imports symbol maps generated by emscripten using the \"--emit-symbol-map\" flag.\n// It allows you to visualize a profile captured in a release build as long as you also\n// have the associated symbol map. To do this, first drop the profile into speedscope\n// and then drop the symbol map. After the second drop, the symbols will be remapped to\n// their original names.\nexport function importEmscriptenSymbolMap(contents: string): SymbolRemapper | null {\n  const lines = contents.split('\\n')\n  if (!lines.length) return null\n\n  // Remove a trailing blank line if there is one\n  if (lines[lines.length - 1] === '') lines.pop()\n  if (!lines.length) return null\n\n  const map = new Map<string, string>()\n  const intRegex = /^(\\d+):(.+)$/\n  const idRegex = /^([\\$\\w]+):([\\$\\w-]+)$/\n\n  for (const line of lines) {\n    // Match lines like \"103:__ZN8tinyxml210XMLCommentD0Ev\"\n    const intMatch = intRegex.exec(line)\n    if (intMatch) {\n      map.set(`wasm-function[${intMatch[1]}]`, unescapeHex(intMatch[2]))\n      continue\n    }\n\n    // Match lines like \"u6:__ZN8tinyxml210XMLCommentD0Ev\"\n    const idMatch = idRegex.exec(line)\n    if (idMatch) {\n      map.set(idMatch[1], unescapeHex(idMatch[2]))\n      continue\n    }\n\n    return null\n  }\n\n  return (frame: Frame) => {\n    if (!map.has(frame.name)) {\n      return null\n    }\n\n    return {name: map.get(frame.name)}\n  }\n}\n","import {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {FontSize} from './style'\nimport {useTheme, withTheme} from './themes/theme'\n\ninterface ColorChitProps {\n  color: string\n}\n\nexport function ColorChit(props: ColorChitProps) {\n  const style = getStyle(useTheme())\n  return <span className={css(style.stackChit)} style={{backgroundColor: props.color}} />\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    stackChit: {\n      position: 'relative',\n      top: -1,\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      marginRight: '0.5em',\n      border: `1px solid ${theme.fgSecondaryColor}`,\n      width: FontSize.LABEL - 2,\n      height: FontSize.LABEL - 2,\n    },\n  }),\n)\n","// A simple implementation of an efficient scrolling list view which\n// renders only items within the viewport + a couple extra items.\n\nimport {h, JSX} from 'preact'\nimport {useState, useCallback, useRef, useMemo, useEffect} from 'preact/hooks'\n\nexport interface ListItem {\n  size: number\n}\n\ninterface RangeResult {\n  firstVisibleIndex: number\n  lastVisibleIndex: number\n  invisiblePrefixSize: number\n}\n\ninterface ScrollableListViewProps {\n  items: ListItem[]\n  axis: 'x' | 'y'\n  renderItems: (\n    firstVisibleIndex: number,\n    lastVisibleIndex: number,\n  ) => JSX.Element | JSX.Element[] | null\n  className?: string\n  initialIndexInView?: number | null\n}\n\nexport const ScrollableListView = ({\n  items,\n  axis,\n  renderItems,\n  className,\n  initialIndexInView,\n}: ScrollableListViewProps) => {\n  const [viewportSize, setViewportSize] = useState<number | null>(null)\n  const [viewportScrollOffset, setViewportScrollOffset] = useState<number>(0)\n\n  const viewportRef = useRef<HTMLDivElement | null>(null)\n\n  const widthOrHeight = axis === 'x' ? 'width' : 'height'\n  const leftOrTop = axis === 'x' ? 'left' : 'top'\n  const scrollLeftOrScrollTop = axis === 'x' ? 'scrollLeft' : 'scrollTop'\n\n  // This is kind of a weird hack, but I'm not sure what the better of doing something like this is.\n  const offset = initialIndexInView\n    ? items.reduce((a, b, i) => (i < initialIndexInView ? a + b.size : a), 0)\n    : 0\n  const initialScroll = useRef<number | null>(offset)\n\n  const viewportCallback = useCallback(\n    (viewport: HTMLDivElement | null) => {\n      if (viewport) {\n        requestAnimationFrame(() => {\n          setViewportSize(viewport.getBoundingClientRect()[widthOrHeight])\n          if (initialScroll.current != null) {\n            viewport.scrollTo({[leftOrTop]: initialScroll.current})\n            initialScroll.current = null\n          }\n        })\n      } else {\n        setViewportSize(null)\n      }\n      viewportRef.current = viewport\n    },\n    [setViewportSize, widthOrHeight, leftOrTop],\n  )\n\n  const rangeResult: RangeResult | null = useMemo(() => {\n    if (viewportRef.current == null || viewportSize == null || viewportScrollOffset == null) {\n      return null\n    }\n\n    // We render items up to a quarter viewport height outside of the\n    // viewport both above and below to prevent flickering.\n    const minY = viewportScrollOffset - viewportSize / 4\n    const maxY = viewportScrollOffset + viewportSize + viewportSize / 4\n\n    let total = 0\n    let invisiblePrefixSize = 0\n\n    let i = 0\n    for (; i < items.length; i++) {\n      const item = items[i]\n      invisiblePrefixSize = total\n      total += item.size\n      if (total >= minY) {\n        break\n      }\n    }\n\n    const firstVisibleIndex = i\n\n    for (; i < items.length; i++) {\n      const item = items[i]\n      total += item.size\n      if (total >= maxY) {\n        break\n      }\n    }\n\n    const lastVisibleIndex = Math.min(i, items.length - 1)\n\n    return {\n      firstVisibleIndex,\n      lastVisibleIndex,\n      invisiblePrefixSize,\n    }\n  }, [viewportSize, viewportScrollOffset, items])\n\n  const totalSize = useMemo(() => items.reduce((a, b) => a + b.size, 0), [items])\n\n  const onViewportScroll = useCallback(() => {\n    if (viewportRef.current != null) {\n      setViewportScrollOffset(viewportRef.current[scrollLeftOrScrollTop])\n    }\n  }, [scrollLeftOrScrollTop])\n\n  useEffect(() => {\n    const resizeListener = () => {\n      if (viewportRef.current != null) {\n        setViewportSize(viewportRef.current.getBoundingClientRect()[widthOrHeight])\n      }\n    }\n\n    window.addEventListener('resize', resizeListener)\n    return () => {\n      window.removeEventListener('resize', resizeListener)\n    }\n  }, [widthOrHeight])\n\n  const visibleItems = useMemo(() => {\n    return rangeResult\n      ? renderItems(rangeResult.firstVisibleIndex, rangeResult.lastVisibleIndex)\n      : null\n  }, [renderItems, rangeResult])\n\n  const content = useMemo(() => {\n    return (\n      <div style={{height: totalSize}}>\n        <div style={{transform: `translateY(${rangeResult?.invisiblePrefixSize || 0}px)`}}>\n          {visibleItems}\n        </div>\n      </div>\n    )\n  }, [rangeResult, visibleItems, totalSize])\n\n  return (\n    <div className={className} ref={viewportCallback} onScroll={onViewportScroll}>\n      {content}\n    </div>\n  )\n}\n","import {h, JSX, ComponentChild} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Profile, Frame} from '../lib/profile'\nimport {formatPercent} from '../lib/utils'\nimport {FontSize, Sizes, commonStyle} from './style'\nimport {ColorChit} from './color-chit'\nimport {ListItem, ScrollableListView} from './scrollable-list-view'\nimport {createGetCSSColorForFrame, getFrameToColorBucket} from '../app-state/getters'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {SandwichViewContext} from './sandwich-view'\nimport {Color} from '../lib/color'\nimport {useTheme, withTheme} from './themes/theme'\nimport {\n  SortDirection,\n  SortMethod,\n  SortField,\n  profileGroupAtom,\n  tableSortMethodAtom,\n  searchIsActiveAtom,\n  searchQueryAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\n\ninterface HBarProps {\n  perc: number\n}\n\nfunction HBarDisplay(props: HBarProps) {\n  const style = getStyle(useTheme())\n\n  return (\n    <div className={css(style.hBarDisplay)}>\n      <div className={css(style.hBarDisplayFilled)} style={{width: `${props.perc}%`}} />\n    </div>\n  )\n}\n\ninterface SortIconProps {\n  activeDirection: SortDirection | null\n}\n\nfunction SortIcon(props: SortIconProps) {\n  const theme = useTheme()\n  const style = getStyle(theme)\n\n  const {activeDirection} = props\n  const upFill =\n    activeDirection === SortDirection.ASCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n  const downFill =\n    activeDirection === SortDirection.DESCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n\n  return (\n    <svg\n      width=\"8\"\n      height=\"10\"\n      viewBox=\"0 0 8 10\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={css(style.sortIcon)}\n    >\n      <path d=\"M0 4L4 0L8 4H0Z\" fill={upFill} />\n      <path d=\"M0 4L4 0L8 4H0Z\" transform=\"translate(0 10) scale(1 -1)\" fill={downFill} />\n    </svg>\n  )\n}\n\ninterface ProfileTableRowViewProps {\n  frame: Frame\n  matchedRanges: [number, number][] | null\n  index: number\n  profile: Profile\n  selectedFrame: Frame | null\n  setSelectedFrame: (f: Frame) => void\n  getCSSColorForFrame: (frame: Frame) => string\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nconst ProfileTableRowView = ({\n  frame,\n  matchedRanges,\n  profile,\n  index,\n  selectedFrame,\n  setSelectedFrame,\n  getCSSColorForFrame,\n}: ProfileTableRowViewProps) => {\n  const style = getStyle(useTheme())\n\n  const totalWeight = frame.getTotalWeight()\n  const selfWeight = frame.getSelfWeight()\n  const totalPerc = (100.0 * totalWeight) / profile.getTotalNonIdleWeight()\n  const selfPerc = (100.0 * selfWeight) / profile.getTotalNonIdleWeight()\n\n  const selected = frame === selectedFrame\n\n  // We intentionally use index rather than frame.key here as the tr key\n  // in order to re-use rows when sorting rather than creating all new elements.\n  return (\n    <tr\n      key={`${index}`}\n      onClick={setSelectedFrame.bind(null, frame)}\n      className={css(\n        style.tableRow,\n        index % 2 == 0 && style.tableRowEven,\n        selected && style.tableRowSelected,\n      )}\n    >\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(totalWeight)} ({formatPercent(totalPerc)})\n        <HBarDisplay perc={totalPerc} />\n      </td>\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(selfWeight)} ({formatPercent(selfPerc)})\n        <HBarDisplay perc={selfPerc} />\n      </td>\n      <td title={frame.file} className={css(style.textCell)}>\n        <ColorChit color={getCSSColorForFrame(frame)} />\n        {matchedRanges\n          ? highlightRanges(\n              frame.name,\n              matchedRanges,\n              css(style.matched, selected && style.matchedSelected),\n            )\n          : frame.name}\n      </td>\n    </tr>\n  )\n}\n\ninterface ProfileTableViewProps {\n  profile: Profile\n  selectedFrame: Frame | null\n  getCSSColorForFrame: (frame: Frame) => string\n  sortMethod: SortMethod\n  setSelectedFrame: (frame: Frame | null) => void\n  setSortMethod: (sortMethod: SortMethod) => void\n  searchQuery: string\n  searchIsActive: boolean\n}\n\nexport const ProfileTableView = memo(\n  ({\n    profile,\n    sortMethod,\n    setSortMethod,\n    selectedFrame,\n    setSelectedFrame,\n    getCSSColorForFrame,\n    searchQuery,\n    searchIsActive,\n  }: ProfileTableViewProps) => {\n    const style = getStyle(useTheme())\n\n    const onSortClick = useCallback(\n      (field: SortField, ev: MouseEvent) => {\n        ev.preventDefault()\n\n        if (sortMethod.field == field) {\n          // Toggle\n          setSortMethod({\n            field,\n            direction:\n              sortMethod.direction === SortDirection.ASCENDING\n                ? SortDirection.DESCENDING\n                : SortDirection.ASCENDING,\n          })\n        } else {\n          // Set a sane default\n          switch (field) {\n            case SortField.SYMBOL_NAME: {\n              setSortMethod({field, direction: SortDirection.ASCENDING})\n              break\n            }\n            case SortField.SELF: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n            case SortField.TOTAL: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n          }\n        }\n      },\n      [sortMethod, setSortMethod],\n    )\n\n    const sandwichContext = useContext(SandwichViewContext)\n\n    const renderItems = useCallback(\n      (firstIndex: number, lastIndex: number) => {\n        if (!sandwichContext) return null\n\n        const rows: JSX.Element[] = []\n\n        for (let i = firstIndex; i <= lastIndex; i++) {\n          const frame = sandwichContext.rowList[i]\n          const match = sandwichContext.getSearchMatchForFrame(frame)\n\n          rows.push(\n            ProfileTableRowView({\n              frame,\n              matchedRanges: match == null ? null : match,\n              index: i,\n              profile: profile,\n              selectedFrame: selectedFrame,\n              setSelectedFrame: setSelectedFrame,\n              getCSSColorForFrame: getCSSColorForFrame,\n            }),\n          )\n        }\n\n        if (rows.length === 0) {\n          if (searchIsActive) {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>\n                  No symbol names match query \"{searchQuery}\".\n                </td>\n              </tr>,\n            )\n          } else {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>No symbols found.</td>\n              </tr>,\n            )\n          }\n        }\n\n        return <table className={css(style.tableView)}>{rows}</table>\n      },\n      [\n        sandwichContext,\n        profile,\n        selectedFrame,\n        setSelectedFrame,\n        getCSSColorForFrame,\n        searchIsActive,\n        searchQuery,\n        style.emptyState,\n        style.tableView,\n      ],\n    )\n\n    const listItems: ListItem[] = useMemo(\n      () =>\n        sandwichContext == null\n          ? []\n          : sandwichContext.rowList.map(f => ({size: Sizes.FRAME_HEIGHT})),\n      [sandwichContext],\n    )\n\n    const onTotalClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.TOTAL, ev),\n      [onSortClick],\n    )\n    const onSelfClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.SELF, ev),\n      [onSortClick],\n    )\n    const onSymbolNameClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.SYMBOL_NAME, ev),\n      [onSortClick],\n    )\n\n    return (\n      <div className={css(commonStyle.vbox, style.profileTableView)}>\n        <table className={css(style.tableView)}>\n          <thead className={css(style.tableHeader)}>\n            <tr>\n              <th className={css(style.numericCell)} onClick={onTotalClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.TOTAL ? sortMethod.direction : null\n                  }\n                />\n                Total\n              </th>\n              <th className={css(style.numericCell)} onClick={onSelfClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SELF ? sortMethod.direction : null\n                  }\n                />\n                Self\n              </th>\n              <th className={css(style.textCell)} onClick={onSymbolNameClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SYMBOL_NAME ? sortMethod.direction : null\n                  }\n                />\n                Symbol Name\n              </th>\n            </tr>\n          </thead>\n        </table>\n        <ScrollableListView\n          axis={'y'}\n          items={listItems}\n          className={css(style.scrollView)}\n          renderItems={renderItems}\n          initialIndexInView={\n            selectedFrame == null ? null : sandwichContext?.getIndexForFrame(selectedFrame)\n          }\n        />\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    profileTableView: {\n      background: theme.bgPrimaryColor,\n      height: '100%',\n    },\n    scrollView: {\n      overflowY: 'auto',\n      overflowX: 'hidden',\n      flexGrow: 1,\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    tableView: {\n      width: '100%',\n      fontSize: FontSize.LABEL,\n      background: theme.bgPrimaryColor,\n    },\n    tableHeader: {\n      borderBottom: `2px solid ${theme.bgSecondaryColor}`,\n      textAlign: 'left',\n      color: theme.fgPrimaryColor,\n      userSelect: 'none',\n    },\n    sortIcon: {\n      position: 'relative',\n      top: 1,\n      marginRight: Sizes.FRAME_HEIGHT / 4,\n    },\n    tableRow: {\n      background: theme.bgPrimaryColor,\n      height: Sizes.FRAME_HEIGHT,\n    },\n    tableRowEven: {\n      background: theme.bgSecondaryColor,\n    },\n    tableRowSelected: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    numericCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      position: 'relative',\n      textAlign: 'right',\n      paddingRight: Sizes.FRAME_HEIGHT,\n      width: 6 * Sizes.FRAME_HEIGHT,\n      minWidth: 6 * Sizes.FRAME_HEIGHT,\n    },\n    textCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      width: '100%',\n      maxWidth: 0,\n    },\n    hBarDisplay: {\n      position: 'absolute',\n      background: Color.fromCSSHex(theme.weightColor).withAlpha(0.2).toCSS(),\n      bottom: 2,\n      height: 2,\n      width: `calc(100% - ${2 * Sizes.FRAME_HEIGHT}px)`,\n      right: Sizes.FRAME_HEIGHT,\n    },\n    hBarDisplayFilled: {\n      height: '100%',\n      position: 'absolute',\n      background: theme.weightColor,\n      right: 0,\n    },\n    matched: {\n      borderBottom: `2px solid ${theme.fgPrimaryColor}`,\n    },\n    matchedSelected: {\n      borderColor: theme.altFgPrimaryColor,\n    },\n    emptyState: {\n      textAlign: 'center',\n      fontWeight: 'bold',\n    },\n  }),\n)\n\ninterface ProfileTableViewContainerProps {\n  activeProfileState: ActiveProfileState\n}\n\nexport const ProfileTableViewContainer = memo((ownProps: ProfileTableViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  const {profile, sandwichViewState} = activeProfileState\n  if (!profile) throw new Error('profile missing')\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const theme = useTheme()\n  const {callerCallee} = sandwichViewState\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  return (\n    <ProfileTableView\n      profile={profile}\n      selectedFrame={selectedFrame}\n      getCSSColorForFrame={getCSSColorForFrame}\n      sortMethod={tableSortMethod}\n      setSelectedFrame={setSelectedFrame}\n      setSortMethod={tableSortMethodAtom.set}\n      searchIsActive={searchIsActive}\n      searchQuery={searchQuery}\n    />\n  )\n})\n","import {Frame, CallTreeNode} from './profile'\n\nimport {lastOf} from './utils'\nimport {clamp, Rect, Vec2} from './math'\n\nexport interface FlamechartFrame {\n  node: CallTreeNode\n  start: number\n  end: number\n  parent: FlamechartFrame | null\n  children: FlamechartFrame[]\n}\n\ntype StackLayer = FlamechartFrame[]\n\ninterface FlamechartDataSource {\n  getTotalWeight(): number\n\n  formatValue(v: number): string\n\n  forEachCall(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ): void\n\n  getColorBucketForFrame(f: Frame): number\n}\n\nexport class Flamechart {\n  // Bottom to top\n  private layers: StackLayer[] = []\n  private totalWeight: number = 0\n  private minFrameWidth: number = 1\n\n  getTotalWeight() {\n    return this.totalWeight\n  }\n  getLayers() {\n    return this.layers\n  }\n  getColorBucketForFrame(frame: Frame) {\n    return this.source.getColorBucketForFrame(frame)\n  }\n  getMinFrameWidth() {\n    return this.minFrameWidth\n  }\n  formatValue(v: number) {\n    return this.source.formatValue(v)\n  }\n\n  getClampedViewportWidth(viewportWidth: number) {\n    const maxWidth = this.getTotalWeight()\n\n    // In order to avoid floating point error, we cap the maximum zoom. In\n    // particular, it's important that at the maximum zoom level, the total\n    // trace size + a viewport width is not equal to the trace size due to\n    // floating point rounding.\n    //\n    // For instance, if the profile's total weight is 2^60, and the viewport\n    // size is 1, trying to move one viewport width right will result in no\n    // change because 2^60 + 1 = 2^60 in floating point arithmetic. JavaScript\n    // numbers are 64 bit floats, and therefore have 53 mantissa bits. You can\n    // see this for yourself in the console. Try:\n    //\n    //   > Math.pow(2, 60) + 1 === Math.pow(2, 60)\n    //   true\n    //   > Math.pow(2, 53) + 1 === Math.pow(2, 53)\n    //   true\n    //   > Math.pow(2, 52) + 1 === Math.pow(2, 52)\n    //   false\n    //\n    // We use 2^40 as a cap instead, since we want to be able to make small\n    // adjustments within a viewport width.\n    //\n    // For reference, this will still allow you to zoom until 1 nanosecond fills\n    // the screen in a profile with a duration of over 18 minutes.\n    //\n    //   > Math.pow(2, 40) / (60 * Math.pow(10, 9))\n    //   18.325193796266667\n    //\n    const maxZoom = Math.pow(2, 40)\n\n    // In addition to capping zoom to avoid floating point error, we further cap\n    // zoom to avoid letting you zoom in so that the smallest element more than\n    // fills the screen, since that probably isn't useful. The final zoom cap is\n    // determined by the minimum zoom of either 2^40x zoom or the necessary zoom\n    // for the smallest frame to fill the screen three times.\n    const minWidth = clamp(3 * this.getMinFrameWidth(), maxWidth / maxZoom, maxWidth)\n\n    return clamp(viewportWidth, minWidth, maxWidth)\n  }\n\n  // Given a desired config-space viewport rectangle, clamp the rectangle so\n  // that it fits within the given flamechart. This prevents the viewport from\n  // extending past the bounds of the flamechart or zooming in too far.\n  getClampedConfigSpaceViewportRect({\n    configSpaceViewportRect,\n    renderInverted,\n  }: {\n    configSpaceViewportRect: Rect\n    renderInverted?: boolean\n  }) {\n    const configSpaceSize = new Vec2(this.getTotalWeight(), this.getLayers().length)\n    const width = this.getClampedViewportWidth(configSpaceViewportRect.size.x)\n    const size = configSpaceViewportRect.size.withX(width)\n    const origin = Vec2.clamp(\n      configSpaceViewportRect.origin,\n      new Vec2(0, renderInverted ? 0 : -1),\n      Vec2.max(Vec2.zero, configSpaceSize.minus(size).plus(new Vec2(0, 1))),\n    )\n    return new Rect(origin, configSpaceViewportRect.size.withX(width))\n  }\n\n  constructor(private source: FlamechartDataSource) {\n    const stack: FlamechartFrame[] = []\n    const openFrame = (node: CallTreeNode, value: number) => {\n      const parent = lastOf(stack)\n      const frame: FlamechartFrame = {\n        node,\n        parent,\n        children: [],\n        start: value,\n        end: value,\n      }\n      if (parent) {\n        parent.children.push(frame)\n      }\n      stack.push(frame)\n    }\n\n    this.minFrameWidth = Infinity\n    const closeFrame = (node: CallTreeNode, value: number) => {\n      console.assert(stack.length > 0)\n      const stackTop = stack.pop()!\n      stackTop.end = value\n      if (stackTop.end - stackTop.start === 0) return\n      const layerIndex = stack.length\n      while (this.layers.length <= layerIndex) this.layers.push([])\n      this.layers[layerIndex].push(stackTop)\n      this.minFrameWidth = Math.min(this.minFrameWidth, stackTop.end - stackTop.start)\n    }\n\n    this.totalWeight = source.getTotalWeight()\n    source.forEachCall(openFrame, closeFrame)\n\n    if (!isFinite(this.minFrameWidth)) this.minFrameWidth = 1\n  }\n}\n","import {Flamechart} from '../lib/flamechart'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {KeyedSet} from '../lib/utils'\nimport {RowAtlas} from './row-atlas'\nimport {Graphics} from './graphics'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {renderInto} from './utils'\n\nconst MAX_BATCH_SIZE = 10000\n\ninterface RangeTreeNode {\n  getBounds(): Rect\n  getRectCount(): number\n  getChildren(): RangeTreeNode[]\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void): void\n}\n\nclass RangeTreeLeafNode implements RangeTreeNode {\n  private children: RangeTreeNode[] = []\n\n  constructor(\n    private batch: RectangleBatch,\n    private bounds: Rect,\n    private numPrecedingRectanglesInRow: number,\n  ) {}\n\n  getBatch() {\n    return this.batch\n  }\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.batch.getRectCount()\n  }\n  getChildren() {\n    return this.children\n  }\n  getParity() {\n    return this.numPrecedingRectanglesInRow % 2\n  }\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    cb(this)\n  }\n}\n\nclass RangeTreeInteriorNode implements RangeTreeNode {\n  private rectCount: number = 0\n  private bounds: Rect\n  constructor(private children: RangeTreeNode[]) {\n    if (children.length === 0) {\n      throw new Error('Empty interior node')\n    }\n    let minLeft = Infinity\n    let maxRight = -Infinity\n    let minTop = Infinity\n    let maxBottom = -Infinity\n    for (let child of children) {\n      this.rectCount += child.getRectCount()\n      const bounds = child.getBounds()\n      minLeft = Math.min(minLeft, bounds.left())\n      maxRight = Math.max(maxRight, bounds.right())\n      minTop = Math.min(minTop, bounds.top())\n      maxBottom = Math.max(maxBottom, bounds.bottom())\n    }\n    this.bounds = new Rect(\n      new Vec2(minLeft, minTop),\n      new Vec2(maxRight - minLeft, maxBottom - minTop),\n    )\n  }\n\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.rectCount\n  }\n  getChildren() {\n    return this.children\n  }\n\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    for (let child of this.children) {\n      child.forEachLeafNodeWithinBounds(configSpaceBounds, cb)\n    }\n  }\n}\n\nexport interface FlamechartRendererProps {\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n  renderOutlines: boolean\n}\n\ninterface FlamechartRowAtlasKeyInfo {\n  stackDepth: number\n  zoomLevel: number\n  index: number\n}\n\nexport class FlamechartRowAtlasKey {\n  readonly stackDepth: number\n  readonly zoomLevel: number\n  readonly index: number\n\n  get key() {\n    return `${this.stackDepth}_${this.index}_${this.zoomLevel}`\n  }\n  private constructor(options: FlamechartRowAtlasKeyInfo) {\n    this.stackDepth = options.stackDepth\n    this.zoomLevel = options.zoomLevel\n    this.index = options.index\n  }\n  static getOrInsert(set: KeyedSet<FlamechartRowAtlasKey>, info: FlamechartRowAtlasKeyInfo) {\n    return set.getOrInsert(new FlamechartRowAtlasKey(info))\n  }\n}\n\nexport interface FlamechartRendererOptions {\n  inverted: boolean\n}\n\nexport class FlamechartRenderer {\n  private layers: RangeTreeNode[] = []\n\n  constructor(\n    private gl: Graphics.Context,\n    private rowAtlas: RowAtlas<FlamechartRowAtlasKey>,\n    private flamechart: Flamechart,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private colorPassRenderer: FlamechartColorPassRenderer,\n    private options: FlamechartRendererOptions = {inverted: false},\n  ) {\n    const nLayers = flamechart.getLayers().length\n    for (let stackDepth = 0; stackDepth < nLayers; stackDepth++) {\n      const leafNodes: RangeTreeLeafNode[] = []\n      const y = options.inverted ? nLayers - 1 - stackDepth : stackDepth\n\n      let minLeft = Infinity\n      let maxRight = -Infinity\n      let batch = new RectangleBatch(this.gl)\n\n      let rectCount = 0\n\n      const layer = flamechart.getLayers()[stackDepth]\n\n      for (let i = 0; i < layer.length; i++) {\n        const frame = layer[i]\n        if (batch.getRectCount() >= MAX_BATCH_SIZE) {\n          leafNodes.push(\n            new RangeTreeLeafNode(\n              batch,\n              new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n              rectCount,\n            ),\n          )\n          minLeft = Infinity\n          maxRight = -Infinity\n          batch = new RectangleBatch(this.gl)\n        }\n        const configSpaceBounds = new Rect(\n          new Vec2(frame.start, y),\n          new Vec2(frame.end - frame.start, 1),\n        )\n        minLeft = Math.min(minLeft, configSpaceBounds.left())\n        maxRight = Math.max(maxRight, configSpaceBounds.right())\n\n        // We'll use the red channel to indicate the index to allow\n        // us to separate adjacent rectangles within a row from one another,\n        // the green channel to indicate the row,\n        // and the blue channel to indicate the color bucket to render.\n        // We add one to each so we have zero reserved for the background color.\n        const color = new Color(\n          (1 + (i % 255)) / 256,\n          (1 + (stackDepth % 255)) / 256,\n          (1 + this.flamechart.getColorBucketForFrame(frame.node.frame)) / 256,\n        )\n        batch.addRect(configSpaceBounds, color)\n        rectCount++\n      }\n\n      if (batch.getRectCount() > 0) {\n        leafNodes.push(\n          new RangeTreeLeafNode(\n            batch,\n            new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n            rectCount,\n          ),\n        )\n      }\n\n      // TODO(jlfwong): Making this into a binary tree\n      // range than a tree of always-height-two might make this run faster\n      this.layers.push(new RangeTreeInteriorNode(leafNodes))\n    }\n  }\n\n  private rectInfoTexture: Graphics.Texture | null = null\n  getRectInfoTexture(width: number, height: number): Graphics.Texture {\n    if (this.rectInfoTexture) {\n      const texture = this.rectInfoTexture\n      if (texture.width != width || texture.height != height) {\n        texture.resize(width, height)\n      }\n    } else {\n      this.rectInfoTexture = this.gl.createTexture(\n        Graphics.TextureFormat.NEAREST_CLAMP,\n        width,\n        height,\n      )\n    }\n    return this.rectInfoTexture\n  }\n\n  private rectInfoRenderTarget: Graphics.RenderTarget | null = null\n  getRectInfoRenderTarget(width: number, height: number): Graphics.RenderTarget {\n    const texture = this.getRectInfoTexture(width, height)\n    if (this.rectInfoRenderTarget) {\n      if (this.rectInfoRenderTarget.texture != texture) {\n        this.rectInfoRenderTarget.texture.free()\n        this.rectInfoRenderTarget.setColor(texture)\n      }\n    }\n    if (!this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget = this.gl.createRenderTarget(texture)\n    }\n    return this.rectInfoRenderTarget\n  }\n\n  free() {\n    if (this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget.free()\n    }\n    if (this.rectInfoTexture) {\n      this.rectInfoTexture.free()\n    }\n  }\n\n  private atlasKeys = new KeyedSet<FlamechartRowAtlasKey>()\n\n  configSpaceBoundsForKey(key: FlamechartRowAtlasKey): Rect {\n    const {stackDepth, zoomLevel, index} = key\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n\n    const width = configSpaceContentWidth / Math.pow(2, zoomLevel)\n\n    const nLayers = this.flamechart.getLayers().length\n    const y = this.options.inverted ? nLayers - 1 - stackDepth : stackDepth\n    return new Rect(new Vec2(width * index, y), new Vec2(width, 1))\n  }\n\n  render(props: FlamechartRendererProps) {\n    const {configSpaceSrcRect, physicalSpaceDstRect} = props\n\n    const atlasKeysToRender: FlamechartRowAtlasKey[] = []\n\n    // We want to render the lowest resolution we can while still guaranteeing that the\n    // atlas line is higher resolution than its corresponding destination rectangle on\n    // the screen.\n    const configToPhysical = AffineTransform.betweenRects(configSpaceSrcRect, physicalSpaceDstRect)\n    if (configSpaceSrcRect.isEmpty()) {\n      // Prevent an infinite loop\n      return\n    }\n\n    let zoomLevel = 0\n    while (true) {\n      const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n        stackDepth: 0,\n        zoomLevel,\n        index: 0,\n      })\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      const physicalBounds = configToPhysical.transformRect(configSpaceBounds)\n      if (physicalBounds.width() < this.rowAtlas.getResolution()) {\n        break\n      }\n      zoomLevel++\n    }\n\n    const top = Math.max(0, Math.floor(configSpaceSrcRect.top()))\n    const bottom = Math.min(this.layers.length, Math.ceil(configSpaceSrcRect.bottom()))\n\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n    const numAtlasEntriesPerLayer = Math.pow(2, zoomLevel)\n    const left = Math.floor(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.left()) / configSpaceContentWidth,\n    )\n    const right = Math.ceil(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.right()) / configSpaceContentWidth,\n    )\n\n    const nLayers = this.flamechart.getLayers().length\n\n    for (let y = top; y < bottom; y++) {\n      for (let index = left; index <= right; index++) {\n        const stackDepth = this.options.inverted ? nLayers - 1 - y : y\n        const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n          stackDepth,\n          zoomLevel,\n          index,\n        })\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        if (!configSpaceBounds.hasIntersectionWith(configSpaceSrcRect)) continue\n        atlasKeysToRender.push(key)\n      }\n    }\n\n    // TODO(jlfwong): When I switched the GL backend from regl to the port from\n    // evanw/sky, rendering uncached even for massive documents seemed fast\n    // enough. It's possible that the row cache is now unnecessary, but I'll\n    // leave it around for now since it's not causing issues.\n\n    const cacheCapacity = this.rowAtlas.getCapacity()\n    const keysToRenderCached = atlasKeysToRender.slice(0, cacheCapacity)\n    const keysToRenderUncached = atlasKeysToRender.slice(cacheCapacity)\n\n    // Fill the cache\n    this.rowAtlas.writeToAtlasIfNeeded(keysToRenderCached, (textureDstRect, key) => {\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n        this.rectangleBatchRenderer.render({\n          batch: leaf.getBatch(),\n          configSpaceSrcRect: configSpaceBounds,\n          physicalSpaceDstRect: textureDstRect,\n        })\n      })\n    })\n\n    const renderTarget = this.getRectInfoRenderTarget(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    renderInto(this.gl, renderTarget, () => {\n      this.gl.clear(new Graphics.Color(0, 0, 0, 0))\n\n      const viewportRect = new Rect(\n        Vec2.zero,\n        new Vec2(this.gl.viewport.width, this.gl.viewport.height),\n      )\n      const configToViewport = AffineTransform.betweenRects(configSpaceSrcRect, viewportRect)\n\n      // Render from the cache\n      for (let key of keysToRenderCached) {\n        const configSpaceSrcRect = this.configSpaceBoundsForKey(key)\n        this.rowAtlas.renderViaAtlas(key, configToViewport.transformRect(configSpaceSrcRect))\n      }\n\n      // Render entries that didn't make it into the cache\n      for (let key of keysToRenderUncached) {\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        const physicalBounds = configToViewport.transformRect(configSpaceBounds)\n        this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n          this.rectangleBatchRenderer.render({\n            batch: leaf.getBatch(),\n            configSpaceSrcRect: configSpaceBounds,\n            physicalSpaceDstRect: physicalBounds,\n          })\n        })\n      }\n    })\n\n    const rectInfoTexture = this.getRectInfoTexture(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    this.colorPassRenderer.render({\n      rectInfoTexture,\n      srcRect: new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n      dstRect: physicalSpaceDstRect,\n      renderOutlines: props.renderOutlines,\n    })\n  }\n}\n","import {StyleSheet} from 'aphrodite'\nimport {FontSize, Sizes} from './style'\nimport {withTheme} from './themes/theme'\n\nexport const getFlamechartStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n    fill: {\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n    },\n    minimap: {\n      height: Sizes.MINIMAP_HEIGHT,\n      borderBottom: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    panZoomView: {\n      flex: 1,\n    },\n\n    detailView: {\n      display: 'grid',\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      overflow: 'hidden',\n      gridTemplateColumns: '120px 120px 1fr',\n      gridTemplateRows: 'repeat(4, 1fr)',\n      borderTop: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n      fontSize: FontSize.LABEL,\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      width: '100vw',\n      bottom: 0,\n    },\n    stackTraceViewPadding: {\n      padding: 5,\n    },\n    stackTraceView: {\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      lineHeight: `${FontSize.LABEL + 2}px`,\n      overflow: 'auto',\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    stackLine: {\n      whiteSpace: 'nowrap',\n    },\n    stackFileLine: {\n      color: theme.fgSecondaryColor,\n    },\n    statsTable: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 1fr',\n      gridTemplateRows: `repeat(3, ${FontSize.LABEL + 10}px)`,\n      gridGap: '1px 1px',\n      textAlign: 'center',\n      paddingRight: 1,\n    },\n    statsTableHeader: {\n      gridColumn: '1 / 3',\n    },\n    statsTableCell: {\n      position: 'relative',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    thisInstanceCell: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    allInstancesCell: {\n      background: theme.selectionSecondaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    barDisplay: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      background: 'rgba(0, 0, 0, 0.2)',\n      width: '100%',\n    },\n  }),\n)\n","import {findValueBisect} from './utils'\n\nexport const ELLIPSIS = '\\u2026'\n\n// NOTE: This blindly assumes the same result across contexts.\nconst measureTextCache = new Map<string, number>()\n\nlet lastDevicePixelRatio = -1\nexport function cachedMeasureTextWidth(ctx: CanvasRenderingContext2D, text: string): number {\n  if (window.devicePixelRatio !== lastDevicePixelRatio) {\n    // This cache is no longer valid!\n    measureTextCache.clear()\n    lastDevicePixelRatio = window.devicePixelRatio\n  }\n  if (!measureTextCache.has(text)) {\n    measureTextCache.set(text, ctx.measureText(text).width)\n  }\n  return measureTextCache.get(text)!\n}\n\ninterface TrimmedTextResult {\n  trimmedString: string\n  trimmedLength: number\n  prefixLength: number\n  suffixLength: number\n  originalLength: number\n  originalString: string\n}\n\n// Trim text, placing an ellipsis in the middle, with a slight bias towards\n// keeping text from the beginning rather than the end\nexport function buildTrimmedText(text: string, length: number): TrimmedTextResult {\n  if (text.length <= length) {\n    return {\n      trimmedString: text,\n      trimmedLength: text.length,\n      prefixLength: text.length,\n      suffixLength: 0,\n      originalString: text,\n      originalLength: text.length,\n    }\n  }\n\n  let prefixLength = Math.floor(length / 2)\n  const suffixLength = length - prefixLength - 1\n  const prefix = text.substring(0, prefixLength)\n  const suffix = text.substring(text.length - suffixLength, text.length)\n  const trimmedString = prefix + ELLIPSIS + suffix\n  return {\n    trimmedString,\n    trimmedLength: trimmedString.length,\n    prefixLength: prefix.length,\n    suffixLength: suffix.length,\n    originalString: text,\n    originalLength: text.length,\n  }\n}\n\n// Trim text to fit within the given number of pixels on the canvas\nexport function trimTextMid(\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  maxWidth: number,\n): TrimmedTextResult {\n  if (cachedMeasureTextWidth(ctx, text) <= maxWidth) {\n    return buildTrimmedText(text, text.length)\n  }\n  const [lo] = findValueBisect(\n    0,\n    text.length,\n    n => {\n      return cachedMeasureTextWidth(ctx, buildTrimmedText(text, Math.floor(n)).trimmedString)\n    },\n    maxWidth,\n  )\n  return buildTrimmedText(text, Math.floor(lo))\n}\n\nenum IndexTypeInTrimmed {\n  IN_PREFIX,\n  IN_SUFFIX,\n  ELIDED,\n}\n\nfunction getIndexTypeInTrimmed(result: TrimmedTextResult, index: number): IndexTypeInTrimmed {\n  if (index < result.prefixLength) {\n    return IndexTypeInTrimmed.IN_PREFIX\n  } else if (index < result.originalLength - result.suffixLength) {\n    return IndexTypeInTrimmed.ELIDED\n  } else {\n    return IndexTypeInTrimmed.IN_SUFFIX\n  }\n}\n\nexport function remapRangesToTrimmedText(\n  trimmedText: TrimmedTextResult,\n  ranges: [number, number][],\n): [number, number][] {\n  // We intentionally don't just re-run fuzzy matching on the trimmed\n  // text, beacuse if the search query is \"helloWorld\", the frame name\n  // is \"application::helloWorld\", and that gets trimmed down to\n  // \"appl...oWorld\", we still want \"oWorld\" to be highlighted, even\n  // though the string \"appl...oWorld\" is not matched by the query\n  // \"helloWorld\".\n  //\n  // There's a weird case to consider here: what if the trimmedText is\n  // also matched by the query, but results in a different match than\n  // the original query? Consider, e.g. the search string of \"ab\". The\n  // string \"hello ab shabby\" will be matched at the first \"ab\", but\n  // may be trimmed to \"hello...shabby\". In this case, should we\n  // highlight the \"ab\" hidden by the ellipsis, or the \"ab\" in\n  // \"shabby\"? The code below highlights the ellipsis so that the\n  // matched characters don't change as you zoom in and out.\n\n  const rangesToHighlightInTrimmedText: [number, number][] = []\n  const lengthLoss = trimmedText.originalLength - trimmedText.trimmedLength\n  let highlightedEllipsis = false\n\n  for (let [origStart, origEnd] of ranges) {\n    let startPosType = getIndexTypeInTrimmed(trimmedText, origStart)\n    let endPosType = getIndexTypeInTrimmed(trimmedText, origEnd - 1)\n\n    switch (startPosType) {\n      case IndexTypeInTrimmed.IN_PREFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // The entire range fits in the prefix. Add it unmodified.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd])\n            break\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The range starts in the prefix, but ends in the elided\n            // section. Add just the prefix + one char for the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, trimmedText.prefixLength + 1])\n            highlightedEllipsis = true\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The range crosses from the prefix to the suffix.\n            // Highlight everything including the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.ELIDED: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in elided and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The match starts & ends within the elided section.\n            if (!highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.prefixLength,\n                trimmedText.prefixLength + 1,\n              ])\n              highlightedEllipsis = true\n            }\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The match starts in elided, but ends in suffix.\n            if (highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.trimmedLength - trimmedText.suffixLength,\n                origEnd - lengthLoss,\n              ])\n            } else {\n              rangesToHighlightInTrimmedText.push([trimmedText.prefixLength, origEnd - lengthLoss])\n              highlightedEllipsis = true\n            }\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.IN_SUFFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in elided')\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // Match starts & ends in suffix\n            rangesToHighlightInTrimmedText.push([origStart - lengthLoss, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n    }\n  }\n  return rangesToHighlightInTrimmedText\n}\n","import {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {Flamechart} from '../lib/flamechart'\nimport {Rect, Vec2, AffineTransform, clamp} from '../lib/math'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {FontFamily, FontSize, Sizes, commonStyle} from './style'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {cachedMeasureTextWidth} from '../lib/text-utils'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\n\ninterface FlamechartMinimapViewProps {\n  theme: Theme\n\n  flamechart: Flamechart\n  configSpaceViewportRect: Rect\n\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nenum DraggingMode {\n  DRAW_NEW_VIEWPORT,\n  TRANSLATE_VIEWPORT,\n}\n\nexport class FlamechartMinimapView extends Component<FlamechartMinimapViewProps, {}> {\n  container: Element | null = null\n  containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  overlayCanvas: HTMLCanvasElement | null = null\n  overlayCtx: CanvasRenderingContext2D | null = null\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private minimapOrigin() {\n    return new Vec2(0, Sizes.FRAME_HEIGHT * window.devicePixelRatio)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private configSpaceToPhysicalViewSpace() {\n    const minimapOrigin = this.minimapOrigin()\n\n    return AffineTransform.betweenRects(\n      new Rect(new Vec2(0, 0), this.configSpaceSize()),\n      new Rect(minimapOrigin, this.physicalViewSize().minus(minimapOrigin)),\n    )\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private windowToLogicalViewSpace() {\n    if (!this.container) return new AffineTransform()\n    const bounds = this.container.getBoundingClientRect()\n    return AffineTransform.withTranslation(new Vec2(-bounds.left, -bounds.top))\n  }\n\n  private renderRects() {\n    if (!this.container) return\n\n    // Hasn't resized yet -- no point in rendering yet\n    if (this.physicalViewSize().x < 2) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        configSpaceSrcRect: new Rect(new Vec2(0, 0), this.configSpaceSize()),\n        physicalSpaceDstRect: new Rect(\n          this.minimapOrigin(),\n          this.physicalViewSize().minus(this.minimapOrigin()),\n        ),\n        renderOutlines: false,\n      })\n\n      this.props.canvasContext.viewportRectangleRenderer.render({\n        configSpaceViewportRect: this.props.configSpaceViewportRect,\n        configSpaceToPhysicalViewSpace: this.configSpaceToPhysicalViewSpace(),\n      })\n    })\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    const physicalViewSize = this.physicalViewSize()\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const left = 0\n    const right = this.configSpaceSize().x\n\n    // TODO(jlfwong): There's a huge amount of code duplication here between\n    // this and the FlamechartView.renderOverlays(). Consolidate.\n\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n\n    const physicalViewSpaceFrameHeight = Sizes.FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'top'\n\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, 0, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = Math.ceil(cachedMeasureTextWidth(ctx, labelText))\n\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  onWindowResize = () => {\n    this.onBeforeFrame()\n  }\n\n  componentWillReceiveProps(nextProps: FlamechartMinimapViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect != nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private onBeforeFrame = () => {\n    this.maybeClearInteractionLock()\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(multiplier: number) {\n    this.interactionLock = 'zoom'\n    const configSpaceViewport = this.props.configSpaceViewportRect\n    const configSpaceCenter = configSpaceViewport.origin.plus(configSpaceViewport.size.times(1 / 2))\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + ev.deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + ev.deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(ev.deltaX, ev.deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  private configSpaceMouse(ev: MouseEvent): Vec2 | null {\n    const logicalSpaceMouse = this.windowToLogicalViewSpace().transformPosition(\n      new Vec2(ev.clientX, ev.clientY),\n    )\n    const physicalSpaceMouse =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalSpaceMouse)\n    return this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalSpaceMouse)\n  }\n\n  private dragStartConfigSpaceMouse: Vec2 | null = null\n  private dragConfigSpaceViewportOffset: Vec2 | null = null\n  private draggingMode: DraggingMode | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (configSpaceMouse) {\n      if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n        // If dragging starting inside the viewport rectangle,\n        // we'll move the existing viewport\n        this.draggingMode = DraggingMode.TRANSLATE_VIEWPORT\n        this.dragConfigSpaceViewportOffset = configSpaceMouse.minus(\n          this.props.configSpaceViewportRect.origin,\n        )\n      } else {\n        // If dragging starts outside the the viewport rectangle,\n        // we'll start drawing a new viewport\n        this.draggingMode = DraggingMode.DRAW_NEW_VIEWPORT\n      }\n\n      this.dragStartConfigSpaceMouse = configSpaceMouse\n      window.addEventListener('mousemove', this.onWindowMouseMove)\n      window.addEventListener('mouseup', this.onWindowMouseUp)\n      this.updateCursor(configSpaceMouse)\n    }\n  }\n\n  private onWindowMouseMove = (ev: MouseEvent) => {\n    if (!this.dragStartConfigSpaceMouse) return\n    let configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n\n    // Clamp the mouse position to avoid weird behavior when outside the canvas bounds\n    configSpaceMouse = new Rect(new Vec2(0, 0), this.configSpaceSize()).closestPointTo(\n      configSpaceMouse,\n    )\n\n    if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      const configStart = this.dragStartConfigSpaceMouse\n      let configEnd = configSpaceMouse\n\n      if (!configStart || !configEnd) return\n      const left = Math.min(configStart.x, configEnd.x)\n      const right = Math.max(configStart.x, configEnd.x)\n\n      const width = right - left\n      const height = this.props.configSpaceViewportRect.height()\n\n      this.props.setConfigSpaceViewportRect(\n        new Rect(new Vec2(left, configEnd.y - height / 2), new Vec2(width, height)),\n      )\n    } else if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      if (!this.dragConfigSpaceViewportOffset) return\n\n      const newOrigin = configSpaceMouse.minus(this.dragConfigSpaceViewportOffset)\n      this.props.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withOrigin(newOrigin),\n      )\n    }\n  }\n\n  private updateCursor = (configSpaceMouse: Vec2) => {\n    if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      document.body.style.cursor = 'col-resize'\n    } else if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n      document.body.style.cursor = 'grab'\n      document.body.style.cursor = '-webkit-grab'\n    } else {\n      document.body.style.cursor = 'col-resize'\n    }\n  }\n\n  private onMouseLeave = () => {\n    if (this.draggingMode == null) {\n      document.body.style.cursor = 'default'\n    }\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.draggingMode = null\n    window.removeEventListener('mousemove', this.onWindowMouseMove)\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        ref={this.containerRef}\n        onWheel={this.onWheel}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        className={css(style.minimap, commonStyle.vbox)}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n","import {StyleDeclarationValue, css} from 'aphrodite'\nimport {h, JSX} from 'preact'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {formatPercent} from '../lib/utils'\nimport {Frame, CallTreeNode} from '../lib/profile'\nimport {ColorChit} from './color-chit'\nimport {Flamechart} from '../lib/flamechart'\nimport {useTheme} from './themes/theme'\n\ninterface StatisticsTableProps {\n  title: string\n  grandTotal: number\n  selectedTotal: number\n  selectedSelf: number\n  cellStyle: StyleDeclarationValue\n  formatter: (v: number) => string\n}\n\nfunction StatisticsTable(props: StatisticsTableProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const total = props.formatter(props.selectedTotal)\n  const self = props.formatter(props.selectedSelf)\n  const totalPerc = (100.0 * props.selectedTotal) / props.grandTotal\n  const selfPerc = (100.0 * props.selectedSelf) / props.grandTotal\n\n  return (\n    <div className={css(style.statsTable)}>\n      <div className={css(props.cellStyle, style.statsTableCell, style.statsTableHeader)}>\n        {props.title}\n      </div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>Total</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>Self</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>{total}</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>{self}</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(totalPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${totalPerc}%`}} />\n      </div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(selfPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${selfPerc}%`}} />\n      </div>\n    </div>\n  )\n}\n\ninterface StackTraceViewProps {\n  getFrameColor: (frame: Frame) => string\n  node: CallTreeNode\n}\nfunction StackTraceView(props: StackTraceViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const rows: JSX.Element[] = []\n  let node: CallTreeNode | null = props.node\n  for (; node && !node.isRoot(); node = node.parent) {\n    const row: (JSX.Element | string)[] = []\n    const {frame} = node\n\n    row.push(<ColorChit color={props.getFrameColor(frame)} />)\n\n    if (rows.length) {\n      row.push(<span className={css(style.stackFileLine)}>&gt; </span>)\n    }\n    row.push(frame.name)\n\n    if (frame.file) {\n      let pos = frame.file\n      if (frame.line != null) {\n        pos += `:${frame.line}`\n        if (frame.col != null) {\n          pos += `:${frame.col}`\n        }\n      }\n      row.push(<span className={css(style.stackFileLine)}> ({pos})</span>)\n    }\n    rows.push(<div className={css(style.stackLine)}>{row}</div>)\n  }\n  return (\n    <div className={css(style.stackTraceView)}>\n      <div className={css(style.stackTraceViewPadding)}>{rows}</div>\n    </div>\n  )\n}\n\ninterface FlamechartDetailViewProps {\n  flamechart: Flamechart\n  getCSSColorForFrame: (frame: Frame) => string\n  selectedNode: CallTreeNode\n}\n\nexport function FlamechartDetailView(props: FlamechartDetailViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const {flamechart, selectedNode} = props\n  const {frame} = selectedNode\n\n  return (\n    <div className={css(style.detailView)}>\n      <StatisticsTable\n        title={'This Instance'}\n        cellStyle={style.thisInstanceCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={selectedNode.getTotalWeight()}\n        selectedSelf={selectedNode.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StatisticsTable\n        title={'All Instances'}\n        cellStyle={style.allInstancesCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={frame.getTotalWeight()}\n        selectedSelf={frame.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StackTraceView node={selectedNode} getFrameColor={props.getCSSColorForFrame} />\n    </div>\n  )\n}\n","// This file contains a collection of classes which make it easier to perform\n// batch rendering of Canvas2D primitives. The advantage of this over just doing\n// ctx.beginPath() ... ctx.rect(...) ... ctx.endPath() is that you can construct\n// several different batch renderers are the same time, then decide on their\n// paint order at the end.\n//\n// See FlamechartPanZoomView.renderOverlays for an example of how this is used.\n\nexport interface TextArgs {\n  text: string\n  x: number\n  y: number\n}\n\nexport class BatchCanvasTextRenderer {\n  private argsBatch: TextArgs[] = []\n\n  text(args: TextArgs) {\n    this.argsBatch.push(args)\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    for (let args of this.argsBatch) {\n      ctx.fillText(args.text, args.x, args.y)\n    }\n    this.argsBatch = []\n  }\n}\n\nexport interface RectArgs {\n  x: number\n  y: number\n  w: number\n  h: number\n}\n\nexport class BatchCanvasRectRenderer {\n  private argsBatch: RectArgs[] = []\n\n  rect(args: RectArgs) {\n    this.argsBatch.push(args)\n  }\n\n  private drawPath(ctx: CanvasRenderingContext2D) {\n    ctx.beginPath()\n    for (let args of this.argsBatch) {\n      ctx.rect(args.x, args.y, args.w, args.h)\n    }\n    ctx.closePath()\n    this.argsBatch = []\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    this.drawPath(ctx)\n    ctx.fill()\n  }\n\n  stroke(ctx: CanvasRenderingContext2D, color: string, lineWidth: number) {\n    if (this.argsBatch.length === 0) return\n    ctx.strokeStyle = color\n    ctx.lineWidth = lineWidth\n    this.drawPath(ctx)\n    ctx.stroke()\n  }\n}\n","import {Rect, AffineTransform, Vec2, clamp} from '../lib/math'\nimport {CallTreeNode} from '../lib/profile'\nimport {Flamechart, FlamechartFrame} from '../lib/flamechart'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {Sizes, FontSize, FontFamily, commonStyle} from './style'\nimport {\n  cachedMeasureTextWidth,\n  ELLIPSIS,\n  trimTextMid,\n  remapRangesToTrimmedText,\n} from '../lib/text-utils'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {BatchCanvasTextRenderer, BatchCanvasRectRenderer} from '../lib/canvas-2d-batch-renderers'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\n\ninterface FlamechartFrameLabel {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\n/**\n * Component to visualize a Flamechart and interact with it via hovering,\n * zooming, and panning.\n *\n * There are 3 vector spaces involved:\n * - Configuration Space: In this space, the horizontal unit is ms, and the\n *   vertical unit is stack depth. Each stack frame is one unit high.\n * - Logical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in CSS: horizontal and vertical\n *   units are both \"logical\" pixels.\n * - Physical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in hardware pixels: horizontal\n *   and vertical units are both \"physical\" pixels.\n *\n * We use two canvases to draw the flamechart itself: one for the rectangles,\n * which we render via WebGL, and one for the labels, which we render via 2D\n * canvas primitives.\n */\nexport interface FlamechartPanZoomViewProps {\n  flamechart: Flamechart\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  selectedNode: CallTreeNode | null\n  theme: Theme\n\n  onNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  onNodeSelect: (node: CallTreeNode | null) => void\n\n  configSpaceViewportRect: Rect\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n\n  logicalSpaceViewportSize: Vec2\n  setLogicalSpaceViewportSize: (size: Vec2) => void\n\n  searchResults: ProfileSearchResults | null\n}\n\nexport class FlamechartPanZoomView extends Component<FlamechartPanZoomViewProps, {}> {\n  private container: Element | null = null\n  private containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  private overlayCanvas: HTMLCanvasElement | null = null\n  private overlayCtx: CanvasRenderingContext2D | null = null\n\n  private hoveredLabel: FlamechartFrameLabel | null = null\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private setConfigSpaceViewportRect(r: Rect) {\n    this.props.setConfigSpaceViewportRect(r)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private physicalBounds(): Rect {\n    if (this.props.renderInverted) {\n      // If we're rendering inverted and the flamegraph won't fill the viewport,\n      // we want to stick the flamegraph to the bottom of the viewport, not the top.\n\n      const physicalViewportHeight = this.physicalViewSize().y\n      const physicalFlamegraphHeight =\n        (this.configSpaceSize().y + 1) *\n        this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT *\n        window.devicePixelRatio\n\n      if (physicalFlamegraphHeight < physicalViewportHeight) {\n        return new Rect(\n          new Vec2(0, physicalViewportHeight - physicalFlamegraphHeight),\n          this.physicalViewSize(),\n        )\n      }\n    }\n\n    return new Rect(new Vec2(0, 0), this.physicalViewSize())\n  }\n\n  private LOGICAL_VIEW_SPACE_FRAME_HEIGHT = Sizes.FRAME_HEIGHT\n\n  private configSpaceToPhysicalViewSpace() {\n    return AffineTransform.betweenRects(this.props.configSpaceViewportRect, this.physicalBounds())\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n\n    const physicalViewSize = this.physicalViewSize()\n\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'alphabetic'\n\n    const minWidthToRender = cachedMeasureTextWidth(ctx, 'M' + ELLIPSIS + 'M')\n    const minConfigSpaceWidthToRender = (\n      configToPhysical.inverseTransformVector(new Vec2(minWidthToRender, 0)) || new Vec2(0, 0)\n    ).x\n\n    const LABEL_PADDING_PX = 5 * window.devicePixelRatio\n\n    const labelBatch = new BatchCanvasTextRenderer()\n    const fadedLabelBatch = new BatchCanvasTextRenderer()\n    const matchedTextHighlightBatch = new BatchCanvasRectRenderer()\n    const directlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const indirectlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const matchedFrameBatch = new BatchCanvasRectRenderer()\n\n    const renderFrameLabelAndChildren = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRender) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n\n      if (this.props.renderInverted) {\n        if (configSpaceBounds.bottom() < this.props.configSpaceViewportRect.top()) return\n      } else {\n        if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n      }\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        let physicalLabelBounds = configToPhysical.transformRect(configSpaceBounds)\n\n        if (physicalLabelBounds.left() < 0) {\n          physicalLabelBounds = physicalLabelBounds\n            .withOrigin(physicalLabelBounds.origin.withX(0))\n            .withSize(\n              physicalLabelBounds.size.withX(\n                physicalLabelBounds.size.x + physicalLabelBounds.left(),\n              ),\n            )\n        }\n        if (physicalLabelBounds.right() > physicalViewSize.x) {\n          physicalLabelBounds = physicalLabelBounds.withSize(\n            physicalLabelBounds.size.withX(physicalViewSize.x - physicalLabelBounds.left()),\n          )\n        }\n\n        if (physicalLabelBounds.width() > minWidthToRender) {\n          const match = this.props.searchResults?.getMatchForFrame(frame.node.frame)\n\n          const trimmedText = trimTextMid(\n            ctx,\n            frame.node.frame.name,\n            physicalLabelBounds.width() - 2 * LABEL_PADDING_PX,\n          )\n\n          if (match) {\n            const rangesToHighlightInTrimmedText = remapRangesToTrimmedText(trimmedText, match)\n\n            // Once we have the character ranges to highlight, we need to\n            // actually do the highlighting.\n            let lastEndIndex = 0\n            let left = physicalLabelBounds.left() + LABEL_PADDING_PX\n\n            const padding = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2 - 2\n            for (let [startIndex, endIndex] of rangesToHighlightInTrimmedText) {\n              left += cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(lastEndIndex, startIndex),\n              )\n              const highlightWidth = cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(startIndex, endIndex),\n              )\n              matchedTextHighlightBatch.rect({\n                x: left,\n                y: physicalLabelBounds.top() + padding,\n                w: highlightWidth,\n                h: physicalViewSpaceFrameHeight - 2 * padding,\n              })\n\n              left += highlightWidth\n              lastEndIndex = endIndex\n            }\n          }\n\n          const batch = this.props.searchResults != null && !match ? fadedLabelBatch : labelBatch\n          batch.text({\n            text: trimmedText.trimmedString,\n\n            // This is specifying the position of the starting text baseline.\n            x: physicalLabelBounds.left() + LABEL_PADDING_PX,\n            y: Math.round(\n              physicalLabelBounds.bottom() -\n                (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2,\n            ),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderFrameLabelAndChildren(child, depth + 1)\n      }\n    }\n\n    const frameOutlineWidth = 2 * window.devicePixelRatio\n    ctx.strokeStyle = this.props.theme.selectionSecondaryColor\n    const minConfigSpaceWidthToRenderOutline = (\n      configToPhysical.inverseTransformVector(new Vec2(1, 0)) || new Vec2(0, 0)\n    ).x\n\n    const renderSpecialFrameOutlines = (frame: FlamechartFrame, depth = 0) => {\n      if (!this.props.selectedNode && this.props.searchResults == null) return\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRenderOutline) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n      if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        if (this.props.searchResults?.getMatchForFrame(frame.node.frame)) {\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          matchedFrameBatch.rect({\n            x: Math.round(physicalRectBounds.left() + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - frameOutlineWidth)),\n          })\n        }\n\n        if (this.props.selectedNode != null && frame.node.frame === this.props.selectedNode.frame) {\n          let batch =\n            frame.node === this.props.selectedNode\n              ? directlySelectedOutlineBatch\n              : indirectlySelectedOutlineBatch\n\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          batch.rect({\n            x: Math.round(physicalRectBounds.left() + 1 + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + 1 + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - 2 - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - 2 - frameOutlineWidth)),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderSpecialFrameOutlines(child, depth + 1)\n      }\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderSpecialFrameOutlines(frame)\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderFrameLabelAndChildren(frame)\n    }\n\n    const theme = this.props.theme\n\n    matchedFrameBatch.fill(ctx, theme.searchMatchPrimaryColor)\n    matchedTextHighlightBatch.fill(ctx, theme.searchMatchSecondaryColor)\n    fadedLabelBatch.fill(ctx, theme.fgSecondaryColor)\n    labelBatch.fill(\n      ctx,\n      this.props.searchResults != null ? theme.searchMatchTextColor : theme.fgPrimaryColor,\n    )\n    indirectlySelectedOutlineBatch.stroke(ctx, theme.selectionSecondaryColor, frameOutlineWidth)\n    directlySelectedOutlineBatch.stroke(ctx, theme.selectionPrimaryColor, frameOutlineWidth)\n\n    if (this.hoveredLabel) {\n      let color: string = theme.fgPrimaryColor\n      if (this.props.selectedNode === this.hoveredLabel.node) {\n        color = theme.selectionPrimaryColor\n      }\n\n      ctx.lineWidth = 2 * devicePixelRatio\n      ctx.strokeStyle = color\n\n      const physicalViewBounds = configToPhysical.transformRect(this.hoveredLabel.configSpaceBounds)\n      ctx.strokeRect(\n        Math.round(physicalViewBounds.left()),\n        Math.round(physicalViewBounds.top()),\n        Math.round(Math.max(0, physicalViewBounds.width())),\n        Math.round(Math.max(0, physicalViewBounds.height())),\n      )\n    }\n\n    this.renderTimeIndicators()\n  }\n\n  private renderTimeIndicators() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSize = this.physicalViewSize()\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    const left = this.props.configSpaceViewportRect.left()\n    const right = this.props.configSpaceViewportRect.right()\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      const y = this.props.renderInverted ? physicalViewSize.y - physicalViewSpaceFrameHeight : 0\n\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, y, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = cachedMeasureTextWidth(ctx, labelText)\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, y + labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  private updateConfigSpaceViewport() {\n    if (!this.container) return\n    const {logicalSpaceViewportSize} = this.props\n    const bounds = this.container.getBoundingClientRect()\n    const {width, height} = bounds\n\n    // Still initializing: don't resize yet\n    if (width < 2 || height < 2) return\n\n    if (this.props.configSpaceViewportRect.isEmpty()) {\n      const configSpaceViewportHeight = height / this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      if (this.props.renderInverted) {\n        this.setConfigSpaceViewportRect(\n          new Rect(\n            new Vec2(0, this.configSpaceSize().y - configSpaceViewportHeight + 1),\n            new Vec2(this.configSpaceSize().x, configSpaceViewportHeight),\n          ),\n        )\n      } else {\n        this.setConfigSpaceViewportRect(\n          new Rect(new Vec2(0, -1), new Vec2(this.configSpaceSize().x, configSpaceViewportHeight)),\n        )\n      }\n    } else if (\n      !logicalSpaceViewportSize.equals(Vec2.zero) &&\n      (logicalSpaceViewportSize.x !== width || logicalSpaceViewportSize.y !== height)\n    ) {\n      // Resize the viewport rectangle to match the window size aspect\n      // ratio.\n      this.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withSize(\n          this.props.configSpaceViewportRect.size.timesPointwise(\n            new Vec2(width / logicalSpaceViewportSize.x, height / logicalSpaceViewportSize.y),\n          ),\n        ),\n      )\n    }\n\n    const newSize = new Vec2(width, height)\n    if (!newSize.equals(logicalSpaceViewportSize)) {\n      this.props.setLogicalSpaceViewportSize(newSize)\n    }\n  }\n\n  onWindowResize = () => {\n    this.updateConfigSpaceViewport()\n    this.onBeforeFrame()\n  }\n\n  private renderRects() {\n    if (!this.container) return\n    this.updateConfigSpaceViewport()\n\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        physicalSpaceDstRect: this.physicalBounds(),\n        configSpaceSrcRect: this.props.configSpaceViewportRect,\n        renderOutlines: true,\n      })\n    })\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private onBeforeFrame = () => {\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n    this.maybeClearInteractionLock()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(logicalViewSpaceCenter: Vec2, multiplier: number) {\n    this.interactionLock = 'zoom'\n\n    const physicalCenter =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalViewSpaceCenter)\n    const configSpaceCenter =\n      this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalCenter)\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private lastDragPos: Vec2 | null = null\n  private mouseDownPos: Vec2 | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    this.mouseDownPos = this.lastDragPos = new Vec2(ev.offsetX, ev.offsetY)\n    this.updateCursor()\n    window.addEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseDrag = (ev: MouseEvent) => {\n    if (!this.lastDragPos) return\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    this.pan(this.lastDragPos.minus(logicalMousePos))\n    this.lastDragPos = logicalMousePos\n\n    // When panning by scrolling, the element under\n    // the cursor will change, so clear the hovered label.\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n  }\n\n  private onDblClick = (ev: MouseEvent) => {\n    if (this.hoveredLabel) {\n      const hoveredBounds = this.hoveredLabel.configSpaceBounds\n      const viewportRect = new Rect(\n        hoveredBounds.origin.minus(new Vec2(0, 1)),\n        hoveredBounds.size.withY(this.props.configSpaceViewportRect.height()),\n      )\n      this.props.setConfigSpaceViewportRect(viewportRect)\n    }\n  }\n\n  private onClick = (ev: MouseEvent) => {\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    const mouseDownPos = this.mouseDownPos\n    this.mouseDownPos = null\n\n    if (mouseDownPos && logicalMousePos.minus(mouseDownPos).length() > 5) {\n      // If the cursor is more than 5 logical space pixels away from the mouse\n      // down location, then don't interpret this event as a click.\n      return\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeSelect(this.hoveredLabel.node)\n      this.renderCanvas()\n    } else {\n      this.props.onNodeSelect(null)\n    }\n  }\n\n  private updateCursor() {\n    if (this.lastDragPos) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else {\n      document.body.style.cursor = 'default'\n    }\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.lastDragPos = null\n    this.updateCursor()\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    this.updateCursor()\n    if (this.lastDragPos) {\n      ev.preventDefault()\n      this.onMouseDrag(ev)\n      return\n    }\n\n    const logicalViewSpaceMouse = new Vec2(ev.offsetX, ev.offsetY)\n    const physicalViewSpaceMouse =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalViewSpaceMouse)\n    const configSpaceMouse =\n      this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalViewSpaceMouse)\n\n    if (!configSpaceMouse) return\n\n    const setHoveredLabel = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n      if (configSpaceMouse.x < configSpaceBounds.left()) return null\n      if (configSpaceMouse.x > configSpaceBounds.right()) return null\n\n      if (configSpaceBounds.contains(configSpaceMouse)) {\n        this.hoveredLabel = {\n          configSpaceBounds,\n          node: frame.node,\n        }\n      }\n\n      for (let child of frame.children) {\n        setHoveredLabel(child, depth + 1)\n      }\n    }\n\n    // This is a dumb hack to get around what appears to be a bug in\n    // TypeScript's reachability analysis. If I do the this.hoveredLabel = null\n    // in the outer function body, the code below accessing\n    // this.hoveredLabel!.node inside of the `if (this.hoveredLabel) {`\n    // complains that \"no property node on never\", indicating that it thinks\n    // that codepath is unreachable.\n    //\n    // Because this.hoveredLabel is accessed in the bound function\n    // setHoveredLabel, the codepath is obviously reachable, but the type\n    // checker is confused about this for some reason.\n    const clearHoveredLabel = () => {\n      this.hoveredLabel = null\n    }\n    clearHoveredLabel()\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      setHoveredLabel(frame)\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover({node: this.hoveredLabel!.node, event: ev})\n    } else {\n      this.props.onNodeHover(null)\n    }\n\n    this.renderCanvas()\n  }\n\n  private onMouseLeave = (ev: MouseEvent) => {\n    this.hoveredLabel = null\n    this.props.onNodeHover(null)\n    this.renderCanvas()\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    let deltaY = ev.deltaY\n    let deltaX = ev.deltaX\n    if (ev.deltaMode === ev.DOM_DELTA_LINE) {\n      deltaY *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      deltaX *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n    }\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(new Vec2(ev.offsetX, ev.offsetY), multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(deltaX, deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (!this.container) return\n    const {width, height} = this.container.getBoundingClientRect()\n\n    if (ev.key === '=' || ev.key === '+') {\n      this.zoom(new Vec2(width / 2, height / 2), 0.5)\n      ev.preventDefault()\n    } else if (ev.key === '-' || ev.key === '_') {\n      this.zoom(new Vec2(width / 2, height / 2), 2)\n      ev.preventDefault()\n    }\n\n    if (ev.ctrlKey || ev.shiftKey || ev.metaKey) return\n\n    // NOTE: We intentionally use ev.code rather than ev.key for\n    // WASD in order to have the keys retain the same layout even\n    // if the keyboard layout is not QWERTY.\n    //\n    // See: https://github.com/jlfwong/speedscope/pull/184\n    if (ev.key === '0') {\n      this.zoom(new Vec2(width / 2, height / 2), 1e9)\n    } else if (ev.key === 'ArrowRight' || ev.code === 'KeyD') {\n      this.pan(new Vec2(100, 0))\n    } else if (ev.key === 'ArrowLeft' || ev.code === 'KeyA') {\n      this.pan(new Vec2(-100, 0))\n    } else if (ev.key === 'ArrowUp' || ev.code === 'KeyW') {\n      this.pan(new Vec2(0, -100))\n    } else if (ev.key === 'ArrowDown' || ev.code === 'KeyS') {\n      this.pan(new Vec2(0, 100))\n    } else if (ev.key === 'Escape') {\n      this.props.onNodeSelect(null)\n      this.renderCanvas()\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n  componentWillReceiveProps(nextProps: FlamechartPanZoomViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.hoveredLabel = null\n      this.renderCanvas()\n    } else if (this.props.searchResults !== nextProps.searchResults) {\n      this.renderCanvas()\n    } else if (this.props.selectedNode !== nextProps.selectedNode) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect !== nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n    window.addEventListener('resize', this.onWindowResize)\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n    window.removeEventListener('resize', this.onWindowResize)\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        className={css(style.panZoomView, commonStyle.vbox)}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onClick}\n        onDblClick={this.onDblClick}\n        onWheel={this.onWheel}\n        ref={this.containerRef}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n","import {Vec2} from '../lib/math'\nimport {Sizes, FontSize, FontFamily, ZIndex} from './style'\nimport {css, StyleSheet} from 'aphrodite'\nimport {ComponentChildren, h} from 'preact'\nimport {useTheme, withTheme} from './themes/theme'\nimport {useCallback} from 'preact/hooks'\n\ninterface HovertipProps {\n  containerSize: Vec2\n  offset: Vec2\n  children?: ComponentChildren\n}\n\nexport function Hovertip(props: HovertipProps) {\n  const style = getStyle(useTheme())\n\n  const {containerSize, offset} = props\n  const containerWidth = containerSize.x\n  const containerHeight = containerSize.y\n\n  const OFFSET_FROM_MOUSE = 7\n\n  const updateLocation = useCallback(\n    (el: HTMLDivElement | null) => {\n      if (!el) return\n\n      const clientRect = el.getBoundingClientRect()\n\n      // Place the hovertip to the right of the cursor.\n      let leftEdgeX = offset.x + OFFSET_FROM_MOUSE\n\n      // If this would cause it to overflow the container, align the right\n      // edge of the hovertip with the right edge of the container.\n      if (leftEdgeX + clientRect.width > containerWidth - 1) {\n        leftEdgeX = containerWidth - clientRect.width - 1\n\n        // If aligning the right edge overflows the container, align the left edge\n        // of the hovertip with the left edge of the container.\n        if (leftEdgeX < 1) {\n          leftEdgeX = 1\n        }\n      }\n      el.style.left = `${leftEdgeX}px`\n\n      // Place the tooltip below the cursor\n      let topEdgeY = offset.y + OFFSET_FROM_MOUSE\n\n      // If this would cause it to overflow the container, place the hovertip\n      // above the cursor instead. This intentionally differs from the horizontal\n      // axis logic to avoid the cursor being in the middle of a hovertip when\n      // possible.\n      if (topEdgeY + clientRect.height > containerHeight - 1) {\n        topEdgeY = offset.y - clientRect.height - 1\n\n        // If placing the hovertip above the cursor overflows the container, align\n        // the top edge of the hovertip with the top edge of the container.\n        if (topEdgeY < 1) {\n          topEdgeY = 1\n        }\n      }\n      el.style.top = `${topEdgeY}px`\n    },\n    [containerWidth, containerHeight, offset.x, offset.y],\n  )\n\n  return (\n    <div className={css(style.hoverTip)} ref={updateLocation}>\n      <div className={css(style.hoverTipRow)}>{props.children}</div>\n    </div>\n  )\n}\n\nconst HOVERTIP_PADDING = 2\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverTip: {\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      border: '1px solid black',\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n      paddingTop: HOVERTIP_PADDING,\n      paddingBottom: HOVERTIP_PADDING,\n      pointerEvents: 'none',\n      userSelect: 'none',\n      fontSize: FontSize.LABEL,\n      fontFamily: FontFamily.MONOSPACE,\n      zIndex: ZIndex.HOVERTIP,\n    },\n    hoverTipRow: {\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      overflowX: 'hidden',\n      paddingLeft: HOVERTIP_PADDING,\n      paddingRight: HOVERTIP_PADDING,\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n    },\n  }),\n)\n","import {memo} from 'preact/compat'\nimport {useContext, useMemo, useCallback} from 'preact/hooks'\nimport {SearchView, ProfileSearchContext} from './search-view'\nimport {\n  FlamechartSearchMatch,\n  FlamechartSearchResults,\n  ProfileSearchResults,\n} from '../lib/profile-search'\nimport {Rect, Vec2} from '../lib/math'\nimport {h, createContext, ComponentChildren} from 'preact'\nimport {Flamechart} from '../lib/flamechart'\nimport {CallTreeNode} from '../lib/profile'\n\nexport const FlamechartSearchContext = createContext<FlamechartSearchData | null>(null)\n\nexport interface FlamechartSearchProps {\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n  children: ComponentChildren\n}\n\ninterface FlamechartSearchData {\n  results: FlamechartSearchResults | null\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nexport const FlamechartSearchContextProvider = ({\n  flamechart,\n  selectedNode,\n  setSelectedNode,\n  configSpaceViewportRect,\n  setConfigSpaceViewportRect,\n  children,\n}: FlamechartSearchProps) => {\n  const profileSearchResults: ProfileSearchResults | null = useContext(ProfileSearchContext)\n  const flamechartSearchResults: FlamechartSearchResults | null = useMemo(() => {\n    if (profileSearchResults == null) {\n      return null\n    }\n    return new FlamechartSearchResults(flamechart, profileSearchResults)\n  }, [flamechart, profileSearchResults])\n\n  return (\n    <FlamechartSearchContext.Provider\n      value={{\n        results: flamechartSearchResults,\n        flamechart,\n        selectedNode,\n        setSelectedNode,\n        configSpaceViewportRect,\n        setConfigSpaceViewportRect,\n      }}\n    >\n      {children}\n    </FlamechartSearchContext.Provider>\n  )\n}\n\nexport const FlamechartSearchView = memo(() => {\n  const flamechartData = useContext(FlamechartSearchContext)\n\n  // TODO(jlfwong): This pattern is pretty gross, but I really don't want values\n  // that can be undefined or null.\n  const searchResults = flamechartData == null ? null : flamechartData.results\n  const selectedNode = flamechartData == null ? null : flamechartData.selectedNode\n  const setSelectedNode = flamechartData == null ? null : flamechartData.setSelectedNode\n  const configSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.configSpaceViewportRect\n  const setConfigSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.setConfigSpaceViewportRect\n  const flamechart = flamechartData == null ? null : flamechartData.flamechart\n\n  const numResults = searchResults == null ? null : searchResults.count()\n  const resultIndex: number | null = useMemo(() => {\n    if (searchResults == null) return null\n    if (selectedNode == null) return null\n    return searchResults.indexOf(selectedNode)\n  }, [searchResults, selectedNode])\n\n  const selectAndZoomToMatch = useCallback(\n    (match: FlamechartSearchMatch) => {\n      if (!setSelectedNode) return\n      if (!flamechart) return\n      if (!configSpaceViewportRect) return\n      if (!setConfigSpaceViewportRect) return\n\n      // After the node is selected, we want to set the viewport so that the new\n      // node can be seen clearly.\n      //\n      // TODO(jlfwong): The lack of animation here can be kind of jarring. It\n      // would be nice to have some easier way for people to orient themselves\n      // after the viewport shifted.\n      const configSpaceResultBounds = match.configSpaceBounds\n\n      const viewportRect = new Rect(\n        configSpaceResultBounds.origin.minus(new Vec2(0, 1)),\n        configSpaceResultBounds.size.withY(configSpaceViewportRect.height()),\n      )\n\n      setSelectedNode(match.node)\n      setConfigSpaceViewportRect(\n        flamechart.getClampedConfigSpaceViewportRect({configSpaceViewportRect: viewportRect}),\n      )\n    },\n    [configSpaceViewportRect, setConfigSpaceViewportRect, setSelectedNode, flamechart],\n  )\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (numResults == null || numResults === 0 || searchResults == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n\n      selectNext: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n    }\n  }, [numResults, resultIndex, searchResults, selectAndZoomToMatch])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n","import {Component} from 'preact'\n\nexport type VoidState = {\n  __dummyField: void\n}\nexport abstract class StatelessComponent<P> extends Component<P, VoidState> {}\n","import {h, Fragment} from 'preact'\nimport {css} from 'aphrodite'\n\nimport {CallTreeNode} from '../lib/profile'\n\nimport {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {formatPercent} from '../lib/utils'\nimport {FlamechartMinimapView} from './flamechart-minimap-view'\n\nimport {Sizes, commonStyle} from './style'\nimport {FlamechartDetailView} from './flamechart-detail-view'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {ProfileSearchContext} from './search-view'\nimport {FlamechartSearchView} from './flamechart-search-view'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartView extends StatelessComponent<FlamechartViewProps> {\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private setConfigSpaceViewportRect = (viewportRect: Rect): void => {\n    const configSpaceDetailViewHeight = Sizes.DETAIL_VIEW_HEIGHT / Sizes.FRAME_HEIGHT\n\n    const configSpaceSize = this.configSpaceSize()\n\n    const width = this.props.flamechart.getClampedViewportWidth(viewportRect.size.x)\n    const size = viewportRect.size.withX(width)\n\n    const origin = Vec2.clamp(\n      viewportRect.origin,\n      new Vec2(0, -1),\n      Vec2.max(\n        Vec2.zero,\n        configSpaceSize.minus(size).plus(new Vec2(0, configSpaceDetailViewHeight + 1)),\n      ),\n    )\n\n    this.props.setConfigSpaceViewportRect(new Rect(origin, viewportRect.size.withX(width)))\n  }\n\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform): void => {\n    const viewportRect = transform.transformRect(this.props.configSpaceViewportRect)\n    this.setConfigSpaceViewportRect(viewportRect)\n  }\n\n  private onNodeHover = (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n    this.props.setNodeHover(hover)\n  }\n\n  onNodeClick = (node: CallTreeNode | null) => {\n    this.props.setSelectedNode(node)\n  }\n\n  formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n\n  renderTooltip() {\n    if (!this.container) return null\n\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const frame = hover.node.frame\n\n    const style = this.getStyle()\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.fill, commonStyle.vbox)} ref={this.containerRef}>\n        <FlamechartMinimapView\n          theme={this.props.theme}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n        />\n        <ProfileSearchContext.Consumer>\n          {searchResults => (\n            <Fragment>\n              <FlamechartPanZoomView\n                theme={this.props.theme}\n                canvasContext={this.props.canvasContext}\n                flamechart={this.props.flamechart}\n                flamechartRenderer={this.props.flamechartRenderer}\n                renderInverted={false}\n                onNodeHover={this.onNodeHover}\n                onNodeSelect={this.onNodeClick}\n                selectedNode={this.props.selectedNode}\n                transformViewport={this.transformViewport}\n                configSpaceViewportRect={this.props.configSpaceViewportRect}\n                setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n                logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n                setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n                searchResults={searchResults}\n              />\n              <FlamechartSearchView />\n            </Fragment>\n          )}\n        </ProfileSearchContext.Consumer>\n        {this.renderTooltip()}\n        {this.props.selectedNode && (\n          <FlamechartDetailView\n            flamechart={this.props.flamechart}\n            getCSSColorForFrame={this.props.getCSSColorForFrame}\n            selectedNode={this.props.selectedNode}\n          />\n        )}\n      </div>\n    )\n  }\n}\n","import {h} from 'preact'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Flamechart} from '../lib/flamechart'\nimport {FlamechartRenderer, FlamechartRendererOptions} from '../gl/flamechart-renderer'\nimport {Frame, Profile, CallTreeNode} from '../lib/profile'\nimport {memoizeByShallowEquality} from '../lib/utils'\nimport {FlamechartView} from './flamechart-view'\nimport {\n  getRowAtlas,\n  createGetColorBucketForFrame,\n  getCanvasContext,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {Vec2, Rect} from '../lib/math'\nimport {memo, useCallback} from 'preact/compat'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {FlamechartSearchContextProvider} from './flamechart-search-view'\nimport {Theme, useTheme} from './themes/theme'\nimport {FlamechartID, FlamechartViewState, ProfileGroupAtom} from '../app-state/profile-group'\nimport {profileGroupAtom} from '../app-state'\n\ninterface FlamechartSetters {\n  setLogicalSpaceViewportSize: (logicalSpaceViewportSize: Vec2) => void\n  setConfigSpaceViewportRect: (configSpaceViewportRect: Rect) => void\n  setNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  setSelectedNode: (node: CallTreeNode | null) => void\n}\n\nexport function useFlamechartSetters(\n  id: FlamechartID,\n  atom: ProfileGroupAtom = profileGroupAtom,\n): FlamechartSetters {\n  return {\n    setNodeHover: useCallback(\n      (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n        atom.setFlamechartHoveredNode(id, hover)\n      },\n      [atom, id],\n    ),\n    setLogicalSpaceViewportSize: useCallback(\n      (logicalSpaceViewportSize: Vec2) => {\n        atom.setLogicalSpaceViewportSize(id, logicalSpaceViewportSize)\n      },\n      [atom, id],\n    ),\n    setConfigSpaceViewportRect: useCallback(\n      (configSpaceViewportRect: Rect) => {\n        atom.setConfigSpaceViewportRect(id, configSpaceViewportRect)\n      },\n      [atom, id],\n    ),\n    setSelectedNode: useCallback(\n      (selectedNode: CallTreeNode | null) => {\n        atom.setSelectedNode(id, selectedNode)\n      },\n      [atom, id],\n    ),\n  }\n}\n\nexport type FlamechartViewProps = {\n  theme: Theme\n  canvasContext: CanvasContext\n  flamechart: Flamechart\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  getCSSColorForFrame: (frame: Frame) => string\n} & FlamechartSetters &\n  FlamechartViewState\n\nexport const getChronoViewFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalWeight.bind(profile),\n      forEachCall: profile.forEachCall.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nexport const createMemoizedFlamechartRenderer = (options?: FlamechartRendererOptions) =>\n  memoizeByShallowEquality(\n    ({\n      canvasContext,\n      flamechart,\n    }: {\n      canvasContext: CanvasContext\n      flamechart: Flamechart\n    }): FlamechartRenderer => {\n      return new FlamechartRenderer(\n        canvasContext.gl,\n        getRowAtlas(canvasContext),\n        flamechart,\n        canvasContext.rectangleBatchRenderer,\n        canvasContext.flamechartColorPassRenderer,\n        options,\n      )\n    },\n  )\n\nconst getChronoViewFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport interface FlamechartViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\nexport const ChronoFlamechartView = memo((props: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = props\n  const {profile, chronoViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getChronoViewFlamechart({profile, getColorBucketForFrame})\n  const flamechartRenderer = getChronoViewFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.CHRONO)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={chronoViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={chronoViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...chronoViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n\nexport const getLeftHeavyFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalNonIdleWeight.bind(profile),\n      forEachCall: profile.forEachCallGrouped.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getLeftHeavyFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport const LeftHeavyFlamechartView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n\n  const {profile, leftHeavyViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getLeftHeavyFlamechart({\n    profile,\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getLeftHeavyFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.LEFT_HEAVY)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={leftHeavyViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={leftHeavyViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...leftHeavyViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n","import {CallTreeNode} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {h} from 'preact'\nimport {commonStyle} from './style'\nimport {Rect, AffineTransform, Vec2} from '../lib/math'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {noop, formatPercent} from '../lib/utils'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {withTheme} from './themes/theme'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartWrapper extends StatelessComponent<FlamechartViewProps> {\n  private clampViewportToFlamegraph(viewportRect: Rect) {\n    const {flamechart, renderInverted} = this.props\n    return flamechart.getClampedConfigSpaceViewportRect({\n      configSpaceViewportRect: viewportRect,\n      renderInverted,\n    })\n  }\n  private setConfigSpaceViewportRect = (configSpaceViewportRect: Rect) => {\n    this.props.setConfigSpaceViewportRect(this.clampViewportToFlamegraph(configSpaceViewportRect))\n  }\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform) => {\n    this.setConfigSpaceViewportRect(transform.transformRect(this.props.configSpaceViewportRect))\n  }\n  private formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n  private renderTooltip() {\n    if (!this.container) return null\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const style = getStyle(this.props.theme)\n    const frame = hover.node.frame\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n  private setNodeHover = (\n    hover: {\n      node: CallTreeNode\n      event: MouseEvent\n    } | null,\n  ) => {\n    this.props.setNodeHover(hover)\n  }\n  render() {\n    return (\n      <div\n        className={css(commonStyle.fillY, commonStyle.fillX, commonStyle.vbox)}\n        ref={this.containerRef}\n      >\n        <FlamechartPanZoomView\n          theme={this.props.theme}\n          selectedNode={null}\n          onNodeHover={this.setNodeHover}\n          onNodeSelect={noop}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          renderInverted={this.props.renderInverted}\n          logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n          setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n          searchResults={null}\n        />\n        {this.renderTooltip()}\n      </div>\n    )\n  }\n}\n\nexport const getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n  }),\n)\n","import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {\n  createMemoizedFlamechartRenderer,\n  FlamechartViewContainerProps,\n  useFlamechartSetters,\n} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {FlamechartID} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nconst getInvertedCallerProfile = memoizeByShallowEquality(\n  ({\n    profile,\n    frame,\n    flattenRecursion,\n  }: {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  }): Profile => {\n    let p = profile.getInvertedProfileForCallersOf(frame)\n    return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n  },\n)\n\nconst getInvertedCallerFlamegraph = memoizeByShallowEquality(\n  ({\n    invertedCallerProfile,\n    getColorBucketForFrame,\n  }: {\n    invertedCallerProfile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: invertedCallerProfile.getTotalNonIdleWeight.bind(invertedCallerProfile),\n      forEachCall: invertedCallerProfile.forEachCallGrouped.bind(invertedCallerProfile),\n      formatValue: invertedCallerProfile.formatValue.bind(invertedCallerProfile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getInvertedCallerFlamegraphRenderer = createMemoizedFlamechartRenderer({inverted: true})\n\nexport const InvertedCallerFlamegraphView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  let {profile, sandwichViewState} = activeProfileState\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const glCanvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n\n  if (!profile) throw new Error('profile missing')\n  if (!glCanvas) throw new Error('glCanvas missing')\n  const {callerCallee} = sandwichViewState\n  if (!callerCallee) throw new Error('callerCallee missing')\n  const {selectedFrame} = callerCallee\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n  const flamechart = getInvertedCallerFlamegraph({\n    invertedCallerProfile: getInvertedCallerProfile({\n      profile,\n      frame: selectedFrame,\n      flattenRecursion,\n    }),\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getInvertedCallerFlamegraphRenderer({canvasContext, flamechart})\n\n  return (\n    <FlamechartWrapper\n      theme={theme}\n      renderInverted={true}\n      flamechart={flamechart}\n      flamechartRenderer={flamechartRenderer}\n      canvasContext={canvasContext}\n      getCSSColorForFrame={getCSSColorForFrame}\n      {...useFlamechartSetters(FlamechartID.SANDWICH_INVERTED_CALLERS)}\n      {...callerCallee.invertedCallerFlamegraph}\n      // This overrides the setSelectedNode specified in useFlamechartSettesr\n      setSelectedNode={noop}\n    />\n  )\n})\n","import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {createMemoizedFlamechartRenderer, useFlamechartSetters} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo, useMemo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {CallerCalleeState, FlamechartID, ProfileGroupAtom} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\n// TODO: move this import\nexport const getCalleeProfile = memoizeByShallowEquality<\n  {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  },\n  Profile\n>(({profile, frame, flattenRecursion}) => {\n  let p = profile.getProfileForCalleesOf(frame)\n  return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n})\n\nconst getCalleeFlamegraph = memoizeByShallowEquality<\n  {\n    calleeProfile: Profile\n    getTotalWeight: () => number\n    getColorBucketForFrame: (frame: Frame) => number\n  },\n  Flamechart\n>(({calleeProfile, getTotalWeight, getColorBucketForFrame}) => {\n  return new Flamechart({\n    getTotalWeight,\n    forEachCall: calleeProfile.forEachCallGrouped.bind(calleeProfile),\n    formatValue: calleeProfile.formatValue.bind(calleeProfile),\n    getColorBucketForFrame,\n  })\n})\n\nconst getCalleeFlamegraphRenderer = createMemoizedFlamechartRenderer()\n\ntype CalleeFlamegraphViewProps = {\n  profile: Profile\n  callerCallee: CallerCalleeState | null\n  getTotalWeight?: () => number\n  // TODO: I don't like overloading this word\n  // Maybe rename the atom?\n  profileGroupAtom: ProfileGroupAtom\n}\n\nexport const CalleeFlamegraphView = memo(\n  ({profile, callerCallee, getTotalWeight, profileGroupAtom}: CalleeFlamegraphViewProps) => {\n    const flattenRecursion = useAtom(flattenRecursionAtom)\n    const glCanvas = useAtom(glCanvasAtom)\n    const theme = useTheme()\n\n    if (!profile) throw new Error('profile missing')\n    if (!glCanvas) throw new Error('glCanvas missing')\n    if (!callerCallee) throw new Error('callerCallee missing')\n\n    const {selectedFrame} = callerCallee\n\n    const frameToColorBucket = getFrameToColorBucket(profile)\n    const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n    const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n    const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n    const calleeProfile = getCalleeProfile({profile, frame: selectedFrame, flattenRecursion})\n\n    const getCalleeTotalWeight = useMemo(() => {\n      if (getTotalWeight) return getTotalWeight\n\n      return calleeProfile.getTotalNonIdleWeight.bind(calleeProfile)\n    }, [getTotalWeight, calleeProfile])\n\n    const flamechart = getCalleeFlamegraph({\n      calleeProfile,\n      getTotalWeight: getCalleeTotalWeight,\n      getColorBucketForFrame,\n    })\n    const flamechartRenderer = getCalleeFlamegraphRenderer({canvasContext, flamechart})\n\n    return (\n      <FlamechartWrapper\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...useFlamechartSetters(FlamechartID.SANDWICH_CALLEES, profileGroupAtom)}\n        {...callerCallee.calleeFlamegraph}\n        // This overrides the setSelectedNode specified in useFlamechartSettesr\n        setSelectedNode={noop}\n      />\n    )\n  },\n)\n","import {memo} from 'preact/compat'\nimport {useContext, useMemo} from 'preact/hooks'\nimport {SearchView} from './search-view'\nimport {h} from 'preact'\nimport {SandwichViewContext} from './sandwich-view'\n\nexport const SandwichSearchView = memo(() => {\n  const sandwichViewContext = useContext(SandwichViewContext)\n\n  const rowList = sandwichViewContext != null ? sandwichViewContext.rowList : null\n  const resultIndex =\n    sandwichViewContext?.selectedFrame != null\n      ? sandwichViewContext.getIndexForFrame(sandwichViewContext.selectedFrame)\n      : null\n  const numResults = rowList != null ? rowList.length : null\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (rowList == null || numResults == null || numResults === 0 || sandwichViewContext == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n      selectNext: () => {\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n    }\n  }, [resultIndex, rowList, numResults, sandwichViewContext])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n","import {Frame} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {ProfileTableViewContainer} from './profile-table-view'\nimport {h, JSX, createContext} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {commonStyle, Sizes, FontSize} from './style'\nimport {InvertedCallerFlamegraphView} from './inverted-caller-flamegraph-view'\nimport {CalleeFlamegraphView} from './callee-flamegraph-view'\nimport {SandwichSearchView} from './sandwich-search-view'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {sortBy} from '../lib/utils'\nimport {ProfileSearchContext} from './search-view'\nimport {Theme, useTheme, withTheme} from './themes/theme'\nimport {SortField, SortDirection, profileGroupAtom, tableSortMethodAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\ninterface SandwichViewProps {\n  selectedFrame: Frame | null\n  profileIndex: number\n  theme: Theme\n  activeProfileState: ActiveProfileState\n  setSelectedFrame: (selectedFrame: Frame | null) => void\n  glCanvas: HTMLCanvasElement\n}\n\nclass SandwichView extends StatelessComponent<SandwichViewProps> {\n  private setSelectedFrame = (selectedFrame: Frame | null) => {\n    this.props.setSelectedFrame(selectedFrame)\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') {\n      this.setSelectedFrame(null)\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = getStyle(this.props.theme)\n\n    const {selectedFrame, activeProfileState} = this.props\n    let flamegraphViews: JSX.Element | null = null\n\n    const {profile, sandwichViewState} = activeProfileState\n    const {callerCallee} = sandwichViewState\n\n    if (selectedFrame) {\n      flamegraphViews = (\n        <div className={css(commonStyle.fillY, style.callersAndCallees, commonStyle.vbox)}>\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent)}>\n              <div className={css(style.flamechartLabel)}>Callers</div>\n            </div>\n            <InvertedCallerFlamegraphView\n              glCanvas={this.props.glCanvas}\n              activeProfileState={this.props.activeProfileState}\n            />\n          </div>\n          <div className={css(style.divider)} />\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent, style.flamechartLabelParentBottom)}>\n              <div className={css(style.flamechartLabel, style.flamechartLabelBottom)}>Callees</div>\n            </div>\n            <CalleeFlamegraphView\n              profile={profile}\n              callerCallee={callerCallee}\n              profileGroupAtom={profileGroupAtom}\n            />\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <div className={css(commonStyle.hbox, commonStyle.fillY)}>\n        <div className={css(style.tableView)}>\n          <ProfileTableViewContainer activeProfileState={this.props.activeProfileState} />\n          <SandwichSearchView />\n        </div>\n        {flamegraphViews}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    tableView: {\n      position: 'relative',\n      flex: 1,\n    },\n    panZoomViewWraper: {\n      flex: 1,\n    },\n    flamechartLabelParent: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n      alignItems: 'flex-start',\n      fontSize: FontSize.TITLE,\n      width: FontSize.TITLE * 1.2,\n      borderRight: `1px solid ${theme.fgSecondaryColor}`,\n    },\n    flamechartLabelParentBottom: {\n      justifyContent: 'flex-start',\n    },\n    flamechartLabel: {\n      transform: 'rotate(-90deg)',\n      transformOrigin: '50% 50% 0',\n      width: FontSize.TITLE * 1.2,\n      flexShrink: 1,\n    },\n    flamechartLabelBottom: {\n      transform: 'rotate(-90deg)',\n      display: 'flex',\n      justifyContent: 'flex-end',\n    },\n    callersAndCallees: {\n      flex: 1,\n      borderLeft: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    divider: {\n      height: 2,\n      background: theme.fgSecondaryColor,\n    },\n  }),\n)\n\ninterface SandwichViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\nexport interface SandwichViewContextData {\n  rowList: Frame[]\n  selectedFrame: Frame | null\n  setSelectedFrame: (frame: Frame | null) => void\n  getIndexForFrame: (frame: Frame) => number | null\n  getSearchMatchForFrame: (frame: Frame) => [number, number][] | null\n}\n\nexport const SandwichViewContext = createContext<SandwichViewContextData | null>(null)\n\nexport const SandwichViewContainer = memo((ownProps: SandwichViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n  const {sandwichViewState, index} = activeProfileState\n  const {callerCallee} = sandwichViewState\n\n  const theme = useTheme()\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n\n  const profile = activeProfileState.profile\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const profileSearchResults = useContext(ProfileSearchContext)\n\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n\n  const rowList: Frame[] = useMemo(() => {\n    const rowList: Frame[] = []\n\n    profile.forEachFrame(frame => {\n      if (profileSearchResults && !profileSearchResults.getMatchForFrame(frame)) {\n        return\n      }\n      rowList.push(frame)\n    })\n\n    switch (tableSortMethod.field) {\n      case SortField.SYMBOL_NAME: {\n        sortBy(rowList, f => f.name.toLowerCase())\n        break\n      }\n      case SortField.SELF: {\n        sortBy(rowList, f => f.getSelfWeight())\n        break\n      }\n      case SortField.TOTAL: {\n        sortBy(rowList, f => f.getTotalWeight())\n        break\n      }\n    }\n    if (tableSortMethod.direction === SortDirection.DESCENDING) {\n      rowList.reverse()\n    }\n\n    return rowList\n  }, [profile, profileSearchResults, tableSortMethod])\n\n  const getIndexForFrame: (frame: Frame) => number | null = useMemo(() => {\n    const indexByFrame = new Map<Frame, number>()\n    for (let i = 0; i < rowList.length; i++) {\n      indexByFrame.set(rowList[i], i)\n    }\n    return (frame: Frame) => {\n      const index = indexByFrame.get(frame)\n      return index == null ? null : index\n    }\n  }, [rowList])\n\n  const getSearchMatchForFrame: (frame: Frame) => [number, number][] | null = useMemo(() => {\n    return (frame: Frame) => {\n      if (profileSearchResults == null) return null\n      return profileSearchResults.getMatchForFrame(frame)\n    }\n  }, [profileSearchResults])\n\n  const contextData: SandwichViewContextData = {\n    rowList,\n    selectedFrame,\n    setSelectedFrame,\n    getIndexForFrame,\n    getSearchMatchForFrame,\n  }\n\n  return (\n    <SandwichViewContext.Provider value={contextData}>\n      <SandwichView\n        theme={theme}\n        activeProfileState={activeProfileState}\n        glCanvas={glCanvas}\n        setSelectedFrame={setSelectedFrame}\n        selectedFrame={selectedFrame}\n        profileIndex={index}\n      />\n    </SandwichViewContext.Provider>\n  )\n})\n","import {FileFormat} from './file-format-spec'\nimport {zeroPad} from './utils'\n\nexport interface ValueFormatter {\n  unit: FileFormat.ValueUnit\n  format(v: number): string\n}\n\nexport class RawValueFormatter implements ValueFormatter {\n  unit: FileFormat.ValueUnit = 'none'\n  format(v: number) {\n    return v.toLocaleString()\n  }\n}\n\nexport class TimeFormatter implements ValueFormatter {\n  private multiplier: number\n\n  constructor(public unit: 'nanoseconds' | 'microseconds' | 'milliseconds' | 'seconds') {\n    if (unit === 'nanoseconds') this.multiplier = 1e-9\n    else if (unit === 'microseconds') this.multiplier = 1e-6\n    else if (unit === 'milliseconds') this.multiplier = 1e-3\n    else this.multiplier = 1\n  }\n\n  formatUnsigned(v: number) {\n    const s = v * this.multiplier\n\n    if (s / 60 >= 1) {\n      const minutes = Math.floor(s / 60)\n      const seconds = Math.floor(s - minutes * 60).toString()\n      return `${minutes}:${zeroPad(seconds, 2)}`\n    }\n    if (s / 1 >= 1) return `${s.toFixed(2)}s`\n    if (s / 1e-3 >= 1) return `${(s / 1e-3).toFixed(2)}ms`\n    if (s / 1e-6 >= 1) return `${(s / 1e-6).toFixed(2)}s`\n    else return `${(s / 1e-9).toFixed(2)}ns`\n  }\n\n  format(v: number) {\n    return `${v < 0 ? '-' : ''}${this.formatUnsigned(Math.abs(v))}`\n  }\n}\n\nexport class ByteFormatter implements ValueFormatter {\n  unit: FileFormat.ValueUnit = 'bytes'\n\n  format(v: number) {\n    if (v < 1024) return `${v.toFixed(0)} B`\n    v /= 1024\n    if (v < 1024) return `${v.toFixed(2)} KB`\n    v /= 1024\n    if (v < 1024) return `${v.toFixed(2)} MB`\n    v /= 1024\n    return `${v.toFixed(2)} GB`\n  }\n}\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var getBundleURL = require('./bundle-url').getBundleURL;\n\nfunction loadBundlesLazy(bundles) {\n  if (!Array.isArray(bundles)) {\n    bundles = [bundles]\n  }\n\n  var id = bundles[bundles.length - 1];\n\n  try {\n    return Promise.resolve(require(id));\n  } catch (err) {\n    if (err.code === 'MODULE_NOT_FOUND') {\n      return new LazyPromise(function (resolve, reject) {\n        loadBundles(bundles.slice(0, -1))\n          .then(function () {\n            return require(id);\n          })\n          .then(resolve, reject);\n      });\n    }\n\n    throw err;\n  }\n}\n\nfunction loadBundles(bundles) {\n  return Promise.all(bundles.map(loadBundle));\n}\n\nvar bundleLoaders = {};\nfunction registerBundleLoader(type, loader) {\n  bundleLoaders[type] = loader;\n}\n\nmodule.exports = exports = loadBundlesLazy;\nexports.load = loadBundles;\nexports.register = registerBundleLoader;\n\nvar bundles = {};\nfunction loadBundle(bundle) {\n  var id;\n  if (Array.isArray(bundle)) {\n    id = bundle[1];\n    bundle = bundle[0];\n  }\n\n  if (bundles[bundle]) {\n    return bundles[bundle];\n  }\n\n  var type = (bundle.substring(bundle.lastIndexOf('.') + 1, bundle.length) || bundle).toLowerCase();\n  var bundleLoader = bundleLoaders[type];\n  if (bundleLoader) {\n    return bundles[bundle] = bundleLoader(getBundleURL() + bundle)\n      .then(function (resolved) {\n        if (resolved) {\n          module.bundle.register(id, resolved);\n        }\n\n        return resolved;\n      }).catch(function(e) {\n        delete bundles[bundle];\n        \n        throw e;\n      });\n  }\n}\n\nfunction LazyPromise(executor) {\n  this.executor = executor;\n  this.promise = null;\n}\n\nLazyPromise.prototype.then = function (onSuccess, onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.then(onSuccess, onError)\n};\n\nLazyPromise.prototype.catch = function (onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.catch(onError)\n};\n","import {lastOf, KeyedSet} from './utils'\nimport {ValueFormatter, RawValueFormatter} from './value-formatters'\nimport {FileFormat} from './file-format-spec'\nconst demangleCppModule = import('./demangle-cpp')\n\nexport interface FrameInfo {\n  key: string | number\n\n  // Name of the frame. May be a method name, e.g.\n  // \"ActiveRecord##to_hash\"\n  name: string\n\n  // File path of the code corresponding to this\n  // call stack frame.\n  file?: string\n\n  // Line in the given file where this frame occurs, 1-based.\n  line?: number\n\n  // Column in the file, 1-based.\n  col?: number\n}\n\nexport type SymbolRemapper = (\n  frame: Frame,\n) => {name?: string; file?: string; line?: number; col?: number} | null\n\nexport class HasWeights {\n  private selfWeight = 0\n  private totalWeight = 0\n  getSelfWeight() {\n    return this.selfWeight\n  }\n  getTotalWeight() {\n    return this.totalWeight\n  }\n  addToTotalWeight(delta: number) {\n    this.totalWeight += delta\n  }\n  addToSelfWeight(delta: number) {\n    this.selfWeight += delta\n  }\n\n  overwriteWeightWith(other: HasWeights) {\n    this.selfWeight = other.selfWeight\n    this.totalWeight = other.totalWeight\n  }\n}\n\nexport class Frame extends HasWeights {\n  key: string | number\n\n  // Name of the frame. May be a method name, e.g.\n  // \"ActiveRecord##to_hash\"\n  name: string\n\n  // File path of the code corresponding to this\n  // call stack frame.\n  file?: string\n\n  // Line in the given file where this frame occurs\n  line?: number\n\n  // Column in the file\n  col?: number\n\n  private constructor(info: FrameInfo) {\n    super()\n    this.key = info.key\n    this.name = info.name\n    this.file = info.file\n    this.line = info.line\n    this.col = info.col\n  }\n\n  static root = new Frame({\n    key: '(speedscope root)',\n    name: '(speedscope root)',\n  })\n\n  static getOrInsert(set: KeyedSet<Frame>, info: FrameInfo) {\n    return set.getOrInsert(new Frame(info))\n  }\n}\n\nexport class CallTreeNode extends HasWeights {\n  children: CallTreeNode[] = []\n\n  isRoot() {\n    return this.frame === Frame.root\n  }\n\n  key() {\n    return this.frame.key\n  }\n\n  weight() {\n    return this.frame.getSelfWeight()\n  }\n\n  // If a node is \"frozen\", it means it should no longer be mutated.\n  private frozen = false\n  isFrozen() {\n    return this.frozen\n  }\n  freeze() {\n    this.frozen = true\n  }\n\n  constructor(\n    readonly frame: Frame,\n    readonly parent: CallTreeNode | null,\n  ) {\n    super()\n  }\n}\n\nexport interface ProfileGroup {\n  name: string\n  indexToView: number\n  profiles: Profile[]\n}\n\nexport class Profile {\n  protected name: string = ''\n\n  protected totalWeight: number\n\n  protected frames = new KeyedSet<Frame>()\n\n  // Profiles store two call-trees.\n  //\n  // The \"append order\" call tree is the one in which nodes are ordered in\n  // whatever order they were appended to their parent.\n  //\n  // The \"grouped\" call tree is one in which each node has at most one child per\n  // frame. Nodes are ordered in decreasing order of weight\n  protected appendOrderCalltreeRoot = new CallTreeNode(Frame.root, null)\n  protected groupedCalltreeRoot = new CallTreeNode(Frame.root, null)\n\n  public getAppendOrderCalltreeRoot() {\n    return this.appendOrderCalltreeRoot\n  }\n  public getGroupedCalltreeRoot() {\n    return this.groupedCalltreeRoot\n  }\n\n  // List of references to CallTreeNodes at the top of the\n  // stack at the time of the sample.\n  protected samples: CallTreeNode[] = []\n  protected weights: number[] = []\n\n  protected valueFormatter: ValueFormatter = new RawValueFormatter()\n\n  constructor(totalWeight: number = 0) {\n    this.totalWeight = totalWeight\n  }\n\n  shallowClone(): Profile {\n    const profile = new Profile(this.totalWeight)\n    Object.assign(profile, this)\n    return profile\n  }\n\n  formatValue(v: number) {\n    return this.valueFormatter.format(v)\n  }\n  setValueFormatter(f: ValueFormatter) {\n    this.valueFormatter = f\n  }\n  getWeightUnit(): FileFormat.ValueUnit {\n    return this.valueFormatter.unit\n  }\n\n  getName() {\n    return this.name\n  }\n  setName(name: string) {\n    this.name = name\n  }\n\n  getTotalWeight() {\n    return this.totalWeight\n  }\n\n  private totalNonIdleWeight: number | null = null\n  getTotalNonIdleWeight() {\n    if (this.totalNonIdleWeight === null) {\n      this.totalNonIdleWeight = this.groupedCalltreeRoot.children.reduce(\n        (n, c) => n + c.getTotalWeight(),\n        0,\n      )\n    }\n    return this.totalNonIdleWeight\n  }\n\n  // This is private because it should only be called in the ProfileBuilder\n  // classes. Once a Profile instance has been constructed, it should be treated\n  // as immutable.\n  protected sortGroupedCallTree() {\n    function visit(node: CallTreeNode) {\n      node.children.sort((a, b) => -(a.getTotalWeight() - b.getTotalWeight()))\n      node.children.forEach(visit)\n    }\n    visit(this.groupedCalltreeRoot)\n  }\n\n  forEachCallGrouped(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ) {\n    function visit(node: CallTreeNode, start: number) {\n      if (node.frame !== Frame.root) {\n        openFrame(node, start)\n      }\n\n      let childTime = 0\n\n      node.children.forEach(function (child) {\n        visit(child, start + childTime)\n        childTime += child.getTotalWeight()\n      })\n\n      if (node.frame !== Frame.root) {\n        closeFrame(node, start + node.getTotalWeight())\n      }\n    }\n    visit(this.groupedCalltreeRoot, 0)\n  }\n\n  forEachCall(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ) {\n    let prevStack: CallTreeNode[] = []\n    let value = 0\n\n    let sampleIndex = 0\n    for (let stackTop of this.samples) {\n      // Find lowest common ancestor of the current stack and the previous one\n      let lca: CallTreeNode | null = null\n\n      // This is O(n^2), but n should be relatively small here (stack height),\n      // so hopefully this isn't much of a problem\n      for (\n        lca = stackTop;\n        lca && lca.frame != Frame.root && prevStack.indexOf(lca) === -1;\n        lca = lca.parent\n      ) {}\n\n      // Close frames that are no longer open\n      while (prevStack.length > 0 && lastOf(prevStack) != lca) {\n        const node = prevStack.pop()!\n        closeFrame(node, value)\n      }\n\n      // Open frames that are now becoming open\n      const toOpen: CallTreeNode[] = []\n      for (\n        let node: CallTreeNode | null = stackTop;\n        node && node.frame != Frame.root && node != lca;\n        node = node.parent\n      ) {\n        toOpen.push(node)\n      }\n      toOpen.reverse()\n\n      for (let node of toOpen) {\n        openFrame(node, value)\n      }\n\n      prevStack = prevStack.concat(toOpen)\n      value += this.weights[sampleIndex++]\n    }\n\n    // Close frames that are open at the end of the trace\n    for (let i = prevStack.length - 1; i >= 0; i--) {\n      closeFrame(prevStack[i], value)\n    }\n  }\n\n  forEachFrame(fn: (frame: Frame) => void) {\n    this.frames.forEach(fn)\n  }\n\n  private keyToFrameMap: Map<string | number, Frame> | undefined\n  getKeyToFrameMap(): Map<string | number, Frame> {\n    if (!this.keyToFrameMap) {\n      const map = new Map<string | number, Frame>()\n\n      this.forEachFrame(f => {\n        map.set(f.key, f)\n      })\n\n      this.keyToFrameMap = map\n    }\n\n    return this.keyToFrameMap\n  }\n\n  /**\n   * Get a map of the frame name to an array of frames. The frame name\n   * is not unique, unlike the key is supposed to be, so mutliple frames can\n   * be mapped to each function name\n   */\n  private nameToFrameMap: Map<string | number, Frame[]> | undefined\n  getNameToFrameMap(): Map<string | number, Frame[]> {\n    if (!this.nameToFrameMap) {\n      const map = new Map<string | number, Frame[]>()\n\n      this.forEachFrame(f => {\n        const frames = map.get(f.name) || []\n        frames.push(f)\n        map.set(f.name, frames)\n      })\n\n      this.nameToFrameMap = map\n    }\n    return this.nameToFrameMap\n  }\n\n  getProfileWithRecursionFlattened(): Profile {\n    const builder = new CallTreeProfileBuilder()\n\n    const stack: (CallTreeNode | null)[] = []\n    const framesInStack = new Set<Frame>()\n\n    function openFrame(node: CallTreeNode, value: number) {\n      if (framesInStack.has(node.frame)) {\n        stack.push(null)\n      } else {\n        framesInStack.add(node.frame)\n        stack.push(node)\n        builder.enterFrame(node.frame, value)\n      }\n    }\n    function closeFrame(node: CallTreeNode, value: number) {\n      const stackTop = stack.pop()\n      if (stackTop) {\n        framesInStack.delete(stackTop.frame)\n        builder.leaveFrame(stackTop.frame, value)\n      }\n    }\n\n    this.forEachCall(openFrame, closeFrame)\n\n    const flattenedProfile = builder.build()\n    flattenedProfile.name = this.name\n    flattenedProfile.valueFormatter = this.valueFormatter\n\n    // When constructing a profile with recursion flattened,\n    // counter-intuitive things can happen to \"self time\" measurements\n    // for functions.\n    // For example, given the following list of stacks w/ weights:\n    //\n    // a 1\n    // a;b;a 1\n    // a;b;a;b;a 1\n    // a;b;a 1\n    //\n    // The resulting profile with recursion flattened out will look like this:\n    //\n    // a 1\n    // a;b 3\n    //\n    // Which is useful to view, but it's counter-intuitive to move self-time\n    // for frames around, since analyzing the self-time of functions is an important\n    // thing to be able to do accurately, and we don't want this to change when recursion\n    // is flattened. To work around that, we'll just copy the weights directly from the\n    // un-flattened profile.\n    this.forEachFrame(f => {\n      flattenedProfile.frames.getOrInsert(f).overwriteWeightWith(f)\n    })\n\n    return flattenedProfile\n  }\n\n  getInvertedProfileForCallersOf(focalFrameInfo: FrameInfo): Profile {\n    const focalFrame = Frame.getOrInsert(this.frames, focalFrameInfo)\n    const builder = new StackListProfileBuilder()\n\n    // TODO(jlfwong): Could construct this at profile\n    // construction time rather than on demand.\n    const nodes: CallTreeNode[] = []\n\n    function visit(node: CallTreeNode) {\n      if (node.frame === focalFrame) {\n        nodes.push(node)\n      } else {\n        for (let child of node.children) {\n          visit(child)\n        }\n      }\n    }\n\n    visit(this.appendOrderCalltreeRoot)\n\n    for (let node of nodes) {\n      const stack: FrameInfo[] = []\n      for (let n: CallTreeNode | null = node; n != null && n.frame !== Frame.root; n = n.parent) {\n        stack.push(n.frame)\n      }\n      builder.appendSampleWithWeight(stack, node.getTotalWeight())\n    }\n\n    const ret = builder.build()\n    ret.name = this.name\n    ret.valueFormatter = this.valueFormatter\n    return ret\n  }\n\n  getProfileForCalleesOf(focalFrameInfo: FrameInfo): Profile {\n    const focalFrame = Frame.getOrInsert(this.frames, focalFrameInfo)\n    const builder = new StackListProfileBuilder()\n\n    function recordSubtree(focalFrameNode: CallTreeNode) {\n      const stack: FrameInfo[] = []\n\n      function visit(node: CallTreeNode) {\n        stack.push(node.frame)\n        builder.appendSampleWithWeight(stack, node.getSelfWeight())\n        for (let child of node.children) {\n          visit(child)\n        }\n        stack.pop()\n      }\n\n      visit(focalFrameNode)\n    }\n\n    function findCalls(node: CallTreeNode) {\n      if (node.frame === focalFrame) {\n        recordSubtree(node)\n      } else {\n        for (let child of node.children) {\n          findCalls(child)\n        }\n      }\n    }\n\n    findCalls(this.appendOrderCalltreeRoot)\n\n    const ret = builder.build()\n    ret.name = this.name\n    ret.valueFormatter = this.valueFormatter\n    return ret\n  }\n\n  // Demangle symbols for readability\n  async demangle() {\n    let demangleCpp: ((name: string) => string) | null = null\n\n    for (let frame of this.frames) {\n      // This function converts a mangled C++ name such as \"__ZNK7Support6ColorFeqERKS0_\"\n      // into a human-readable symbol (in this case \"Support::ColorF::==(Support::ColorF&)\")\n      if (frame.name.startsWith('__Z')) {\n        if (!demangleCpp) {\n          demangleCpp = (await demangleCppModule).demangleCpp\n        }\n        frame.name = demangleCpp(frame.name)\n      }\n    }\n  }\n\n  remapSymbols(callback: SymbolRemapper) {\n    for (let frame of this.frames) {\n      const remapped = callback(frame)\n      if (remapped == null) {\n        continue\n      }\n      const {name, file, line, col} = remapped\n      if (name != null) {\n        frame.name = name\n      }\n      if (file != null) {\n        frame.file = file\n      }\n      if (line != null) {\n        frame.line = line\n      }\n      if (col != null) {\n        frame.col = col\n      }\n    }\n  }\n}\n\nexport class StackListProfileBuilder extends Profile {\n  _appendSample(stack: Frame[], weight: number, useAppendOrder: boolean) {\n    if (isNaN(weight)) throw new Error('invalid weight')\n    let node = useAppendOrder ? this.appendOrderCalltreeRoot : this.groupedCalltreeRoot\n\n    let framesInStack = new Set<Frame>()\n\n    for (let frame of stack) {\n      const last = useAppendOrder\n        ? lastOf(node.children)\n        : node.children.find(c => c.frame === frame)\n      if (last && !last.isFrozen() && last.frame == frame) {\n        node = last\n      } else {\n        const parent = node\n        node = new CallTreeNode(frame, node)\n        parent.children.push(node)\n      }\n      node.addToTotalWeight(weight)\n\n      // It's possible for the same frame to occur multiple\n      // times in the same call stack due to either direct\n      // or indirect recursion. We want to avoid counting that\n      // frame multiple times for a single sample, we so just\n      // track all of the unique frames that participated in\n      // this call stack, then add to their weight at the end.\n      framesInStack.add(node.frame)\n    }\n    node.addToSelfWeight(weight)\n\n    if (useAppendOrder) {\n      for (let child of node.children) {\n        child.freeze()\n      }\n    }\n\n    if (useAppendOrder) {\n      node.frame.addToSelfWeight(weight)\n\n      for (let frame of framesInStack) {\n        frame.addToTotalWeight(weight)\n      }\n\n      if (node === lastOf(this.samples)) {\n        this.weights[this.weights.length - 1] += weight\n      } else {\n        this.samples.push(node)\n        this.weights.push(weight)\n      }\n    }\n  }\n\n  appendSampleWithWeight(stack: FrameInfo[], weight: number) {\n    if (weight === 0) {\n      // Samples with zero weight have no effect, so let's ignore them\n      return\n    }\n    if (weight < 0) {\n      throw new Error('Samples must have positive weights')\n    }\n\n    const frames = stack.map(fr => Frame.getOrInsert(this.frames, fr))\n    this._appendSample(frames, weight, true)\n    this._appendSample(frames, weight, false)\n  }\n\n  private pendingSample: {\n    stack: FrameInfo[]\n    startTimestamp: number\n    centralTimestamp: number\n  } | null = null\n  appendSampleWithTimestamp(stack: FrameInfo[], timestamp: number) {\n    if (this.pendingSample) {\n      if (timestamp < this.pendingSample.centralTimestamp) {\n        throw new Error('Timestamps received out of order')\n      }\n      const endTimestamp = (timestamp + this.pendingSample.centralTimestamp) / 2\n      this.appendSampleWithWeight(\n        this.pendingSample.stack,\n        endTimestamp - this.pendingSample.startTimestamp,\n      )\n      this.pendingSample = {stack, startTimestamp: endTimestamp, centralTimestamp: timestamp}\n    } else {\n      this.pendingSample = {stack, startTimestamp: timestamp, centralTimestamp: timestamp}\n    }\n  }\n\n  build(): Profile {\n    if (this.pendingSample) {\n      if (this.samples.length > 0) {\n        this.appendSampleWithWeight(\n          this.pendingSample.stack,\n          this.pendingSample.centralTimestamp - this.pendingSample.startTimestamp,\n        )\n      } else {\n        // There is only a single sample. In this case, units will be meaningless,\n        // so we'll append with a weight of 1 and also clear any value formatter\n        this.appendSampleWithWeight(this.pendingSample.stack, 1)\n        this.setValueFormatter(new RawValueFormatter())\n      }\n    }\n    this.totalWeight = Math.max(\n      this.totalWeight,\n      this.weights.reduce((a, b) => a + b, 0),\n    )\n    this.sortGroupedCallTree()\n    return this\n  }\n}\n\n// As an alternative API for importing profiles more efficiently, provide a\n// way to open & close frames directly without needing to construct tons of\n// arrays as intermediaries.\nexport class CallTreeProfileBuilder extends Profile {\n  private appendOrderStack: CallTreeNode[] = [this.appendOrderCalltreeRoot]\n  private groupedOrderStack: CallTreeNode[] = [this.groupedCalltreeRoot]\n  private framesInStack = new Map<Frame, number>()\n  private stack: Frame[] = []\n\n  private lastValue: number = 0\n  private addWeightsToFrames(value: number) {\n    const delta = value - this.lastValue\n    for (let frame of this.framesInStack.keys()) {\n      frame.addToTotalWeight(delta)\n    }\n    const stackTop = lastOf(this.stack)\n    if (stackTop) {\n      stackTop.addToSelfWeight(delta)\n    }\n  }\n  private addWeightsToNodes(value: number, stack: CallTreeNode[]) {\n    const delta = value - this.lastValue\n    for (let node of stack) {\n      node.addToTotalWeight(delta)\n    }\n    const stackTop = lastOf(stack)\n    if (stackTop) {\n      stackTop.addToSelfWeight(delta)\n    }\n  }\n\n  private _enterFrame(frame: Frame, value: number, useAppendOrder: boolean) {\n    let stack = useAppendOrder ? this.appendOrderStack : this.groupedOrderStack\n    this.addWeightsToNodes(value, stack)\n\n    let prevTop = lastOf(stack)\n\n    if (prevTop) {\n      if (useAppendOrder) {\n        const delta = value - this.lastValue\n        if (delta > 0) {\n          this.samples.push(prevTop)\n          this.weights.push(value - this.lastValue)\n        } else if (delta < 0) {\n          throw new Error(\n            `Samples must be provided in increasing order of cumulative value. Last sample was ${this.lastValue}, this sample was ${value}`,\n          )\n        }\n      }\n\n      const last = useAppendOrder\n        ? lastOf(prevTop.children)\n        : prevTop.children.find(c => c.frame === frame)\n      let node: CallTreeNode\n      if (last && !last.isFrozen() && last.frame == frame) {\n        node = last\n      } else {\n        node = new CallTreeNode(frame, prevTop)\n        prevTop.children.push(node)\n      }\n      stack.push(node)\n    }\n  }\n  enterFrame(frameInfo: FrameInfo, value: number) {\n    const frame = Frame.getOrInsert(this.frames, frameInfo)\n    this.addWeightsToFrames(value)\n    this._enterFrame(frame, value, true)\n    this._enterFrame(frame, value, false)\n\n    this.stack.push(frame)\n    const frameCount = this.framesInStack.get(frame) || 0\n    this.framesInStack.set(frame, frameCount + 1)\n    this.lastValue = value\n    this.totalWeight = Math.max(this.totalWeight, this.lastValue)\n  }\n\n  private _leaveFrame(frame: Frame, value: number, useAppendOrder: boolean) {\n    let stack = useAppendOrder ? this.appendOrderStack : this.groupedOrderStack\n    this.addWeightsToNodes(value, stack)\n\n    if (useAppendOrder) {\n      const leavingStackTop = this.appendOrderStack.pop()\n      if (leavingStackTop == null) {\n        throw new Error(`Trying to leave ${frame.key} when stack is empty`)\n      }\n      if (this.lastValue == null) {\n        throw new Error(`Trying to leave a ${frame.key} before any have been entered`)\n      }\n      leavingStackTop.freeze()\n\n      if (leavingStackTop.frame.key !== frame.key) {\n        throw new Error(\n          `Tried to leave frame \"${frame.name}\" while frame \"${leavingStackTop.frame.name}\" was at the top at ${value}`,\n        )\n      }\n\n      const delta = value - this.lastValue\n      if (delta > 0) {\n        this.samples.push(leavingStackTop)\n        this.weights.push(value - this.lastValue)\n      } else if (delta < 0) {\n        throw new Error(\n          `Samples must be provided in increasing order of cumulative value. Last sample was ${this\n            .lastValue!}, this sample was ${value}`,\n        )\n      }\n    } else {\n      this.groupedOrderStack.pop()\n    }\n  }\n\n  leaveFrame(frameInfo: FrameInfo, value: number) {\n    const frame = Frame.getOrInsert(this.frames, frameInfo)\n    this.addWeightsToFrames(value)\n\n    this._leaveFrame(frame, value, true)\n    this._leaveFrame(frame, value, false)\n\n    this.stack.pop()\n    const frameCount = this.framesInStack.get(frame)\n    if (frameCount == null) return\n    if (frameCount === 1) {\n      this.framesInStack.delete(frame)\n    } else {\n      this.framesInStack.set(frame, frameCount - 1)\n    }\n    this.lastValue = value\n\n    this.totalWeight = Math.max(this.totalWeight, this.lastValue)\n  }\n\n  build(): Profile {\n    // Each stack is expected to contain a single node which we initialize to be\n    // the root node.\n    if (this.appendOrderStack.length > 1 || this.groupedOrderStack.length > 1) {\n      throw new Error('Tried to complete profile construction with a non-empty stack')\n    }\n    this.sortGroupedCallTree()\n    return this\n  }\n}\n","// This file contains types which specify the speedscope file format.\n\nexport namespace FileFormat {\n  export type Profile = EventedProfile | SampledProfile\n\n  export interface File {\n    $schema: 'https://www.speedscope.app/file-format-schema.json'\n\n    // Data shared between profiles\n    shared: {\n      frames: Frame[]\n    }\n\n    // List of profile definitions\n    profiles: Profile[]\n\n    // The name of the contained profile group. If omitted, will use the name of\n    // the file itself.\n    // Added in 0.6.0\n    name?: string\n\n    // The index into the `profiles` array that should be displayed upon file\n    // load. If omitted, will default to displaying the first profile in the\n    // file.\n    //\n    // Added in 0.6.0\n    activeProfileIndex?: number\n\n    // The name of the the program which exported this profile. This isn't\n    // consumed but can be helpful for debugging generated data by seeing what\n    // was generating it! Recommended format is \"name@version\". e.g. when the\n    // file was exported by speedscope v0.6.0 itself, it will be\n    // \"speedscope@0.6.0\"\n    //\n    // Added in 0.6.0\n    exporter?: string\n  }\n\n  export interface Frame {\n    name: string\n    file?: string\n    line?: number\n    col?: number\n  }\n\n  export enum ProfileType {\n    EVENTED = 'evented',\n    SAMPLED = 'sampled',\n  }\n\n  export interface IProfile {\n    // Type of profile. This will future proof the file format to allow many\n    // different kinds of profiles to be contained and each type to be part of\n    // a discriminated union.\n    type: ProfileType\n  }\n\n  export interface EventedProfile extends IProfile {\n    type: ProfileType.EVENTED\n\n    // Name of the profile. Typically a filename for the source of the profile.\n    name: string\n\n    // Unit which all value are specified using in the profile.\n    unit: ValueUnit\n\n    // The starting value of the profile. This will typically be a timestamp.\n    // All event values will be relative to this startValue.\n    startValue: number\n\n    // The final value of the profile. This will typically be a timestamp. This\n    // must be greater than or equal to the startValue. This is useful in\n    // situations where the recorded profile extends past the end of the recorded\n    // events, which may happen if nothing was happening at the end of the\n    // profile.\n    endValue: number\n\n    // List of events that occured as part of this profile.\n    // The \"at\" field of every event must be in non-decreasing order.\n    events: (OpenFrameEvent | CloseFrameEvent)[]\n  }\n\n  // List of indices into the frame array\n  type SampledStack = number[]\n\n  export interface SampledProfile extends IProfile {\n    type: ProfileType.SAMPLED\n\n    // Name of the profile. Typically a filename for the source of the profile.\n    name: string\n\n    // Unit which all value are specified using in the profile.\n    unit: ValueUnit\n\n    // The starting value of the profile. This will typically be a timestamp.\n    // All event values will be relative to this startValue.\n    startValue: number\n\n    // The final value of the profile. This will typically be a timestamp. This\n    // must be greater than or equal to the startValue. This is useful in\n    // situations where the recorded profile extends past the end of the recorded\n    // events, which may happen if nothing was happening at the end of the\n    // profile.\n    endValue: number\n\n    // List of stacks\n    samples: SampledStack[]\n\n    // The weight of the sample at the given index. Should have\n    // the same length as the samples array.\n    weights: number[]\n  }\n\n  export type ValueUnit =\n    | 'none'\n    | 'nanoseconds'\n    | 'microseconds'\n    | 'milliseconds'\n    | 'seconds'\n    | 'bytes'\n\n  export enum EventType {\n    OPEN_FRAME = 'O',\n    CLOSE_FRAME = 'C',\n  }\n\n  interface IEvent {\n    type: EventType\n    at: number\n  }\n\n  // Indicates a stack frame opened. Every opened stack frame must have a\n  // corresponding close frame event, and the ordering must be balanced.\n  interface OpenFrameEvent extends IEvent {\n    type: EventType.OPEN_FRAME\n    // An index into the frames array in the shared data within the profile\n    frame: number\n  }\n\n  interface CloseFrameEvent extends IEvent {\n    type: EventType.CLOSE_FRAME\n    // An index into the frames array in the shared data within the profile\n    frame: number\n  }\n}\n","module.exports = {\n  \"name\": \"speedscope\",\n  \"version\": \"1.19.0\",\n  \"description\": \"\",\n  \"repository\": \"jlfwong/speedscope\",\n  \"main\": \"index.js\",\n  \"bin\": {\n    \"speedscope\": \"./bin/cli.js\"\n  },\n  \"scripts\": {\n    \"deploy\": \"./scripts/deploy.sh\",\n    \"prepack\": \"./scripts/build-release.sh\",\n    \"prettier\": \"prettier --write 'src/**/*.ts' 'src/**/*.tsx'\",\n    \"lint\": \"eslint 'src/**/*.ts' 'src/**/*.tsx'\",\n    \"jest\": \"./scripts/test-setup.sh && jest --runInBand\",\n    \"coverage\": \"npm run jest -- --coverage\",\n    \"typecheck\": \"tsc --noEmit\",\n    \"test\": \"./scripts/ci.sh\",\n    \"serve\": \"parcel assets/index.html --open --no-autoinstall\"\n  },\n  \"files\": [\n    \"bin/cli.js\",\n    \"dist/release/**\",\n    \"!*.map\"\n  ],\n  \"browserslist\": [\n    \"last 2 Chrome versions\",\n    \"last 2 Firefox versions\"\n  ],\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"@types/jest\": \"22.2.3\",\n    \"@types/jszip\": \"3.1.4\",\n    \"@types/node\": \"14.0.1\",\n    \"@types/pako\": \"1.0.0\",\n    \"@typescript-eslint/eslint-plugin\": \"6.16.0\",\n    \"@typescript-eslint/parser\": \"6.16.0\",\n    \"acorn\": \"7.2.0\",\n    \"aphrodite\": \"2.1.0\",\n    \"eslint\": \"8.0.0\",\n    \"eslint-plugin-prettier\": \"5.1.2\",\n    \"eslint-plugin-react-hooks\": \"4.6.0\",\n    \"jest\": \"24.3.0\",\n    \"jsverify\": \"0.8.3\",\n    \"jszip\": \"3.1.5\",\n    \"pako\": \"1.0.6\",\n    \"parcel-bundler\": \"1.12.4\",\n    \"preact\": \"10.4.1\",\n    \"prettier\": \"3.1.1\",\n    \"protobufjs\": \"6.8.8\",\n    \"source-map\": \"0.6.1\",\n    \"ts-jest\": \"24.3.0\",\n    \"typescript\": \"5.3.3\",\n    \"typescript-json-schema\": \"0.42.0\",\n    \"uglify-es\": \"3.2.2\",\n    \"uint8array-json-parser\": \"0.0.2\"\n  },\n  \"jest\": {\n    \"transform\": {\n      \"^.+\\\\.tsx?$\": \"ts-jest\"\n    },\n    \"setupFilesAfterEnv\": [\n      \"./src/jest-setup.js\"\n    ],\n    \"testRegex\": \"\\\\.test\\\\.tsx?$\",\n    \"collectCoverageFrom\": [\n      \"**/*.{ts,tsx}\",\n      \"!**/*.d.{ts,tsx}\"\n    ],\n    \"moduleFileExtensions\": [\n      \"ts\",\n      \"tsx\",\n      \"js\",\n      \"jsx\",\n      \"json\"\n    ]\n  },\n  \"dependencies\": {\n    \"open\": \"7.2.0\"\n  }\n}\n;","import {\n  Profile,\n  CallTreeNode,\n  Frame,\n  CallTreeProfileBuilder,\n  FrameInfo,\n  StackListProfileBuilder,\n  ProfileGroup,\n} from './profile'\nimport {TimeFormatter, ByteFormatter, RawValueFormatter} from './value-formatters'\nimport {FileFormat} from './file-format-spec'\n\nexport function exportProfileGroup(profileGroup: ProfileGroup): FileFormat.File {\n  const frames: FileFormat.Frame[] = []\n\n  const indexForFrame = new Map<Frame, number>()\n  function getIndexForFrame(frame: Frame): number {\n    let index = indexForFrame.get(frame)\n    if (index == null) {\n      const serializedFrame: FileFormat.Frame = {\n        name: frame.name,\n      }\n      if (frame.file != null) serializedFrame.file = frame.file\n      if (frame.line != null) serializedFrame.line = frame.line\n      if (frame.col != null) serializedFrame.col = frame.col\n      index = frames.length\n      indexForFrame.set(frame, index)\n      frames.push(serializedFrame)\n    }\n    return index\n  }\n\n  const file: FileFormat.File = {\n    exporter: `speedscope@${require('../../package.json').version}`,\n    name: profileGroup.name,\n    activeProfileIndex: profileGroup.indexToView,\n    $schema: 'https://www.speedscope.app/file-format-schema.json',\n    shared: {frames},\n    profiles: [],\n  }\n\n  for (let profile of profileGroup.profiles) {\n    file.profiles.push(exportProfile(profile, getIndexForFrame))\n  }\n\n  return file\n}\n\nfunction exportProfile(profile: Profile, getIndexForFrame: (frame: Frame) => number) {\n  const eventedProfile: FileFormat.EventedProfile = {\n    type: FileFormat.ProfileType.EVENTED,\n    name: profile.getName(),\n    unit: profile.getWeightUnit(),\n    startValue: 0,\n    endValue: profile.getTotalWeight(),\n    events: [],\n  }\n  const openFrame = (node: CallTreeNode, value: number) => {\n    eventedProfile.events.push({\n      type: FileFormat.EventType.OPEN_FRAME,\n      frame: getIndexForFrame(node.frame),\n      at: value,\n    })\n  }\n  const closeFrame = (node: CallTreeNode, value: number) => {\n    eventedProfile.events.push({\n      type: FileFormat.EventType.CLOSE_FRAME,\n      frame: getIndexForFrame(node.frame),\n      at: value,\n    })\n  }\n  profile.forEachCall(openFrame, closeFrame)\n  return eventedProfile\n}\n\nfunction importSpeedscopeProfile(\n  serialized: FileFormat.Profile,\n  frames: FileFormat.Frame[],\n): Profile {\n  function setCommonProperties(p: Profile) {\n    const {name, unit} = serialized\n\n    switch (unit) {\n      case 'nanoseconds':\n      case 'microseconds':\n      case 'milliseconds':\n      case 'seconds':\n        p.setValueFormatter(new TimeFormatter(unit))\n        break\n\n      case 'bytes':\n        p.setValueFormatter(new ByteFormatter())\n        break\n\n      case 'none':\n        p.setValueFormatter(new RawValueFormatter())\n        break\n    }\n    p.setName(name)\n  }\n\n  function importEventedProfile(evented: FileFormat.EventedProfile) {\n    const {startValue, endValue, events} = evented\n\n    const profile = new CallTreeProfileBuilder(endValue - startValue)\n    setCommonProperties(profile)\n\n    const frameInfos: FrameInfo[] = frames.map((frame, i) => ({key: i, ...frame}))\n\n    for (let ev of events) {\n      switch (ev.type) {\n        case FileFormat.EventType.OPEN_FRAME: {\n          profile.enterFrame(frameInfos[ev.frame], ev.at - startValue)\n          break\n        }\n        case FileFormat.EventType.CLOSE_FRAME: {\n          profile.leaveFrame(frameInfos[ev.frame], ev.at - startValue)\n          break\n        }\n      }\n    }\n    return profile.build()\n  }\n\n  function importSampledProfile(sampled: FileFormat.SampledProfile) {\n    const {startValue, endValue, samples, weights} = sampled\n    const profile = new StackListProfileBuilder(endValue - startValue)\n    setCommonProperties(profile)\n\n    const frameInfos: FrameInfo[] = frames.map((frame, i) => ({key: i, ...frame}))\n\n    if (samples.length !== weights.length) {\n      throw new Error(\n        `Expected samples.length (${samples.length}) to equal weights.length (${weights.length})`,\n      )\n    }\n\n    for (let i = 0; i < samples.length; i++) {\n      const stack = samples[i]\n      const weight = weights[i]\n      profile.appendSampleWithWeight(\n        stack.map(n => frameInfos[n]),\n        weight,\n      )\n    }\n\n    return profile.build()\n  }\n\n  switch (serialized.type) {\n    case FileFormat.ProfileType.EVENTED:\n      return importEventedProfile(serialized)\n    case FileFormat.ProfileType.SAMPLED:\n      return importSampledProfile(serialized)\n  }\n}\n\nexport function importSpeedscopeProfiles(serialized: FileFormat.File): ProfileGroup {\n  return {\n    name: serialized.name || serialized.profiles[0].name || 'profile',\n    indexToView: serialized.activeProfileIndex || 0,\n    profiles: serialized.profiles.map(p => importSpeedscopeProfile(p, serialized.shared.frames)),\n  }\n}\n\nexport function saveToFile(profileGroup: ProfileGroup): void {\n  const file = exportProfileGroup(profileGroup)\n  const blob = new Blob([JSON.stringify(file)], {type: 'text/json'})\n\n  const nameWithoutExt = file.name ? file.name.split('.')[0]! : 'profile'\n  const filename = `${nameWithoutExt.replace(/\\W+/g, '_')}.speedscope.json`\n\n  console.log('Saving', filename)\n\n  const a = document.createElement('a')\n  a.download = filename\n  a.href = window.URL.createObjectURL(blob)\n  a.dataset.downloadurl = ['text/json', a.download, a.href].join(':')\n\n  // For this to work in Firefox, the <a> must be in the DOM\n  document.body.appendChild(a)\n  a.click()\n  document.body.removeChild(a)\n}\n","/**\n * This file contains an implementation of fuzzy string matching.\n */\n\nexport interface FuzzyMatch {\n  // List of [start, end] indices in the haystack string that match the needle string\n  matchedRanges: [number, number][]\n\n  // The score of the match for relative ranking. Higher scores indicate\n  // \"better\" matches.\n  score: number\n}\n\nexport function fuzzyMatchStrings(text: string, pattern: string): FuzzyMatch | null {\n  return fzfFuzzyMatchV1(text, pattern)\n}\n\n// The implementation here is based on FuzzyMatchV1, as described here:\n// https://github.com/junegunn/fzf/blob/f81feb1e69e5cb75797d50817752ddfe4933cd68/src/algo/algo.go#L8-L15\n//\n// This is a hand-port to better understand what the code is doing and for added\n// clarity.\n//\n// Capitalized letters only match capitalized letters, but lower-case letters\n// match both.\n//\n// Note: fzf includes a normalization table for homoglyphs. I'm going to ignore that too\n// https://github.com/junegunn/fzf/blob/master/src/algo/normalize.go\nconst charCodeLowerA = 'a'.charCodeAt(0)\nconst charCodeLowerZ = 'z'.charCodeAt(0)\nconst charCodeUpperA = 'A'.charCodeAt(0)\nconst charCodeUpperZ = 'Z'.charCodeAt(0)\nconst charCodeDigit0 = '0'.charCodeAt(0)\nconst charCodeDigit9 = '9'.charCodeAt(0)\n\nenum fzfCharClass {\n  charNonWord,\n  charLower,\n  charUpper,\n  charNumber,\n}\n\nfunction fzfCharClassOf(char: string): fzfCharClass {\n  const code = char.charCodeAt(0)\n  if (charCodeLowerA <= code && code <= charCodeLowerZ) {\n    return fzfCharClass.charLower\n  } else if (charCodeUpperA <= code && code <= charCodeUpperZ) {\n    return fzfCharClass.charUpper\n  } else if (charCodeDigit0 <= code && code <= charCodeDigit9) {\n    return fzfCharClass.charNumber\n  }\n  return fzfCharClass.charNonWord\n}\n\nfunction charsMatch(textChar: string, patternChar: string): boolean {\n  if (textChar === patternChar) return true\n\n  const patternCharCode = patternChar.charCodeAt(0)\n  if (charCodeLowerA <= patternCharCode && patternCharCode <= charCodeLowerZ) {\n    return textChar.charCodeAt(0) === patternCharCode - charCodeLowerA + charCodeUpperA\n  }\n  return false\n}\n\nfunction fzfFuzzyMatchV1(text: string, pattern: string): FuzzyMatch | null {\n  if (pattern.length == 0) {\n    return {matchedRanges: [], score: 0}\n  }\n\n  // I removed the fzfAsciiFuzzyIndex code because it's not actually clear to\n  // me that it's a very helpful optimization.\n\n  let pidx = 0\n  let sidx = -1\n  let eidx = -1\n\n  let lenRunes = text.length\n  let lenPattern = pattern.length\n\n  // Forward pass: scan over the text pattern, identifying the earliest start\n  // and the latest end to consider.\n  for (let index = 0; index < lenRunes; index++) {\n    let char = text[index]\n    let pchar = pattern[pidx]\n    if (charsMatch(char, pchar)) {\n      if (sidx < 0) {\n        sidx = index\n      }\n      pidx++\n      if (pidx == lenPattern) {\n        // We found the last character in the pattern! eidx is exclusive, so\n        // we'll set it to the current index + 1.\n        eidx = index + 1\n        break\n      }\n    }\n  }\n\n  if (eidx == -1) {\n    // We couldn't find all the characters in the pattern. No match.\n    return null\n  }\n\n  // Assuming we found all the characters in the pattern, perform the backwards\n  // pass.\n  pidx--\n  for (let index = eidx - 1; index >= sidx; index--) {\n    const char = text[index]\n    const pchar = pattern[pidx]\n    if (charsMatch(char, pchar)) {\n      pidx--\n      if (pidx < 0) {\n        // We found the first character of the pattern, scanning\n        // backwards. This *may* have narrowed the match further.\n        // For example, for the following inputs:\n        //\n        //    text = \"xxx a b c abc xxx\"\n        // pattern = \"abc\"\n        //\n        // For the forward pass, you get:\n        //\n        //    \"xxx a b c abc xxx\"\n        //    start^        ^end\n        //\n        // But after the backward pass, we can narrow this to:\n        //\n        //    \"xxx a b c abc xxx\"\n        //          start^  ^end\n        sidx = index\n        return fzfCalculateScore(text, pattern, sidx, eidx)\n      }\n    }\n  }\n\n  // This should be unreachable.\n  throw new Error('Implementation error. This must be a bug in fzfFuzzyMatchV1')\n}\n\nconst fzfScoreMatch = 16\nconst fzfScoreGapStart = -3\nconst fzfScoreGapExtension = -1\nconst fzfBonusBoundary = fzfScoreMatch / 2\nconst fzfBonusNonWord = fzfScoreMatch / 2\nconst fzfBonusCamel123 = fzfBonusBoundary + fzfScoreGapExtension\nconst fzfBonusConsecutive = -(fzfScoreGapStart + fzfScoreGapExtension)\nconst fzfBonusFirstCharMultiplier = 2\n\nfunction bonusFor(prevClass: fzfCharClass, curClass: fzfCharClass): number {\n  if (prevClass === fzfCharClass.charNonWord && curClass !== fzfCharClass.charNonWord) {\n    // Prefer matching at word boundaries\n    //\n    // This should prefer \"a c\" over \"abc\" for a pattern of \"ac\".\n    return fzfBonusBoundary\n  }\n\n  if (\n    (prevClass === fzfCharClass.charLower && curClass == fzfCharClass.charUpper) ||\n    (prevClass !== fzfCharClass.charNumber && curClass == fzfCharClass.charNumber)\n  ) {\n    // Prefer matching at the transition point between lower & upper for camelCase,\n    // and from transition from letter to number for identifiers like letter123.\n    //\n    // This should prefer \"OutNode\" over \"phone\" for a pattern of \"n\",\n    // and \"abc123\" over \"x211\" for a pattern of \"1\".\n    return fzfBonusCamel123\n  }\n\n  if (curClass === fzfCharClass.charNonWord) {\n    return fzfBonusNonWord\n  }\n  return 0\n}\n\nfunction fzfCalculateScore(text: string, pattern: string, sidx: number, eidx: number): FuzzyMatch {\n  let pidx = 0\n  let score = 0\n  let inGap = false\n  let consecutive = 0\n  let firstBonus = 0\n  let pos: number[] = new Array(pattern.length)\n  let prevClass = fzfCharClass.charNonWord\n\n  if (sidx > 0) {\n    prevClass = fzfCharClassOf(text[sidx - 1])\n  }\n  for (let idx = sidx; idx < eidx; idx++) {\n    let char = text[idx]\n    let curClass = fzfCharClassOf(char)\n    if (charsMatch(char, pattern[pidx])) {\n      pos[pidx] = idx\n      score += fzfScoreMatch\n      let bonus = bonusFor(prevClass, curClass)\n      if (consecutive == 0) {\n        firstBonus = bonus\n      } else {\n        // Break consecutive chunk\n        if (bonus === fzfBonusBoundary) {\n          firstBonus = bonus\n        }\n        bonus = Math.max(bonus, firstBonus, fzfBonusConsecutive)\n      }\n      if (pidx === 0) {\n        score += bonus * fzfBonusFirstCharMultiplier\n      } else {\n        score += bonus\n      }\n      inGap = false\n      consecutive++\n      pidx++\n    } else {\n      if (inGap) {\n        // Penalize gaps (this bonus is negative)\n        score += fzfScoreGapExtension\n      } else {\n        // Penalize the beginning of gaps more harshly\n        score += fzfScoreGapStart\n      }\n      inGap = true\n      consecutive = 0\n      firstBonus = 0\n    }\n    prevClass = curClass\n  }\n\n  if (pidx !== pattern.length) {\n    throw new Error(\n      'fzfCalculateScore should only be called when pattern is found between sidx and eidx',\n    )\n  }\n\n  let matchedRanges: [number, number][] = [[pos[0], pos[0] + 1]]\n  for (let i = 1; i < pos.length; i++) {\n    const curPos = pos[i]\n    const curRange = matchedRanges[matchedRanges.length - 1]\n    if (curRange[1] === curPos) {\n      curRange[1] = curPos + 1\n    } else {\n      matchedRanges.push([curPos, curPos + 1])\n    }\n  }\n\n  return {\n    score,\n    matchedRanges,\n  }\n}\n","import {Profile} from '../lib/profile'\nimport {h, JSX, ComponentChild, Ref} from 'preact'\nimport {useCallback, useState, useMemo, useEffect, useRef} from 'preact/hooks'\nimport {StyleSheet, css} from 'aphrodite'\nimport {ZIndex, Sizes} from './style'\nimport {fuzzyMatchStrings} from '../lib/fuzzy-find'\nimport {sortBy} from '../lib/utils'\nimport {useTheme, withTheme} from './themes/theme'\n\ninterface ProfileSelectRowProps {\n  setProfileIndexToView: (profileIndex: number) => void\n  setHoveredProfileIndex: (profileIndex: number) => void\n  profile: Profile\n  matchedRanges: [number, number][]\n  hovered: boolean\n  selected: boolean\n  indexInProfileGroup: number\n  indexInFilteredListView: number\n  profileCount: number\n  nodeRef?: Ref<HTMLDivElement>\n  closeProfileSelect: () => void\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nexport function ProfileSelectRow({\n  setProfileIndexToView,\n  setHoveredProfileIndex,\n  profile,\n  selected,\n  hovered,\n  profileCount,\n  nodeRef,\n  closeProfileSelect,\n  indexInProfileGroup,\n  matchedRanges,\n  indexInFilteredListView,\n}: ProfileSelectRowProps) {\n  const style = getStyle(useTheme())\n\n  const onMouseUp = useCallback(() => {\n    closeProfileSelect()\n    setProfileIndexToView(indexInProfileGroup)\n  }, [closeProfileSelect, setProfileIndexToView, indexInProfileGroup])\n\n  const onMouseEnter = useCallback(\n    (ev: Event) => {\n      setHoveredProfileIndex(indexInProfileGroup)\n    },\n    [setHoveredProfileIndex, indexInProfileGroup],\n  )\n\n  const name = profile.getName()\n\n  const maxDigits = 1 + Math.floor(Math.log10(profileCount))\n\n  const highlightedClassName = css(style.highlighted)\n  const highlighted = useMemo(() => {\n    const result = highlightRanges(name, matchedRanges, highlightedClassName)\n    return result\n  }, [name, matchedRanges, highlightedClassName])\n\n  // TODO(jlfwong): There's a really gnarly edge-case here where the highlighted\n  // ranges are part of the text truncated by ellipsis. I'm just going to punt\n  // on solving for that.\n  return (\n    <div\n      ref={nodeRef}\n      onMouseUp={onMouseUp}\n      onMouseEnter={onMouseEnter}\n      title={name}\n      className={css(\n        style.profileRow,\n        indexInFilteredListView % 2 === 0 && style.profileRowEven,\n        selected && style.profileRowSelected,\n        hovered && style.profileRowHovered,\n      )}\n    >\n      <span\n        className={css(style.profileIndex, selected && style.profileIndexSelected)}\n        style={{width: maxDigits + 'em'}}\n      >\n        {indexInProfileGroup + 1}:\n      </span>{' '}\n      {highlighted}\n    </div>\n  )\n}\n\ninterface ProfileSelectProps {\n  setProfileIndexToView: (profileIndex: number) => void\n  indexToView: number\n  profiles: Profile[]\n  closeProfileSelect: () => void\n  visible: boolean\n}\n\nfunction stopPropagation(ev: Event) {\n  ev.stopPropagation()\n}\n\ninterface FilteredProfile {\n  indexInProfileGroup: number\n  profile: Profile\n  matchedRanges: [number, number][]\n  score: number\n}\n\nfunction getSortedFilteredProfiles(profiles: Profile[], filterText: string): FilteredProfile[] {\n  const filtered: FilteredProfile[] = []\n  for (let i = 0; i < profiles.length; i++) {\n    const profile = profiles[i]\n    const match = fuzzyMatchStrings(profile.getName(), filterText)\n    if (!match) continue\n    filtered.push({\n      indexInProfileGroup: i,\n      profile,\n      ...match,\n    })\n  }\n  sortBy(filtered, p => -p.score)\n  return filtered\n}\n\nexport function ProfileSelect({\n  profiles,\n  closeProfileSelect,\n  indexToView,\n  visible,\n  setProfileIndexToView,\n}: ProfileSelectProps) {\n  const style = getStyle(useTheme())\n\n  const [filterText, setFilterText] = useState('')\n\n  const onFilterTextChange = useCallback(\n    (ev: Event) => {\n      const value = (ev.target as HTMLInputElement).value\n      setFilterText(value)\n    },\n    [setFilterText],\n  )\n\n  const focusFilterInput = useCallback(\n    (node: HTMLInputElement | null) => {\n      if (node) {\n        if (visible) {\n          node.select()\n        } else {\n          node.blur()\n        }\n      }\n    },\n    [visible],\n  )\n\n  const filteredProfiles = useMemo(() => {\n    return getSortedFilteredProfiles(profiles, filterText)\n  }, [profiles, filterText])\n\n  const [hoveredProfileIndex, setHoveredProfileIndex] = useState<number | null>(0)\n\n  const selectedNodeRef = useRef<HTMLDivElement | null>(null)\n  useEffect(() => {\n    if (visible) {\n      // Whenever the profile select becomes visible...\n\n      // Clear any hovered element\n      setHoveredProfileIndex(null)\n\n      // And scroll the selected profile into view, if possible\n      if (selectedNodeRef.current !== null) {\n        selectedNodeRef.current.scrollIntoView({\n          behavior: 'auto',\n          block: 'nearest',\n          inline: 'nearest',\n        })\n      }\n    }\n  }, [visible])\n\n  // TODO(jlfwong): Hi-jacking the behavior of enter and the arrow keys won't\n  // work well for some composition methods (e.g. a Chinese character\n  // composition keyboard input method).\n  const onFilterKeyUp = useCallback(\n    (ev: KeyboardEvent) => {\n      // Prevent the key-press from propagating to other keyboard shortcut\n      // handlers in other components.\n      ev.stopPropagation()\n\n      let newHoveredIndexInFilteredList: number | null = null\n\n      switch (ev.key) {\n        case 'Enter': {\n          if (hoveredProfileIndex != null) {\n            closeProfileSelect()\n            setProfileIndexToView(hoveredProfileIndex)\n          }\n          break\n        }\n        case 'Escape': {\n          closeProfileSelect()\n          break\n        }\n        case 'ArrowDown': {\n          ev.preventDefault()\n          newHoveredIndexInFilteredList = 0\n          if (hoveredProfileIndex != null) {\n            const indexInFilteredList = filteredProfiles.findIndex(\n              p => p.indexInProfileGroup === hoveredProfileIndex,\n            )\n            if (indexInFilteredList !== -1) {\n              newHoveredIndexInFilteredList = indexInFilteredList + 1\n            }\n          }\n          break\n        }\n        case 'ArrowUp': {\n          ev.preventDefault()\n          newHoveredIndexInFilteredList = filteredProfiles.length - 1\n          if (hoveredProfileIndex != null) {\n            const indexInFilteredList = filteredProfiles.findIndex(\n              p => p.indexInProfileGroup === hoveredProfileIndex,\n            )\n            if (indexInFilteredList !== -1) {\n              newHoveredIndexInFilteredList = indexInFilteredList - 1\n            }\n          }\n          break\n        }\n      }\n\n      if (\n        newHoveredIndexInFilteredList != null &&\n        newHoveredIndexInFilteredList >= 0 &&\n        newHoveredIndexInFilteredList < filteredProfiles.length\n      ) {\n        const indexInProfileGroup =\n          filteredProfiles[newHoveredIndexInFilteredList].indexInProfileGroup\n        setHoveredProfileIndex(indexInProfileGroup)\n        setPendingForcedScroll(true)\n      }\n    },\n    [closeProfileSelect, setProfileIndexToView, hoveredProfileIndex, filteredProfiles],\n  )\n\n  const [pendingForcedScroll, setPendingForcedScroll] = useState(false)\n  useEffect(() => {\n    // Whenever the list of filtered profiles changes, set the first element hovered.\n    if (filteredProfiles.length > 0) {\n      setHoveredProfileIndex(filteredProfiles[0].indexInProfileGroup)\n      setPendingForcedScroll(true)\n    }\n  }, [setHoveredProfileIndex, filteredProfiles])\n\n  const hoveredNodeRef = useCallback(\n    (hoveredNode: HTMLDivElement | null) => {\n      if (pendingForcedScroll && hoveredNode) {\n        hoveredNode.scrollIntoView({\n          behavior: 'auto',\n          block: 'nearest',\n          inline: 'nearest',\n        })\n        setPendingForcedScroll(false)\n      }\n    },\n    [pendingForcedScroll, setPendingForcedScroll],\n  )\n\n  const selectedHoveredRef = useCallback(\n    (node: HTMLDivElement | null) => {\n      selectedNodeRef.current = node\n      hoveredNodeRef(node)\n    },\n    [selectedNodeRef, hoveredNodeRef],\n  )\n\n  // We allow ProfileSelect to be aware of its own visibility in order to retain\n  // its scroll offset state between times when it's hidden & shown, and also to\n  // scroll the selected node into view once it becomes shown again after the\n  // selected profile has changed.\n  return (\n    <div className={css(style.profileSelectOuter)}>\n      <div className={css(style.caret)} />\n      <div className={css(style.profileSelectBox)}>\n        {/* We stop event propagation for key events on the input to prevent\n            this from triggering keyboard shortcuts. */}\n        <div className={css(style.filterInputContainer)}>\n          <input\n            type=\"text\"\n            className={css(style.filterInput)}\n            ref={focusFilterInput}\n            placeholder={'Filter...'}\n            value={filterText}\n            onInput={onFilterTextChange}\n            onKeyDown={onFilterKeyUp}\n            onKeyUp={stopPropagation}\n            onKeyPress={stopPropagation}\n          />\n        </div>\n        <div className={css(style.profileSelectScrolling)}>\n          {filteredProfiles.map(({profile, matchedRanges, indexInProfileGroup}, indexInList) => {\n            let ref: Ref<HTMLDivElement> | undefined = undefined\n            const selected = indexInProfileGroup === indexToView\n            const hovered = indexInProfileGroup === hoveredProfileIndex\n            if (selected && hovered) {\n              ref = selectedHoveredRef\n            } else if (selected) {\n              ref = selectedNodeRef\n            } else if (hovered) {\n              ref = hoveredNodeRef\n            }\n            return (\n              <ProfileSelectRow\n                setHoveredProfileIndex={setHoveredProfileIndex}\n                indexInProfileGroup={indexInProfileGroup}\n                indexInFilteredListView={indexInList}\n                hovered={indexInProfileGroup == hoveredProfileIndex}\n                selected={indexInProfileGroup === indexToView}\n                profile={profile}\n                profileCount={profiles.length}\n                nodeRef={ref}\n                matchedRanges={matchedRanges}\n                setProfileIndexToView={setProfileIndexToView}\n                closeProfileSelect={closeProfileSelect}\n              />\n            )\n          })}\n          {filteredProfiles.length === 0 ? (\n            <div className={css(style.profileRow)}>No results match filter \"{filterText}\"</div>\n          ) : null}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nconst paddingHeight = 10\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    filterInputContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: 5,\n      alignItems: 'stretch',\n    },\n    filterInput: {\n      color: theme.altFgPrimaryColor,\n      background: theme.altBgSecondaryColor,\n      borderRadius: 5,\n      padding: 5,\n      ':focus': {\n        border: 'none',\n        outline: 'none',\n      },\n      '::selection': {\n        color: theme.altFgPrimaryColor,\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    caret: {\n      width: 0,\n      height: 0,\n      borderLeft: '5px solid transparent',\n      borderRight: '5px solid transparent',\n      borderBottom: '5px solid black',\n    },\n    highlighted: {\n      background: theme.selectionSecondaryColor,\n    },\n    padding: {\n      height: paddingHeight,\n      background: theme.altBgPrimaryColor,\n    },\n    profileRow: {\n      height: Sizes.FRAME_HEIGHT - 2,\n      border: '1px solid transparent',\n      textAlign: 'left',\n      paddingLeft: 10,\n      paddingRight: 10,\n      background: theme.altBgPrimaryColor,\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n      cursor: 'pointer',\n    },\n    profileRowHovered: {\n      border: `1px solid ${theme.selectionPrimaryColor}`,\n    },\n    profileRowSelected: {\n      background: theme.selectionPrimaryColor,\n    },\n    profileRowEven: {\n      background: theme.altBgSecondaryColor,\n    },\n    profileSelectScrolling: {\n      maxHeight: `min(calc(100vh - ${Sizes.TOOLBAR_HEIGHT - 2 * paddingHeight}px), ${\n        20 * Sizes.FRAME_HEIGHT\n      }px)`,\n      overflow: 'auto',\n      '::-webkit-scrollbar': {\n        background: theme.altBgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.altFgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.altBgPrimaryColor}`,\n        ':hover': {\n          background: theme.altBgPrimaryColor,\n        },\n      },\n    },\n    profileSelectBox: {\n      width: '100%',\n      paddingBottom: 10,\n      background: theme.altBgPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    profileSelectOuter: {\n      width: '100%',\n      maxWidth: 480,\n      margin: '0 auto',\n      position: 'relative',\n      zIndex: ZIndex.PROFILE_SELECT,\n      alignItems: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    profileIndex: {\n      textAlign: 'right',\n      display: 'inline-block',\n      color: theme.altFgSecondaryColor,\n    },\n    profileIndexSelected: {\n      color: theme.altFgPrimaryColor,\n    },\n  }),\n)\n","import {ApplicationProps} from './application'\nimport {h, JSX, Fragment} from 'preact'\nimport {useCallback, useState, useEffect} from 'preact/hooks'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Sizes, FontFamily, FontSize, Duration} from './style'\nimport {ProfileSelect} from './profile-select'\nimport {Profile} from '../lib/profile'\nimport {objectsHaveShallowEquality} from '../lib/utils'\nimport {colorSchemeToString, useTheme, withTheme} from './themes/theme'\nimport {ViewMode} from '../lib/view-mode'\nimport {viewModeAtom} from '../app-state'\nimport {ProfileGroupState} from '../app-state/profile-group'\nimport {colorSchemeAtom} from '../app-state/color-scheme'\nimport {useAtom} from '../lib/atom'\n\ninterface ToolbarProps extends ApplicationProps {\n  browseForFile(): void\n  saveFile(): void\n}\n\nfunction useSetViewMode(setViewMode: (viewMode: ViewMode) => void, viewMode: ViewMode) {\n  return useCallback(() => setViewMode(viewMode), [setViewMode, viewMode])\n}\n\nfunction ToolbarLeftContent(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  const setChronoFlameChart = useSetViewMode(viewModeAtom.set, ViewMode.CHRONO_FLAME_CHART)\n  const setLeftHeavyFlameGraph = useSetViewMode(viewModeAtom.set, ViewMode.LEFT_HEAVY_FLAME_GRAPH)\n  const setSandwichView = useSetViewMode(viewModeAtom.set, ViewMode.SANDWICH_VIEW)\n  const setCompareView = useSetViewMode(viewModeAtom.set, ViewMode.COMPARE_VIEW)\n\n  if (!props.activeProfileState) return null\n\n  return (\n    <div className={css(style.toolbarLeft)}>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.CHRONO_FLAME_CHART && style.toolbarTabActive,\n        )}\n        onClick={setChronoFlameChart}\n      >\n        <span className={css(style.emoji)}></span>Time Order\n      </div>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.LEFT_HEAVY_FLAME_GRAPH && style.toolbarTabActive,\n        )}\n        onClick={setLeftHeavyFlameGraph}\n      >\n        <span className={css(style.emoji)}></span>Left Heavy\n      </div>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.SANDWICH_VIEW && style.toolbarTabActive,\n        )}\n        onClick={setSandwichView}\n      >\n        <span className={css(style.emoji)}></span>Sandwich\n      </div>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.COMPARE_VIEW && style.toolbarTabActive,\n        )}\n        onClick={setCompareView}\n      >\n        <span className={css(style.emojiBalance)}></span>Compare\n      </div>\n    </div>\n  )\n}\n\nconst getCachedProfileList = (() => {\n  // TODO(jlfwong): It would be nice to just implement this as useMemo, but if\n  // we do that using profileGroup or profileGroup.profiles as the cache key,\n  // then it will invalidate whenever *anything* changes, because\n  // profileGroup.profiles is ProfileState[], which contains component state\n  // information for each tab for each profile. So whenever any property in any\n  // persisted view state changes for *any* view in *any* profile, the profiles\n  // list will get re-generated.\n  let cachedProfileList: Profile[] | null = null\n\n  return (profileGroup: ProfileGroupState): Profile[] | null => {\n    let nextProfileList = profileGroup?.profiles.map(p => p.profile) || null\n\n    if (\n      cachedProfileList === null ||\n      (nextProfileList != null && !objectsHaveShallowEquality(cachedProfileList, nextProfileList))\n    ) {\n      cachedProfileList = nextProfileList\n    }\n\n    return cachedProfileList\n  }\n})()\n\nfunction ToolbarCenterContent(props: ToolbarProps): JSX.Element {\n  const style = getStyle(useTheme())\n\n  const {activeProfileState, profileGroup} = props\n  const profiles = getCachedProfileList(profileGroup)\n  const [profileSelectShown, setProfileSelectShown] = useState(false)\n\n  const openProfileSelect = useCallback(() => {\n    setProfileSelectShown(true)\n  }, [setProfileSelectShown])\n\n  const closeProfileSelect = useCallback(() => {\n    setProfileSelectShown(false)\n  }, [setProfileSelectShown])\n\n  useEffect(() => {\n    const onWindowKeyPress = (ev: KeyboardEvent) => {\n      if (ev.key === 't') {\n        ev.preventDefault()\n        setProfileSelectShown(true)\n      }\n    }\n    window.addEventListener('keypress', onWindowKeyPress)\n    return () => {\n      window.removeEventListener('keypress', onWindowKeyPress)\n    }\n  }, [setProfileSelectShown])\n\n  useEffect(() => {\n    const onWindowKeyPress = (ev: KeyboardEvent) => {\n      if (ev.key === 't') {\n        ev.preventDefault()\n        setProfileSelectShown(true)\n      }\n    }\n    window.addEventListener('keypress', onWindowKeyPress)\n    return () => {\n      window.removeEventListener('keypress', onWindowKeyPress)\n    }\n  }, [setProfileSelectShown])\n\n  if (activeProfileState && profileGroup && profiles) {\n    if (profileGroup.profiles.length === 1) {\n      return <Fragment>{activeProfileState.profile.getName()}</Fragment>\n    } else {\n      return (\n        <div className={css(style.toolbarCenter)} onMouseLeave={closeProfileSelect}>\n          <span onMouseOver={openProfileSelect}>\n            {activeProfileState.profile.getName()}{' '}\n            <span className={css(style.toolbarProfileIndex)}>\n              ({activeProfileState.index + 1}/{profileGroup.profiles.length})\n            </span>\n          </span>\n          <div style={{display: profileSelectShown ? 'block' : 'none'}}>\n            <ProfileSelect\n              setProfileIndexToView={props.setProfileIndexToView}\n              indexToView={profileGroup.indexToView}\n              profiles={profiles}\n              closeProfileSelect={closeProfileSelect}\n              visible={profileSelectShown}\n            />\n          </div>\n        </div>\n      )\n    }\n  }\n  return <Fragment>{'speedscope'}</Fragment>\n}\n\nfunction ToolbarRightContent(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  const colorScheme = useAtom(colorSchemeAtom)\n\n  const exportFile = (\n    <div className={css(style.toolbarTab)} onClick={props.saveFile}>\n      <span className={css(style.emoji)}></span>Export\n    </div>\n  )\n  const importFile = (\n    <div className={css(style.toolbarTab)} onClick={props.browseForFile}>\n      <span className={css(style.emoji)}></span>Import\n    </div>\n  )\n\n  const colorSchemeToggle = (\n    <div className={css(style.toolbarTab)} onClick={colorSchemeAtom.cycleToNextColorScheme}>\n      <span className={css(style.emoji)}></span>\n      <span className={css(style.toolbarTabColorSchemeToggle)}>\n        {colorSchemeToString(colorScheme)}\n      </span>\n    </div>\n  )\n\n  const help = (\n    <div className={css(style.toolbarTab)}>\n      <a\n        href=\"https://github.com/jlfwong/speedscope#usage\"\n        className={css(style.noLinkStyle)}\n        target=\"_blank\"\n      >\n        <span className={css(style.emoji)}></span>Help\n      </a>\n    </div>\n  )\n\n  return (\n    <div className={css(style.toolbarRight)}>\n      {props.activeProfileState && exportFile}\n      {importFile}\n      {colorSchemeToggle}\n      {help}\n    </div>\n  )\n}\n\nexport function Toolbar(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  return (\n    <div className={css(style.toolbar)}>\n      <ToolbarLeftContent {...props} />\n      <ToolbarCenterContent {...props} />\n      <ToolbarRightContent {...props} />\n    </div>\n  )\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    toolbar: {\n      height: Sizes.TOOLBAR_HEIGHT,\n      flexShrink: 0,\n      background: theme.altBgPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      textAlign: 'center',\n      fontFamily: FontFamily.MONOSPACE,\n      fontSize: FontSize.TITLE,\n      lineHeight: `${Sizes.TOOLBAR_TAB_HEIGHT}px`,\n      userSelect: 'none',\n    },\n    toolbarLeft: {\n      position: 'absolute',\n      height: Sizes.TOOLBAR_HEIGHT,\n      overflow: 'hidden',\n      top: 0,\n      left: 0,\n      marginRight: 2,\n      textAlign: 'left',\n    },\n    toolbarCenter: {\n      paddingTop: 1,\n      height: Sizes.TOOLBAR_HEIGHT,\n    },\n    toolbarRight: {\n      height: Sizes.TOOLBAR_HEIGHT,\n      overflow: 'hidden',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      marginRight: 2,\n      textAlign: 'right',\n    },\n    toolbarProfileIndex: {\n      color: theme.altFgSecondaryColor,\n    },\n    toolbarTab: {\n      background: theme.altBgSecondaryColor,\n      marginTop: Sizes.SEPARATOR_HEIGHT,\n      height: Sizes.TOOLBAR_TAB_HEIGHT,\n      lineHeight: `${Sizes.TOOLBAR_TAB_HEIGHT}px`,\n      paddingLeft: 2,\n      paddingRight: 8,\n      display: 'inline-block',\n      marginLeft: 2,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n    toolbarTabActive: {\n      background: theme.selectionPrimaryColor,\n      ':hover': {\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    toolbarTabColorSchemeToggle: {\n      display: 'inline-block',\n      textAlign: 'center',\n      minWidth: '50px',\n    },\n    emoji: {\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      paddingTop: '0px',\n      marginRight: '0.3em',\n    },\n    emojiBalance: {\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      paddingTop: '0px',\n      marginRight: '0.3em',\n      // TODO: This is jank\n      marginTop: '-6px',\n      fontSize: '19px',\n    },\n    noLinkStyle: {\n      textDecoration: 'none',\n      color: 'inherit',\n    },\n  }),\n)\n","// This file contains code to allow profiles to be remapped by JavaScript source maps.\n//\n// As of writing, this is using an out-of-date version of source-map, because the\n// source-map library migrated to using web-assembly. This requires loading the\n// web-assembly ball. The easiest way to do this is to load it from a third-party\n// URL, but I want speedscope to work standalone offline. This means that the remaining\n// options require some way of having a local URL that corresponds the .wasm file.\n//\n// Also as of writing, speedscope is bundled with Parcel v1. Trying to import\n// a .wasm file in Parcel v1 tries to load the wasm module itself, which is not\n// what I'm trying to do -- I want SourceMapConsumer.initialize to be the thing\n// booting the WebAssembly, not Parcel itself.\n//\n// One way of getting around this problem is to modify the build system to\n// copy the .wasm file from node_modules/source-map/lib/mappings.wasm. I could do\n// this, but it's a bit of a pain.\n//\n// Another would be to use something like\n// import(\"url:../node_modules/source-map/lib/mappings.wasm\"), and then pass the\n// resulting URL to SourceMapConsumer.initialize. This is also kind of a pain,\n// because I can only do that if I upgrade to Parcel v2. Ultimately, I'd like to\n// use esbuild rather than parcel at all, so for now I'm just punting on this by\n// using an old-version of source-map which doesn't depend on wasm.\n\n// This is rarely used, so let's load it async to avoid bloating the initial\n// bundle.\nimport type {MappingItem, RawSourceMap, SourceMapConsumer} from 'source-map'\nconst sourceMapModule = import('source-map')\n\nimport {Frame, SymbolRemapper} from './profile'\nimport {findIndexBisect} from './utils'\n\nconst DEBUG = false\n\nexport async function importJavaScriptSourceMapSymbolRemapper(\n  contentsString: string,\n  sourceMapFileName: string,\n): Promise<SymbolRemapper | null> {\n  const sourceMap = await sourceMapModule\n\n  let consumer: SourceMapConsumer | null = null\n  let contents: RawSourceMap | null = null\n\n  try {\n    contents = JSON.parse(contentsString)\n    consumer = new sourceMap.SourceMapConsumer(contents!)\n  } catch (e) {\n    return null\n  }\n\n  const mappingItems: MappingItem[] = []\n\n  consumer.eachMapping(\n    function (m: MappingItem) {\n      // The sourcemap library uses 1-based line numbers, and 0-based column\n      // numbers. speedscope uses 1-based line-numbers, and 1-based column\n      // numbers for its in-memory representation, so we'll normalize that\n      // here too.\n      mappingItems.push({\n        ...m,\n        generatedColumn: m.generatedColumn + 1,\n        originalColumn: m.originalColumn + 1,\n      })\n    },\n    {},\n\n    // We're going to binary search through these later, so make sure they're\n    // sorted by their order in the generated file.\n    sourceMap.SourceMapConsumer.GENERATED_ORDER,\n  )\n\n  const sourceMapFileNameWithoutExt = sourceMapFileName.replace(/\\.[^/]*$/, '')\n\n  return (frame: Frame) => {\n    let fileMatches = false\n    if (contents?.file && contents?.file === frame.file) {\n      fileMatches = true\n    } else if (\n      ('/' + frame.file?.replace(/\\.[^/]*$/, '')).endsWith('/' + sourceMapFileNameWithoutExt)\n    ) {\n      fileMatches = true\n    }\n    if (!fileMatches) {\n      // The source-map doesn't apply to the file this frame is defined in.\n      return null\n    }\n\n    if (frame.line == null || frame.col == null) {\n      // If we don't have a line & column number for the frame, we can't\n      // remap it.\n      return null\n    }\n\n    // If we got here, then we hopefully have an remapping.\n    //\n    // Ideally, we'd look up a symbol whose generatedLine & generatedColumn\n    // match what we have in our profile, but unfortunately browsers don't do\n    // this.\n    //\n    // Browsers set the column number for a function to the index of the\n    // opening paren for the argument list, rather than the beginning of the\n    // index of the name.\n    //\n    // function alpha() { ... }\n    //               ^\n    //\n    // const beta = function() { ... }\n    //                      ^\n    //\n    // const gamma = () => { ... }\n    //               ^\n    //\n    // Since we don't have the source code being profiled, we unfortunately\n    // can't normalize this to set the column to the first character of the\n    // actual name.\n    //\n    // To work around this limitation, we'll search backwards from the first\n    // mapping whose generatedLine & generatedColumn are beyond the location\n    // in the profile.\n    let mappingIndex = findIndexBisect(mappingItems, m => {\n      if (m.generatedLine > frame.line!) return true\n      if (m.generatedLine < frame.line!) return false\n      if (m.generatedColumn >= frame.col!) return true\n      return false\n    })\n\n    if (mappingIndex === -1) {\n      // There are no symbols following the given profile frame symbol, so try\n      // to apply the very last mapping.\n      mappingIndex = mappingItems.length - 1\n    } else if (mappingIndex === 0) {\n      // If the very first index in mappingItems is beyond the location in the\n      // profile, it means the name we're looking for doesn't have a\n      // corresponding entry in the source-map (this can happen if the\n      // source-map isn't the right source-map)\n      return null\n    } else {\n      mappingIndex--\n    }\n\n    const sourceMapItem = mappingItems[mappingIndex]\n    const remappedFrameInfo: {name?: string; file?: string; line?: number; col?: number} = {}\n\n    if (sourceMapItem.name != null) {\n      remappedFrameInfo.name = sourceMapItem.name\n    } else if (sourceMapItem.source != null) {\n      // HACK: If the item name isn't specified, but the source is present, then\n      // we're going to try to guess what the name is by using the originalLine\n      // and originalColumn.\n\n      // The second argument here is \"returnNullOnMissing\". Without this, it\n      // throws instead of returning null.\n      const content = consumer?.sourceContentFor(sourceMapItem.source, true)\n      if (content) {\n        const lines = content.split('\\n')\n        const line = lines[sourceMapItem.originalLine - 1]\n        if (line) {\n          // It's possible this source map entry will contain stuff other than\n          // the name, so let's only consider word-ish characters that are part\n          // of the prefix.\n          const identifierMatch = /\\w+/.exec(line.substr(sourceMapItem.originalColumn - 1))\n          if (identifierMatch) {\n            remappedFrameInfo.name = identifierMatch[0]\n          }\n        }\n      }\n    }\n\n    switch (remappedFrameInfo.name) {\n      case 'constructor': {\n        // If the name was remapped to \"constructor\", then let's use the\n        // original name, since \"constructor\" isn't very helpful.\n        //\n        // TODO(jlfwong): Search backwards for the class keyword and see if we\n        // can guess the right name.\n        remappedFrameInfo.name = frame.name + ' constructor'\n        break\n      }\n\n      case 'function': {\n        // If the name is just \"function\", it probably means we either messed up\n        // the remapping, or that we matched an anonymous function. In either\n        // case, this isn't helpful, so put this back.\n        remappedFrameInfo.name = frame.name\n        break\n      }\n\n      case 'const':\n      case 'export': {\n        // If we got this, we probably just did a bad job leveraging the hack\n        // looking through the source code. Let's fall-back to whatever the\n        // original name was.\n        remappedFrameInfo.name = frame.name\n        break\n      }\n    }\n\n    if (remappedFrameInfo.name && frame.name.includes(remappedFrameInfo.name)) {\n      // If the remapped name is a substring of the original name, the original\n      // name probably contains more useful information. In that case, just use\n      // the original name instead.\n      //\n      // This can happen, for example, when remapping method names. If a\n      // call stack says the symbol name is \"n.zap\" and we remapped it to a\n      // function just called \"zap\", we might as well use the original name\n      // instead.\n      remappedFrameInfo.name = frame.name\n    }\n\n    if (sourceMapItem.source != null) {\n      remappedFrameInfo.file = sourceMapItem.source\n      remappedFrameInfo.line = sourceMapItem.originalLine\n      remappedFrameInfo.col = sourceMapItem.originalColumn\n    }\n\n    if (DEBUG) {\n      console.groupCollapsed(`Remapping \"${frame.name}\" -> \"${remappedFrameInfo.name}\"`)\n      console.log('before', {...frame})\n      console.log('item @ index', sourceMapItem)\n      console.log('item @ index + 1', mappingItems[mappingIndex + 1])\n      console.log('after', remappedFrameInfo)\n      console.groupEnd()\n    }\n\n    return remappedFrameInfo\n  }\n}\n","import {Frame, Profile} from './profile'\n\nfunction getFrameDifference(beforeFrame: Frame | undefined, afterFrame: Frame | undefined) {\n  // Don't show difference in root time\n  if (beforeFrame?.name === '[root]') {\n    return {\n      selfWeightDiff: 0,\n      totalWeightDiff: 0,\n      selfWeightPercentIncrease: 0,\n      totalWeightPercentIncrease: 0,\n    }\n  }\n\n  const beforeTotalWeight = beforeFrame?.getTotalWeight() || 0\n  const beforeSelfWeight = beforeFrame?.getSelfWeight() || 0\n\n  const afterTotalWeight = afterFrame?.getTotalWeight() || 0\n  const afterSelfWeight = afterFrame?.getSelfWeight() || 0\n\n  const selfWeightDiff = afterSelfWeight - beforeSelfWeight\n  const totalWeightDiff = afterTotalWeight - beforeTotalWeight\n\n  // Calculate percentage increases, handling division by zero\n  const selfWeightPercentIncrease = beforeSelfWeight !== 0 ? selfWeightDiff / beforeSelfWeight : 0\n  const totalWeightPercentIncrease =\n    beforeTotalWeight !== 0 ? totalWeightDiff / beforeTotalWeight : 0\n\n  return {\n    selfWeightDiff,\n    totalWeightDiff,\n    selfWeightPercentIncrease,\n    totalWeightPercentIncrease,\n  }\n}\n\nexport type FrameDiff = {\n  beforeFrame: Frame | undefined\n  afterFrame: Frame | undefined\n  selfWeightDiff: number\n  selfWeightPercentIncrease: number\n  totalWeightDiff: number\n  totalWeightPercentIncrease: number\n}\n\nexport function getFrameFromFrameDiff({beforeFrame, afterFrame}: FrameDiff): Frame {\n  const frame = beforeFrame ?? afterFrame\n  if (!frame) {\n    throw new Error('before or after frame must be present')\n  }\n\n  return frame\n}\n\n// TODO: Memoize\nexport function getFrameDiffs(beforeProfile: Profile, afterProfile: Profile): FrameDiff[] {\n  const afterKeyMap = afterProfile.getKeyToFrameMap()\n  const afterNameMap = afterProfile.getNameToFrameMap()\n\n  const frameDiffs: FrameDiff[] = []\n\n  /**\n   * Find the frame in the after profile we think most likely matches the frame\n   * in the before profile, first by key, and then by name if we don't have a key\n   * match. For now we just ignore functions where we don't have a name\n   */\n  function getMatchingFrame(frame: Frame) {\n    const afterFrame = afterKeyMap.get(frame.key)\n\n    if (afterFrame) return afterFrame\n\n    // If we don't have a key match and it is an anonymous function, we just\n    // return for now, since we don't have a good way of matching the frames.\n    // In the future we could use the string similarities between keys or some\n    // heuristic like that\n    if (['anonymous', '(unnamed)'].includes(frame.name)) {\n      return\n    }\n\n    const framesByName = afterNameMap.get(frame.name) || []\n\n    return framesByName[0]\n  }\n\n  const visitedAfterFrameKeys = new Set<string | number>()\n\n  beforeProfile.forEachFrame(beforeFrame => {\n    // Attempt to find the frame that matches in the after profile\n    const afterFrame = getMatchingFrame(beforeFrame)\n\n    if (afterFrame) {\n      visitedAfterFrameKeys.add(afterFrame.key)\n    }\n\n    const {selfWeightDiff, totalWeightDiff, selfWeightPercentIncrease, totalWeightPercentIncrease} =\n      getFrameDifference(beforeFrame, afterFrame)\n\n    frameDiffs.push({\n      beforeFrame,\n      afterFrame,\n      selfWeightDiff,\n      totalWeightDiff,\n      selfWeightPercentIncrease,\n      totalWeightPercentIncrease,\n    })\n  })\n\n  // Also include the afterProfile frames that were not present in the beforeProfile\n  // TODO: Can probably clean this logic up a bit\n  afterProfile.forEachFrame(afterFrame => {\n    if (visitedAfterFrameKeys.has(afterFrame.key)) return\n\n    console.log(afterFrame)\n\n    const {selfWeightDiff, totalWeightDiff, selfWeightPercentIncrease, totalWeightPercentIncrease} =\n      getFrameDifference(undefined, afterFrame)\n\n    frameDiffs.push({\n      beforeFrame: undefined,\n      afterFrame,\n      selfWeightDiff,\n      totalWeightDiff,\n      selfWeightPercentIncrease,\n      totalWeightPercentIncrease,\n    })\n  })\n\n  return frameDiffs\n}\n","import {h, JSX, ComponentChild} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Profile, Frame} from '../lib/profile'\nimport {formatPercent, sortBy} from '../lib/utils'\nimport {FontSize, Sizes, commonStyle} from './style'\nimport {ColorChit} from './color-chit'\nimport {ListItem, ScrollableListView} from './scrollable-list-view'\nimport {createGetCSSColorForFrame, getFrameToColorBucket} from '../app-state/getters'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext, useState} from 'preact/hooks'\nimport {SandwichViewContext} from './sandwich-view'\nimport {Color} from '../lib/color'\nimport {Theme, useTheme, withTheme} from './themes/theme'\nimport {\n  SortDirection,\n  profileGroupAtom,\n  searchIsActiveAtom,\n  searchQueryAtom,\n  CompareSortField,\n  CompareSortMethod,\n  compareProfileGroupAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {ProfileSearchContext} from './search-view'\nimport {FrameDiff, getFrameFromFrameDiff} from '../lib/frameDiffs'\n\ninterface HBarProps {\n  percent: number\n}\n\nfunction HBarDisplay({percent}: HBarProps) {\n  const style = getStyle(useTheme())\n\n  const absolutePercent = Math.min(100, Math.abs(percent))\n  const hBarStyle = percent < 0 ? style.hBarStylePositive : style.hBarStyleNegative\n\n  return (\n    <div className={css(style.hBarDisplay)}>\n      <div\n        className={css(style.hBarDisplayFilled, hBarStyle)}\n        style={{width: `${absolutePercent}%`}}\n      />\n    </div>\n  )\n}\n\ninterface SortIconProps {\n  activeDirection: SortDirection | null\n}\n\nfunction SortIcon(props: SortIconProps) {\n  const theme = useTheme()\n  const style = getStyle(theme)\n\n  const {activeDirection} = props\n  const upFill =\n    activeDirection === SortDirection.ASCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n  const downFill =\n    activeDirection === SortDirection.DESCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n\n  return (\n    <svg\n      width=\"8\"\n      height=\"10\"\n      viewBox=\"0 0 8 10\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={css(style.sortIcon)}\n    >\n      <path d=\"M0 4L4 0L8 4H0Z\" fill={upFill} />\n      <path d=\"M0 4L4 0L8 4H0Z\" transform=\"translate(0 10) scale(1 -1)\" fill={downFill} />\n    </svg>\n  )\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nfunction getCSSColorForDiff(diff: number, theme: Theme): string {\n  if (diff > 0) return theme.negative\n  if (diff < 0) return theme.positive\n  return 'gray'\n}\n\ninterface CompareTableRowViewProps {\n  frameDiff: FrameDiff\n  matchedRanges: [number, number][] | null\n  index: number\n  profile: Profile\n  selectedFrame: Frame | undefined\n  setSelectedDiff: (f: FrameDiff) => void\n  getCSSColorForFrame: (frame: Frame) => string\n  // TODO: These names are a bit unclear\n  selfPercent: number\n  totalPercent: number\n}\n\nconst CompareTableRowView = ({\n  frameDiff,\n  matchedRanges,\n  profile,\n  index,\n  selectedFrame,\n  setSelectedDiff,\n  selfPercent,\n  totalPercent,\n}: CompareTableRowViewProps) => {\n  const theme = useTheme()\n  const style = getStyle(theme)\n  const {totalWeightDiff, totalWeightPercentIncrease, selfWeightDiff, selfWeightPercentIncrease} =\n    frameDiff\n\n  const frame = useMemo(() => {\n    return getFrameFromFrameDiff(frameDiff)\n  }, [frameDiff])\n\n  const selected = frame === selectedFrame\n\n  return (\n    <tr\n      key={`${frame.key}`}\n      onClick={setSelectedDiff.bind(null, frameDiff)}\n      className={css(\n        style.tableRow,\n        index % 2 == 0 && style.tableRowEven,\n        selected && style.tableRowSelected,\n      )}\n    >\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(totalWeightDiff)} (\n        {formatPercent(Math.abs(totalWeightPercentIncrease * 100))})\n        <HBarDisplay percent={totalPercent} />\n      </td>\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(selfWeightDiff)} (\n        {formatPercent(Math.abs(selfWeightPercentIncrease * 100))})\n        <HBarDisplay percent={selfPercent} />\n      </td>\n      <td title={frame.file} className={css(style.textCell)}>\n        <ColorChit color={getCSSColorForDiff(totalWeightDiff, theme)} />\n        {matchedRanges\n          ? highlightRanges(\n              frame.name,\n              matchedRanges,\n              css(style.matched, selected && style.matchedSelected),\n            )\n          : frame.name}\n      </td>\n    </tr>\n  )\n}\n\ninterface CompareTableViewProps {\n  profile: Profile\n  frameDiffs: FrameDiff[]\n  selectedFrame: Frame | undefined\n  getCSSColorForFrame: (frame: Frame) => string\n  sortMethod: CompareSortMethod\n  setSelectedDiff: (frame: FrameDiff | null) => void\n  setSortMethod: (sortMethod: CompareSortMethod) => void\n  searchQuery: string\n  searchIsActive: boolean\n}\n\nexport const CompareTableView = memo(\n  ({\n    profile,\n    sortMethod,\n    setSortMethod,\n    selectedFrame,\n    setSelectedDiff,\n    getCSSColorForFrame,\n    searchQuery,\n    searchIsActive,\n    frameDiffs,\n  }: CompareTableViewProps) => {\n    const style = getStyle(useTheme())\n\n    const largestTotalDiff = useMemo(() => {\n      return frameDiffs.reduce((acc, diff) => Math.max(Math.abs(diff.totalWeightDiff), acc), 0)\n    }, [frameDiffs])\n\n    const largestSelfDiff = useMemo(() => {\n      return frameDiffs.reduce((acc, diff) => Math.max(Math.abs(diff.selfWeightDiff), acc), 0)\n    }, [frameDiffs])\n\n    const onSortClick = useCallback(\n      (field: CompareSortField, ev: MouseEvent) => {\n        ev.preventDefault()\n\n        if (sortMethod.field == field) {\n          // Toggle\n          setSortMethod({\n            field,\n            direction:\n              sortMethod.direction === SortDirection.ASCENDING\n                ? SortDirection.DESCENDING\n                : SortDirection.ASCENDING,\n          })\n        } else {\n          // Set a sane default\n          switch (field) {\n            case CompareSortField.SYMBOL_NAME: {\n              setSortMethod({field, direction: SortDirection.ASCENDING})\n              break\n            }\n            case CompareSortField.SELF_CHANGE:\n            case CompareSortField.TOTAL_CHANGE: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n          }\n        }\n      },\n      [sortMethod, setSortMethod],\n    )\n\n    const sandwichContext = useContext(SandwichViewContext)\n\n    const renderItems = useCallback(\n      (firstIndex: number, lastIndex: number) => {\n        if (!sandwichContext) return null\n\n        const rows: JSX.Element[] = []\n\n        for (let i = firstIndex; i <= lastIndex; i++) {\n          const frameDiff = frameDiffs[i]\n          const frame = getFrameFromFrameDiff(frameDiff)\n          const match = sandwichContext.getSearchMatchForFrame(frame)\n\n          rows.push(\n            CompareTableRowView({\n              frameDiff,\n              matchedRanges: match == null ? null : match,\n              index: i,\n              profile: profile,\n              selectedFrame,\n              setSelectedDiff,\n              getCSSColorForFrame: getCSSColorForFrame,\n              totalPercent: (frameDiff.totalWeightDiff / largestTotalDiff) * 100,\n              selfPercent: (frameDiff.selfWeightDiff / largestSelfDiff) * 100,\n            }),\n          )\n        }\n\n        if (rows.length === 0) {\n          if (searchIsActive) {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>\n                  No symbol names match query \"{searchQuery}\".\n                </td>\n              </tr>,\n            )\n          } else {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>No symbols found.</td>\n              </tr>,\n            )\n          }\n        }\n\n        return <table className={css(style.tableView)}>{rows}</table>\n      },\n      [\n        frameDiffs,\n        sandwichContext,\n        profile,\n        selectedFrame,\n        setSelectedDiff,\n        getCSSColorForFrame,\n        searchIsActive,\n        searchQuery,\n        style.emptyState,\n        style.tableView,\n        largestSelfDiff,\n        largestTotalDiff,\n      ],\n    )\n\n    const listItems: ListItem[] = useMemo(\n      () => frameDiffs.map(() => ({size: Sizes.FRAME_HEIGHT})),\n      [frameDiffs],\n    )\n\n    const onTotalClick = useCallback(\n      (ev: MouseEvent) => onSortClick(CompareSortField.TOTAL_CHANGE, ev),\n      [onSortClick],\n    )\n    const onSelfClick = useCallback(\n      (ev: MouseEvent) => onSortClick(CompareSortField.SELF_CHANGE, ev),\n      [onSortClick],\n    )\n    const onSymbolNameClick = useCallback(\n      (ev: MouseEvent) => onSortClick(CompareSortField.SYMBOL_NAME, ev),\n      [onSortClick],\n    )\n\n    return (\n      <div className={css(commonStyle.vbox, style.profileTableView)}>\n        <table className={css(style.tableView)}>\n          <thead className={css(style.tableHeader)}>\n            <tr>\n              <th className={css(style.numericCell)} onClick={onTotalClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === CompareSortField.TOTAL_CHANGE ? sortMethod.direction : null\n                  }\n                />\n                Total Change\n              </th>\n              <th className={css(style.numericCell)} onClick={onSelfClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === CompareSortField.SELF_CHANGE ? sortMethod.direction : null\n                  }\n                />\n                Self Change\n              </th>\n              <th className={css(style.textCell)} onClick={onSymbolNameClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === CompareSortField.SYMBOL_NAME ? sortMethod.direction : null\n                  }\n                />\n                Symbol Name\n              </th>\n            </tr>\n          </thead>\n        </table>\n        <ScrollableListView\n          axis={'y'}\n          items={listItems}\n          className={css(style.scrollView)}\n          renderItems={renderItems}\n          initialIndexInView={\n            selectedFrame == null ? null : sandwichContext?.getIndexForFrame(selectedFrame)\n          }\n        />\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    profileTableView: {\n      background: theme.bgPrimaryColor,\n      height: '100%',\n    },\n    scrollView: {\n      overflowY: 'auto',\n      overflowX: 'hidden',\n      flexGrow: 1,\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    tableView: {\n      width: '100%',\n      fontSize: FontSize.LABEL,\n      background: theme.bgPrimaryColor,\n    },\n    tableHeader: {\n      borderBottom: `2px solid ${theme.bgSecondaryColor}`,\n      textAlign: 'left',\n      color: theme.fgPrimaryColor,\n      userSelect: 'none',\n    },\n    sortIcon: {\n      position: 'relative',\n      top: 1,\n      marginRight: Sizes.FRAME_HEIGHT / 4,\n    },\n    tableRow: {\n      background: theme.bgPrimaryColor,\n      height: Sizes.FRAME_HEIGHT,\n    },\n    tableRowEven: {\n      background: theme.bgSecondaryColor,\n    },\n    tableRowSelected: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    numericCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      position: 'relative',\n      textAlign: 'right',\n      paddingRight: Sizes.FRAME_HEIGHT,\n      width: 6 * Sizes.FRAME_HEIGHT,\n      minWidth: 6 * Sizes.FRAME_HEIGHT,\n    },\n    textCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      width: '100%',\n      maxWidth: 0,\n    },\n    hBarDisplay: {\n      position: 'absolute',\n      background: Color.fromCSSHex(theme.weightColor).withAlpha(0.2).toCSS(),\n      bottom: 2,\n      height: 2,\n      width: `calc(100% - ${2 * Sizes.FRAME_HEIGHT}px)`,\n      right: Sizes.FRAME_HEIGHT,\n    },\n    hBarDisplayFilled: {\n      height: '100%',\n      position: 'absolute',\n      right: 0,\n    },\n    hBarStylePositive: {\n      background: theme.positive,\n    },\n    hBarStyleNegative: {\n      background: theme.negative,\n    },\n    matched: {\n      borderBottom: `2px solid ${theme.fgPrimaryColor}`,\n    },\n    matchedSelected: {\n      borderColor: theme.altFgPrimaryColor,\n    },\n    emptyState: {\n      textAlign: 'center',\n      fontWeight: 'bold',\n    },\n  }),\n)\n\ninterface CompareTableViewContainerProps {\n  activeProfileState: ActiveProfileState\n  compareActiveProfileState: ActiveProfileState\n  frameDiffs: FrameDiff[]\n}\n\n// TODO: Deduplicate logic here\nexport const CompareTableViewContainer = memo((ownProps: CompareTableViewContainerProps) => {\n  const {activeProfileState, frameDiffs, compareActiveProfileState} = ownProps\n\n  const {profile, sandwichViewState} = activeProfileState\n  const {profile: compareProfile, sandwichViewState: compareSandwichViewState} =\n    compareActiveProfileState\n\n  const profileSearchResults = useContext(ProfileSearchContext)\n\n  const [sortMethod, setSortMethod] = useState({\n    field: CompareSortField.SELF_CHANGE,\n    direction: SortDirection.DESCENDING,\n  })\n\n  if (!profile || !compareProfile) throw new Error('profile missing')\n\n  const rowList: FrameDiff[] = useMemo(() => {\n    const rowList: FrameDiff[] = frameDiffs.filter(frameDiff => {\n      const frame = getFrameFromFrameDiff(frameDiff)\n      return !profileSearchResults || profileSearchResults.getMatchForFrame(frame)\n    })\n\n    switch (sortMethod.field) {\n      case CompareSortField.SYMBOL_NAME: {\n        sortBy(rowList, (frameDiff: FrameDiff) => {\n          const frame = getFrameFromFrameDiff(frameDiff)\n          return frame.name.toLowerCase()\n        })\n        break\n      }\n      case CompareSortField.TOTAL_CHANGE: {\n        sortBy(rowList, diff => Math.abs(diff.totalWeightDiff))\n        break\n      }\n      case CompareSortField.SELF_CHANGE: {\n        sortBy(rowList, diff => Math.abs(diff.selfWeightDiff))\n        break\n      }\n    }\n\n    if (sortMethod.direction === SortDirection.DESCENDING) {\n      rowList.reverse()\n    }\n\n    return rowList\n  }, [frameDiffs, sortMethod, profileSearchResults])\n\n  const theme = useTheme()\n\n  const {callerCallee: beforeCallerCallee} = sandwichViewState\n  const {callerCallee: afterCallerCallee} = compareSandwichViewState\n\n  const selectedFrame = beforeCallerCallee?.selectedFrame ?? afterCallerCallee?.selectedFrame\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const setSelectedDiff = useCallback((frameDiff: FrameDiff | null) => {\n    profileGroupAtom.setSelectedFrame(frameDiff?.beforeFrame ?? null)\n    compareProfileGroupAtom.setSelectedFrame(frameDiff?.afterFrame ?? null)\n  }, [])\n\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  return (\n    <CompareTableView\n      profile={profile}\n      frameDiffs={rowList}\n      selectedFrame={selectedFrame}\n      getCSSColorForFrame={getCSSColorForFrame}\n      sortMethod={sortMethod}\n      setSelectedDiff={setSelectedDiff}\n      setSortMethod={setSortMethod}\n      searchIsActive={searchIsActive}\n      searchQuery={searchQuery}\n    />\n  )\n})\n","import {JSX, h} from 'preact'\nimport {memo, useCallback, useContext, useEffect, useMemo} from 'preact/compat'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {useAtom} from '../lib/atom'\nimport {compareProfileGroupAtom, flattenRecursionAtom, profileGroupAtom} from '../app-state'\nimport {Theme, useTheme, withTheme} from './themes/theme'\nimport {Duration, FontSize, Sizes, commonStyle} from './style'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Frame} from '../lib/profile'\nimport {SandwichSearchView} from './sandwich-search-view'\nimport {CompareTableViewContainer} from './compare-table-view'\nimport {SandwichViewContext, SandwichViewContextData} from './sandwich-view'\nimport {ProfileSearchContext} from './search-view'\nimport {CalleeFlamegraphView, getCalleeProfile} from './callee-flamegraph-view'\nimport {getFrameDiffs} from '../lib/frameDiffs'\n\ntype CompareViewProps = {\n  selectedFrame: Frame | null\n  profileIndex: number\n  theme: Theme\n  activeProfileState: ActiveProfileState\n  compareActiveProfileState: ActiveProfileState\n  setSelectedFrame: (selectedFrame: Frame | null) => void\n}\n\nconst CompareView = memo(function CompareView({\n  activeProfileState,\n  compareActiveProfileState,\n  selectedFrame,\n  theme,\n}: CompareViewProps) {\n  // TODO: Abstract this into a hook\n  useEffect(() => {\n    function handleEscapeKeyPres(ev: KeyboardEvent) {\n      if (ev.key === 'Escape') {\n        profileGroupAtom.setSelectedFrame(null)\n        compareProfileGroupAtom.setSelectedFrame(null)\n      }\n    }\n\n    window.addEventListener('keydown', handleEscapeKeyPres)\n    return () => window.removeEventListener('keydown', handleEscapeKeyPres)\n  }, [])\n\n  const style = getStyle(theme)\n\n  const {beforeProfile, afterProfile} = useMemo(() => {\n    return {\n      beforeProfile: activeProfileState.profile,\n      afterProfile: compareActiveProfileState.profile,\n    }\n  }, [activeProfileState, compareActiveProfileState])\n\n  // TODO: Globally memoize?\n  const frameDiffs = useMemo(() => {\n    return getFrameDiffs(beforeProfile, afterProfile)\n  }, [beforeProfile, afterProfile])\n\n  let flamegraphViews: JSX.Element | null = null\n\n  const beforeCallerCallee = activeProfileState.sandwichViewState.callerCallee\n  const afterCallerCallee = compareActiveProfileState.sandwichViewState.callerCallee\n\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n\n  /**\n   * Set the total weight to be the maximum of the total weights of the two callee\n   * profiles so the two flamegraphs share the same timescale\n   */\n  const getTotalWeight = useCallback(() => {\n    let totalWeight = 0\n\n    if (beforeCallerCallee) {\n      const beforeCalleeProfile = getCalleeProfile({\n        profile: beforeProfile,\n        frame: beforeCallerCallee.selectedFrame,\n        flattenRecursion,\n      })\n\n      totalWeight = beforeCalleeProfile.getTotalNonIdleWeight()\n    }\n\n    if (afterCallerCallee) {\n      const afterCalleeProfile = getCalleeProfile({\n        profile: afterProfile,\n        frame: afterCallerCallee?.selectedFrame,\n        flattenRecursion,\n      })\n\n      const afterCalleeTotalWeight = afterCalleeProfile.getTotalNonIdleWeight()\n\n      return Math.max(totalWeight, afterCalleeTotalWeight)\n    }\n\n    return totalWeight\n  }, [beforeProfile, afterProfile, beforeCallerCallee, afterCallerCallee, flattenRecursion])\n\n  if (selectedFrame) {\n    flamegraphViews = (\n      <div className={css(commonStyle.fillY, style.callersAndCallees, commonStyle.vbox)}>\n        <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n          <div className={css(style.flamechartLabelParent)}>\n            <div className={css(style.flamechartLabel)}>Before</div>\n          </div>\n          {beforeCallerCallee && (\n            <CalleeFlamegraphView\n              profile={beforeProfile}\n              callerCallee={beforeCallerCallee}\n              getTotalWeight={getTotalWeight}\n              profileGroupAtom={profileGroupAtom}\n            />\n          )}\n        </div>\n        <div className={css(style.divider)} />\n        <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n          <div className={css(style.flamechartLabelParent, style.flamechartLabelParentBottom)}>\n            <div className={css(style.flamechartLabel, style.flamechartLabelBottom)}>After</div>\n          </div>\n          {afterCallerCallee && (\n            <CalleeFlamegraphView\n              profile={afterProfile}\n              callerCallee={afterCallerCallee}\n              getTotalWeight={getTotalWeight}\n              profileGroupAtom={compareProfileGroupAtom}\n            />\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={css(commonStyle.hbox, commonStyle.fillY)}>\n      <div className={css(style.tableView)}>\n        <CompareTableViewContainer\n          compareActiveProfileState={compareActiveProfileState}\n          activeProfileState={activeProfileState}\n          frameDiffs={frameDiffs}\n        />\n        <SandwichSearchView />\n      </div>\n      {flamegraphViews}\n    </div>\n  )\n})\n\ntype CompareViewContainerProps = {\n  activeProfileState: ActiveProfileState\n  compareActiveProfileState: ActiveProfileState | null\n  onFileSelect: (ev: Event) => void\n  glCanvas: HTMLCanvasElement\n}\n\nexport const CompareViewContainer = memo(\n  ({activeProfileState, compareActiveProfileState, onFileSelect}: CompareViewContainerProps) => {\n    const style = getStyle(useTheme())\n\n    // TODO: Dedupe this with compare-table-view\n    const {sandwichViewState, index} = activeProfileState\n    const theme = useTheme()\n\n    // TODO: Refactor this so that we can correctly determine which frame to set\n    // Right now I'm not sure this gets used\n    const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n      profileGroupAtom.setSelectedFrame(selectedFrame)\n    }, [])\n\n    const profileSearchResults = useContext(ProfileSearchContext)\n\n    const selectedFrame =\n      sandwichViewState.callerCallee?.selectedFrame ??\n      compareActiveProfileState?.sandwichViewState?.callerCallee?.selectedFrame ??\n      null\n\n    // TODO: Refactor this, right now it is unused but just needed to supply context\n    const rowList: Frame[] = useMemo(() => {\n      return []\n    }, [])\n\n    const getIndexForFrame: (frame: Frame) => number | null = useMemo(() => {\n      const indexByFrame = new Map<Frame, number>()\n      for (let i = 0; i < rowList.length; i++) {\n        indexByFrame.set(rowList[i], i)\n      }\n      return (frame: Frame) => {\n        const index = indexByFrame.get(frame)\n        return index == null ? null : index\n      }\n    }, [rowList])\n\n    const getSearchMatchForFrame: (frame: Frame) => [number, number][] | null = useMemo(() => {\n      return (frame: Frame) => {\n        if (profileSearchResults == null) return null\n        return profileSearchResults.getMatchForFrame(frame)\n      }\n    }, [profileSearchResults])\n\n    const contextData: SandwichViewContextData = useMemo(\n      () => ({\n        rowList,\n        selectedFrame,\n        setSelectedFrame,\n        getIndexForFrame,\n        getSearchMatchForFrame,\n      }),\n      [rowList, selectedFrame, setSelectedFrame, getIndexForFrame, getSearchMatchForFrame],\n    )\n\n    // TODO: Make the importing loading UI better with the progress bar\n    if (!compareActiveProfileState) {\n      return (\n        <div className={css(commonStyle.hbox, commonStyle.fillY, style.landingContainer)}>\n          <p className={css(style.landingP)}>Upload a second profile to compare</p>\n          <div className={css(style.browseButtonContainer)}>\n            <input\n              type=\"file\"\n              name=\"file\"\n              id=\"file\"\n              onChange={onFileSelect}\n              className={css(commonStyle.hide)}\n            />\n            <label for=\"file\" className={css(style.browseButton)} tabIndex={0}>\n              Browse\n            </label>\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <SandwichViewContext.Provider value={contextData}>\n        <CompareView\n          theme={theme}\n          activeProfileState={activeProfileState}\n          compareActiveProfileState={compareActiveProfileState}\n          setSelectedFrame={setSelectedFrame}\n          selectedFrame={selectedFrame}\n          profileIndex={index}\n        />\n      </SandwichViewContext.Provider>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    // Table styles:\n    tableView: {\n      position: 'relative',\n      flex: 1,\n    },\n    panZoomViewWraper: {\n      flex: 1,\n    },\n    flamechartLabelParent: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n      alignItems: 'flex-start',\n      fontSize: FontSize.TITLE,\n      width: FontSize.TITLE * 1.2,\n      borderRight: `1px solid ${theme.fgSecondaryColor}`,\n    },\n    flamechartLabelParentBottom: {\n      justifyContent: 'flex-start',\n    },\n    flamechartLabel: {\n      transform: 'rotate(-90deg)',\n      transformOrigin: '50% 50% 0',\n      width: FontSize.TITLE * 1.2,\n      flexShrink: 1,\n    },\n    flamechartLabelBottom: {\n      transform: 'rotate(-90deg)',\n      display: 'flex',\n      justifyContent: 'flex-end',\n    },\n    callersAndCallees: {\n      flex: 1,\n      borderLeft: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    divider: {\n      height: 2,\n      background: theme.fgSecondaryColor,\n    },\n    // Landing styles\n    landingContainer: {\n      background: theme.bgPrimaryColor,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flexDirection: 'column',\n      flex: 1,\n    },\n    landingP: {\n      marginBottom: 16,\n    },\n    // TODO: Make a browse button component\n    browseButtonContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n    browseButton: {\n      marginBottom: 16,\n      height: 72,\n      flex: 1,\n      maxWidth: 256,\n      textAlign: 'center',\n      fontSize: FontSize.BIG_BUTTON,\n      lineHeight: '72px',\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      padding: `0 60px`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n  }),\n)\n","import {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\n\nimport {ProfileGroup, SymbolRemapper} from '../lib/profile'\nimport {FontFamily, FontSize, Duration, commonStyle} from './style'\nimport {importEmscriptenSymbolMap as importEmscriptenSymbolRemapper} from '../lib/emscripten'\nimport {SandwichViewContainer} from './sandwich-view'\nimport {saveToFile} from '../lib/file-format'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {LeftHeavyFlamechartView, ChronoFlamechartView} from './flamechart-view-container'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Toolbar} from './toolbar'\nimport {importJavaScriptSourceMapSymbolRemapper} from '../lib/js-source-map'\nimport {Theme, withTheme} from './themes/theme'\nimport {ViewMode} from '../lib/view-mode'\nimport {canUseXHR} from '../app-state'\nimport {ProfileGroupState} from '../app-state/profile-group'\nimport {HashParams} from '../lib/hash-params'\nimport {StatelessComponent} from '../lib/preact-helpers'\nimport {CompareViewContainer} from './compare-view'\n\nconst importModule = import('../import')\n\n// Force eager loading of a few code-split modules.\n//\n// We put them all in one place so we can directly control the relative priority\n// of these.\nimportModule.then(() => {})\nimport('../lib/demangle-cpp').then(() => {})\nimport('source-map').then(() => {})\n\nasync function importProfilesFromText(\n  fileName: string,\n  contents: string,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfileGroupFromText(fileName, contents)\n}\n\nasync function importProfilesFromBase64(\n  fileName: string,\n  contents: string,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfileGroupFromBase64(fileName, contents)\n}\n\nasync function importProfilesFromArrayBuffer(\n  fileName: string,\n  contents: ArrayBuffer,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfilesFromArrayBuffer(fileName, contents)\n}\n\nasync function importProfilesFromFile(file: File): Promise<ProfileGroup | null> {\n  return (await importModule).importProfilesFromFile(file)\n}\nasync function importFromFileSystemDirectoryEntry(entry: FileSystemDirectoryEntry) {\n  return (await importModule).importFromFileSystemDirectoryEntry(entry)\n}\n\ndeclare function require(x: string): any\nconst exampleProfileURL = require('../../sample/profiles/stackcollapse/perf-vertx-stacks-01-collapsed-all.txt')\n\nfunction isFileSystemDirectoryEntry(entry: FileSystemEntry): entry is FileSystemDirectoryEntry {\n  return entry != null && entry.isDirectory\n}\n\ninterface GLCanvasProps {\n  canvasContext: CanvasContext | null\n  theme: Theme\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n}\nexport class GLCanvas extends StatelessComponent<GLCanvasProps> {\n  private canvas: HTMLCanvasElement | null = null\n\n  private ref = (canvas: Element | null) => {\n    if (canvas instanceof HTMLCanvasElement) {\n      this.canvas = canvas\n    } else {\n      this.canvas = null\n    }\n\n    this.props.setGLCanvas(this.canvas)\n  }\n\n  private container: HTMLElement | null = null\n  private containerRef = (container: Element | null) => {\n    if (container instanceof HTMLElement) {\n      this.container = container\n    } else {\n      this.container = null\n    }\n  }\n\n  private maybeResize = () => {\n    if (!this.container) return\n    if (!this.props.canvasContext) return\n\n    let {width, height} = this.container.getBoundingClientRect()\n\n    const widthInAppUnits = width\n    const heightInAppUnits = height\n    const widthInPixels = width * window.devicePixelRatio\n    const heightInPixels = height * window.devicePixelRatio\n\n    this.props.canvasContext.gl.resize(\n      widthInPixels,\n      heightInPixels,\n      widthInAppUnits,\n      heightInAppUnits,\n    )\n  }\n\n  onWindowResize = () => {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.requestFrame()\n    }\n  }\n  componentWillReceiveProps(nextProps: GLCanvasProps) {\n    if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.maybeResize)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n  }\n  componentWillUnmount() {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n    }\n    window.removeEventListener('resize', this.onWindowResize)\n  }\n  render() {\n    const style = getStyle(this.props.theme)\n    return (\n      <div ref={this.containerRef} className={css(style.glCanvasView)}>\n        <canvas ref={this.ref} width={1} height={1} />\n      </div>\n    )\n  }\n}\n\nexport type ApplicationProps = {\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n  setLoading: (loading: boolean) => void\n  setError: (error: boolean) => void\n  setProfileGroup: (profileGroup: ProfileGroup) => void\n  setCompareProfileGroup: (profileGroup: ProfileGroup) => void\n  setDragActive: (dragActive: boolean) => void\n  setViewMode: (viewMode: ViewMode) => void\n  setFlattenRecursion: (flattenRecursion: boolean) => void\n  setProfileIndexToView: (profileIndex: number) => void\n  activeProfileState: ActiveProfileState | null\n  compareActiveProfileState: ActiveProfileState | null\n  canvasContext: CanvasContext | null\n  theme: Theme\n  profileGroup: ProfileGroupState\n  flattenRecursion: boolean\n  viewMode: ViewMode\n  hashParams: HashParams\n  dragActive: boolean\n  loading: boolean\n  glCanvas: HTMLCanvasElement | null\n  error: boolean\n}\n\nexport class Application extends StatelessComponent<ApplicationProps> {\n  private async loadProfile(loader: () => Promise<ProfileGroup | null>) {\n    this.props.setLoading(true)\n    await new Promise(resolve => setTimeout(resolve, 0))\n\n    if (!this.props.glCanvas) return\n\n    console.time('import')\n\n    let profileGroup: ProfileGroup | null = null\n    try {\n      profileGroup = await loader()\n    } catch (e) {\n      console.log('Failed to load format', e)\n      this.props.setError(true)\n      return\n    }\n\n    // TODO(jlfwong): Make these into nicer overlays\n    if (profileGroup == null) {\n      alert('Unrecognized format! See documentation about supported formats.')\n      this.props.setLoading(false)\n      return\n    } else if (profileGroup.profiles.length === 0) {\n      alert(\"Successfully imported profile, but it's empty!\")\n      this.props.setLoading(false)\n      return\n    }\n\n    if (this.props.hashParams.title) {\n      profileGroup = {\n        ...profileGroup,\n        name: this.props.hashParams.title,\n      }\n    }\n    document.title = `${profileGroup.name} - speedscope`\n\n    if (this.props.hashParams.viewMode) {\n      this.props.setViewMode(this.props.hashParams.viewMode)\n    }\n\n    for (let profile of profileGroup.profiles) {\n      await profile.demangle()\n    }\n\n    for (let profile of profileGroup.profiles) {\n      const title = this.props.hashParams.title || profile.getName()\n      profile.setName(title)\n    }\n\n    console.timeEnd('import')\n\n    if (this.props.viewMode === ViewMode.COMPARE_VIEW) {\n      this.props.setCompareProfileGroup(profileGroup)\n    } else {\n      this.props.setProfileGroup(profileGroup)\n    }\n    this.props.setLoading(false)\n  }\n\n  getStyle(): ReturnType<typeof getStyle> {\n    return getStyle(this.props.theme)\n  }\n\n  loadFromFile(file: File) {\n    this.loadProfile(async () => {\n      const profiles = await importProfilesFromFile(file)\n      if (profiles) {\n        for (let profile of profiles.profiles) {\n          if (!profile.getName()) {\n            profile.setName(file.name)\n          }\n        }\n        return profiles\n      }\n\n      if (this.props.profileGroup && this.props.activeProfileState) {\n        // If a profile is already loaded, it's possible the file being imported is\n        // a symbol map. If that's the case, we want to parse it, and apply the symbol\n        // mapping to the already loaded profile. This can be use to take an opaque\n        // profile and make it readable.\n        const reader = new FileReader()\n        const fileContentsPromise = new Promise<string>(resolve => {\n          reader.addEventListener('loadend', () => {\n            if (typeof reader.result !== 'string') {\n              throw new Error('Expected reader.result to be a string')\n            }\n            resolve(reader.result)\n          })\n        })\n        reader.readAsText(file)\n        const fileContents = await fileContentsPromise\n\n        let symbolRemapper: SymbolRemapper | null = null\n\n        const emscriptenSymbolRemapper = importEmscriptenSymbolRemapper(fileContents)\n        if (emscriptenSymbolRemapper) {\n          console.log('Importing as emscripten symbol map')\n          symbolRemapper = emscriptenSymbolRemapper\n        }\n\n        const jsSourceMapRemapper = await importJavaScriptSourceMapSymbolRemapper(\n          fileContents,\n          file.name,\n        )\n        if (!symbolRemapper && jsSourceMapRemapper) {\n          console.log('Importing as JavaScript source map')\n          symbolRemapper = jsSourceMapRemapper\n        }\n\n        if (symbolRemapper != null) {\n          return {\n            name: this.props.profileGroup.name || 'profile',\n            indexToView: this.props.profileGroup.indexToView,\n            profiles: this.props.profileGroup.profiles.map(profileState => {\n              // We do a shallow clone here to invalidate certain caches keyed\n              // on a reference to the profile group under the assumption that\n              // profiles are immutable. Symbol remapping is (at time of\n              // writing) the only exception to that immutability.\n              const p = profileState.profile.shallowClone()\n              p.remapSymbols(symbolRemapper!)\n              return p\n            }),\n          }\n        }\n      }\n\n      return null\n    })\n  }\n\n  loadExample = () => {\n    this.loadProfile(async () => {\n      const filename = 'perf-vertx-stacks-01-collapsed-all.txt'\n      const data = await fetch(exampleProfileURL).then(resp => resp.text())\n      return await importProfilesFromText(filename, data)\n    })\n  }\n\n  onDrop = (ev: DragEvent) => {\n    this.props.setDragActive(false)\n    ev.preventDefault()\n\n    if (!ev.dataTransfer) return\n\n    const firstItem = ev.dataTransfer.items[0]\n    if ('webkitGetAsEntry' in firstItem) {\n      const webkitEntry: FileSystemEntry | null = firstItem.webkitGetAsEntry()\n\n      // Instrument.app file format is actually a directory.\n      if (\n        webkitEntry &&\n        isFileSystemDirectoryEntry(webkitEntry) &&\n        webkitEntry.name.endsWith('.trace')\n      ) {\n        console.log('Importing as Instruments.app .trace file')\n        const webkitDirectoryEntry: FileSystemDirectoryEntry = webkitEntry\n        this.loadProfile(async () => {\n          return await importFromFileSystemDirectoryEntry(webkitDirectoryEntry)\n        })\n        return\n      }\n    }\n\n    let file: File | null = ev.dataTransfer.files.item(0)\n    if (file) {\n      this.loadFromFile(file)\n    }\n  }\n\n  onDragOver = (ev: DragEvent) => {\n    this.props.setDragActive(true)\n    ev.preventDefault()\n  }\n\n  onDragLeave = (ev: DragEvent) => {\n    this.props.setDragActive(false)\n    ev.preventDefault()\n  }\n\n  onWindowKeyPress = async (ev: KeyboardEvent) => {\n    if (ev.key === '1') {\n      this.props.setViewMode(ViewMode.CHRONO_FLAME_CHART)\n    } else if (ev.key === '2') {\n      this.props.setViewMode(ViewMode.LEFT_HEAVY_FLAME_GRAPH)\n    } else if (ev.key === '3') {\n      this.props.setViewMode(ViewMode.SANDWICH_VIEW)\n    } else if (ev.key === '4') {\n      this.props.setViewMode(ViewMode.COMPARE_VIEW)\n    } else if (ev.key === 'r') {\n      const {flattenRecursion} = this.props\n      this.props.setFlattenRecursion(!flattenRecursion)\n    } else if (ev.key === 'n') {\n      const {activeProfileState} = this.props\n      if (activeProfileState) {\n        this.props.setProfileIndexToView(activeProfileState.index + 1)\n      }\n    } else if (ev.key === 'p') {\n      const {activeProfileState} = this.props\n      if (activeProfileState) {\n        this.props.setProfileIndexToView(activeProfileState.index - 1)\n      }\n    }\n  }\n\n  private saveFile = () => {\n    if (this.props.profileGroup) {\n      const {name, indexToView, profiles} = this.props.profileGroup\n      const profileGroup: ProfileGroup = {\n        name,\n        indexToView,\n        profiles: profiles.map(p => p.profile),\n      }\n      saveToFile(profileGroup)\n    }\n  }\n\n  private browseForFile = () => {\n    const input = document.createElement('input')\n    input.type = 'file'\n    input.addEventListener('change', this.onFileSelect)\n    input.click()\n  }\n\n  private onWindowKeyDown = async (ev: KeyboardEvent) => {\n    // This has to be handled on key down in order to prevent the default\n    // page save action.\n    if (ev.key === 's' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n      this.saveFile()\n    } else if (ev.key === 'o' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n      this.browseForFile()\n    }\n  }\n\n  onDocumentPaste = (ev: Event) => {\n    if (document.activeElement != null && document.activeElement.nodeName === 'INPUT') return\n\n    ev.preventDefault()\n    ev.stopPropagation()\n\n    const clipboardData = (ev as ClipboardEvent).clipboardData\n    if (!clipboardData) return\n    const pasted = clipboardData.getData('text')\n    this.loadProfile(async () => {\n      return await importProfilesFromText('From Clipboard', pasted)\n    })\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyDown)\n    window.addEventListener('keypress', this.onWindowKeyPress)\n    document.addEventListener('paste', this.onDocumentPaste)\n    this.maybeLoadHashParamProfile()\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyDown)\n    window.removeEventListener('keypress', this.onWindowKeyPress)\n    document.removeEventListener('paste', this.onDocumentPaste)\n  }\n\n  async maybeLoadHashParamProfile() {\n    const {profileURL} = this.props.hashParams\n    if (profileURL) {\n      if (!canUseXHR) {\n        alert(\n          `Cannot load a profile URL when loading from \"${window.location.protocol}\" URL protocol`,\n        )\n        return\n      }\n      this.loadProfile(async () => {\n        const response: Response = await fetch(profileURL)\n        let filename = new URL(profileURL, window.location.href).pathname\n        if (filename.includes('/')) {\n          filename = filename.slice(filename.lastIndexOf('/') + 1)\n        }\n        return await importProfilesFromArrayBuffer(filename, await response.arrayBuffer())\n      })\n    } else if (this.props.hashParams.localProfilePath) {\n      // There isn't good cross-browser support for XHR of local files, even from\n      // other local files. To work around this restriction, we load the local profile\n      // as a JavaScript file which will invoke a global function.\n      ;(window as any)['speedscope'] = {\n        loadFileFromBase64: (filename: string, base64source: string) => {\n          this.loadProfile(() => importProfilesFromBase64(filename, base64source))\n        },\n      }\n\n      const script = document.createElement('script')\n      script.src = `file:///${this.props.hashParams.localProfilePath}`\n      document.head.appendChild(script)\n    }\n  }\n\n  onFileSelect = (ev: Event) => {\n    const file = (ev.target as HTMLInputElement).files!.item(0)\n    if (file) {\n      this.loadFromFile(file)\n    }\n  }\n\n  renderLanding() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.landingContainer)}>\n        <div className={css(style.landingMessage)}>\n          <p className={css(style.landingP)}>\n             Hi there! Welcome to speedscope, an interactive{' '}\n            <a\n              className={css(style.link)}\n              href=\"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html\"\n            >\n              flamegraph\n            </a>{' '}\n            visualizer. Use it to help you make your software faster.\n          </p>\n          {canUseXHR ? (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, click the big blue\n              button below to browse for a profile to explore, or{' '}\n              <a tabIndex={0} className={css(style.link)} onClick={this.loadExample}>\n                click here\n              </a>{' '}\n              to load an example profile.\n            </p>\n          ) : (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, or click the big blue\n              button below to browse for a profile to explore.\n            </p>\n          )}\n          <div className={css(style.browseButtonContainer)}>\n            <input\n              type=\"file\"\n              name=\"file\"\n              id=\"file\"\n              onChange={this.onFileSelect}\n              className={css(commonStyle.hide)}\n            />\n            <label for=\"file\" className={css(style.browseButton)} tabIndex={0}>\n              Browse\n            </label>\n          </div>\n\n          <p className={css(style.landingP)}>\n            See the{' '}\n            <a\n              className={css(style.link)}\n              href=\"https://github.com/jlfwong/speedscope#usage\"\n              target=\"_blank\"\n            >\n              documentation\n            </a>{' '}\n            for information about supported file formats, keyboard shortcuts, and how to navigate\n            around the profile.\n          </p>\n\n          <p className={css(style.landingP)}>\n            speedscope is open source. Please{' '}\n            <a\n              className={css(style.link)}\n              target=\"_blank\"\n              href=\"https://github.com/jlfwong/speedscope/issues\"\n            >\n              report any issues on GitHub\n            </a>\n            .\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n  renderError() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.error)}>\n        <div> Something went wrong.</div>\n        <div>Check the JS console for more details.</div>\n      </div>\n    )\n  }\n\n  renderLoadingBar() {\n    const style = this.getStyle()\n    return <div className={css(style.loading)} />\n  }\n\n  renderContent() {\n    const {viewMode, activeProfileState, compareActiveProfileState, error, loading, glCanvas} =\n      this.props\n\n    if (error) {\n      return this.renderError()\n    }\n\n    if (loading) {\n      return this.renderLoadingBar()\n    }\n\n    if (!activeProfileState || !glCanvas) {\n      return this.renderLanding()\n    }\n\n    switch (viewMode) {\n      case ViewMode.CHRONO_FLAME_CHART: {\n        return <ChronoFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n      case ViewMode.LEFT_HEAVY_FLAME_GRAPH: {\n        return (\n          <LeftHeavyFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n        )\n      }\n      case ViewMode.SANDWICH_VIEW: {\n        return <SandwichViewContainer activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n      case ViewMode.COMPARE_VIEW: {\n        return (\n          <CompareViewContainer\n            activeProfileState={activeProfileState}\n            compareActiveProfileState={compareActiveProfileState}\n            glCanvas={glCanvas}\n            onFileSelect={this.onFileSelect}\n          />\n        )\n      }\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n    return (\n      <div\n        onDrop={this.onDrop}\n        onDragOver={this.onDragOver}\n        onDragLeave={this.onDragLeave}\n        className={css(style.root, this.props.dragActive && style.dragTargetRoot)}\n      >\n        <GLCanvas\n          setGLCanvas={this.props.setGLCanvas}\n          canvasContext={this.props.canvasContext}\n          theme={this.props.theme}\n        />\n        <Toolbar\n          saveFile={this.saveFile}\n          browseForFile={this.browseForFile}\n          {...(this.props as ApplicationProps)}\n        />\n        <div className={css(style.contentContainer)}>{this.renderContent()}</div>\n        {this.props.dragActive && <div className={css(style.dragTarget)} />}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    glCanvasView: {\n      position: 'absolute',\n      width: '100vw',\n      height: '100vh',\n      zIndex: -1,\n      pointerEvents: 'none',\n    },\n    error: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: '100%',\n    },\n    loading: {\n      height: 3,\n      marginBottom: -3,\n      background: theme.selectionPrimaryColor,\n      transformOrigin: '0% 50%',\n      animationName: [\n        {\n          from: {\n            transform: `scaleX(0)`,\n          },\n          to: {\n            transform: `scaleX(1)`,\n          },\n        },\n      ],\n      animationTimingFunction: 'cubic-bezier(0, 1, 0, 1)',\n      animationDuration: '30s',\n    },\n    root: {\n      width: '100vw',\n      height: '100vh',\n      overflow: 'hidden',\n      display: 'flex',\n      flexDirection: 'column',\n      position: 'relative',\n      fontFamily: FontFamily.MONOSPACE,\n      lineHeight: '20px',\n      color: theme.fgPrimaryColor,\n    },\n    dragTargetRoot: {\n      cursor: 'copy',\n    },\n    dragTarget: {\n      boxSizing: 'border-box',\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      border: `5px dashed ${theme.selectionPrimaryColor}`,\n      pointerEvents: 'none',\n    },\n    contentContainer: {\n      position: 'relative',\n      display: 'flex',\n      overflow: 'hidden',\n      flexDirection: 'column',\n      flex: 1,\n    },\n    landingContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flex: 1,\n    },\n    landingMessage: {\n      maxWidth: 600,\n    },\n    landingP: {\n      marginBottom: 16,\n    },\n    browseButtonContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n    browseButton: {\n      marginBottom: 16,\n      height: 72,\n      flex: 1,\n      maxWidth: 256,\n      textAlign: 'center',\n      fontSize: FontSize.BIG_BUTTON,\n      lineHeight: '72px',\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n    link: {\n      color: theme.selectionPrimaryColor,\n      cursor: 'pointer',\n      textDecoration: 'none',\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        color: theme.selectionSecondaryColor,\n      },\n    },\n  }),\n)\n","import {h} from 'preact'\nimport {getCanvasContext} from '../app-state/getters'\nimport {memo, useMemo} from 'preact/compat'\nimport {\n  useActiveCompareProfileState,\n  useActiveProfileState,\n} from '../app-state/active-profile-state'\nimport {useTheme} from './themes/theme'\nimport {\n  compareProfileGroupAtom,\n  dragActiveAtom,\n  errorAtom,\n  flattenRecursionAtom,\n  glCanvasAtom,\n  hashParamsAtom,\n  loadingAtom,\n  profileGroupAtom,\n  viewModeAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ProfileSearchContextProvider} from './search-view'\nimport {Application} from './application'\n\nexport const ApplicationContainer = memo(() => {\n  const canvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n  const canvasContext = useMemo(\n    () => (canvas ? getCanvasContext({theme, canvas}) : null),\n    [theme, canvas],\n  )\n\n  return (\n    <ProfileSearchContextProvider>\n      <Application\n        activeProfileState={useActiveProfileState()}\n        compareActiveProfileState={useActiveCompareProfileState()}\n        canvasContext={canvasContext}\n        setGLCanvas={glCanvasAtom.set}\n        setLoading={loadingAtom.set}\n        setError={errorAtom.set}\n        setProfileGroup={profileGroupAtom.setProfileGroup}\n        setCompareProfileGroup={compareProfileGroupAtom.setProfileGroup}\n        setDragActive={dragActiveAtom.set}\n        setViewMode={viewModeAtom.set}\n        setFlattenRecursion={flattenRecursionAtom.set}\n        setProfileIndexToView={profileGroupAtom.setProfileIndexToView}\n        profileGroup={useAtom(profileGroupAtom)}\n        theme={theme}\n        flattenRecursion={useAtom(flattenRecursionAtom)}\n        viewMode={useAtom(viewModeAtom)}\n        hashParams={useAtom(hashParamsAtom)}\n        glCanvas={canvas}\n        dragActive={useAtom(dragActiveAtom)}\n        loading={useAtom(loadingAtom)}\n        error={useAtom(errorAtom)}\n      />\n    </ProfileSearchContextProvider>\n  )\n})\n","import {h, render} from 'preact'\nimport {ApplicationContainer} from './views/application-container'\nimport {ThemeProvider} from './views/themes/theme'\n\nconsole.log(`speedscope v${require('../package.json').version}`)\n\ndeclare const module: any\nif (module.hot) {\n  module.hot.dispose(() => {\n    // Force the old component go through teardown steps\n    render(<div />, document.body, document.body.lastElementChild || undefined)\n  })\n  module.hot.accept()\n}\n\nrender(\n  <ThemeProvider>\n    <ApplicationContainer />\n  </ThemeProvider>,\n  document.body,\n  document.body.lastElementChild || undefined,\n)\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n","module.exports = function loadJSBundle(bundle) {\n  return new Promise(function (resolve, reject) {\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'text/javascript';\n    script.charset = 'utf-8';\n    script.src = bundle;\n    script.onerror = function (e) {\n      script.onerror = script.onload = null;\n      reject(e);\n    };\n\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      resolve();\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n};\n"]}